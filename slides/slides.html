<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="author" content="Jakub Marchwicki [kuba.marchwicki@gmail.com]"><title>Mikrousługi i wzorce architektury rozproszonej</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js/css/reveal.css" rel="stylesheet"><link rel="stylesheet" href="css/custom_serif.css" id="theme"><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet"><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]--></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-background-size="cover" data-background-image="http://www.tapeciarnia.pl/tapety/normalne/236655_rzeka_mosty_zdjecie_miasta_latarnie.jpg"><h1>Mikrousługi i wzorce architektury rozproszonej</h1><p class="author"><small>Jakub Marchwicki [kuba.marchwicki@gmail.com]</small></p></section><section><section id="slide_poznajmy_się" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Poznajmy się</h2></section><section id="slide_o_mnie"><h2>O mnie</h2><div class="ulist"><div class="title">Jakub Marchwicki</div><ul><li><p>programista od ponad 15 lat</p></li><li><p>po drodze: manager, dyrektor IT, architekt, konsultant</p></li><li><p>domeny: ubezpieczenia, bankowość, marketing, edukacja, rolnictwo</p></li><li><p>Twitter: @kubem</p></li><li><p><a href="mailto:jakub@marchwicki.pl">jakub@marchwicki.pl</a></p></li></ul></div></section></section>
<section><section id="slide_microservices" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Microservices</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Co to? Po co to?<br>
Możliwości i zagrożenia.</td></tr></table></div></section><section id="slide_microservices_are_the_new_black" data-background-image="images/microservice-everywhere.jpeg" data-background-size="contain"></section><section id="slide_monolithic_vs_micro" class="white background"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="images/introduction-monolith-micro.png" alt="introduction monolith micro" width="80%"></div></section><section id="slide_monolithic_vs_micro_2" class="white background"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="images/introduction-monolith-micro_2.png" alt="introduction monolith micro 2" width="80%"></div></section><section id="slide_monolithic_vs_micro_3" class="white background"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="images/introduction-monolith-micro_3.jpg" alt="introduction monolith micro 3" width="80%"></div></section><section id="slide_monolithic_vs_micro_4" class="white background"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="images/introduction-monolith-micro_4.jpg" alt="introduction monolith micro 4"></div></section><section id="slide_ale"><h2>Ale&#8230;&#8203;</h2><div class="ulist"><ul><li><p>Mikroserwisy to nie jedyne podejście do architektury aplikacji</p></li><li><p>Mikroserwisy to podejście specyficzne, adresujące bardzo konkretne potrzeby:</p><div class="ulist"><ul><li><p>Potrzeba skalowania technicznego (<em>throughput</em>, <em>latency</em>)</p></li><li><p>Potrzeba skalowania funkcjonalnego (dodawanie nowych elementów do systemu)</p></li><li><p>Potrzeba skalowania ludzi (niezależność zespołów)</p></li></ul></div></li><li><p>Mikroserwisy to podejście trudne</p><div class="ulist"><ul><li><p>Wymagające zmian na poziomie technicznym (narzędzia, technologie) jak i ludzkim (organizacja, procesy, umiejętności)</p></li></ul></div></li></ul></div></section><section id="slide_czym_jest_mikroserwis"><h2>Czym jest mikroserwis?</h2><div class="quoteblock"><blockquote>Micro Service is an <strong>architectural concept</strong> that aims to decouple a solution by decomposing functionality into discrete services with communication over lightweight mechanisms, often an HTTP API</blockquote><div class="attribution">&#8212; Thoughworks</div></div>
<div class="paragraph"><p>&#8203;</p></div>
<div class="quoteblock"><blockquote>A microservice is a tightly scoped, strongly encapsulated, loosely coupled, independently deployable and independently scalable application component</blockquote><div class="attribution">&#8212; Gartner</div></div></section><section id="slide_czym_jest_mikroserwis_2"><h2>Czym jest mikroserwis? (2)</h2><div class="ulist"><ul><li><p>Niewielki problem biznesowy (<em>single responsibility principle</em>)</p></li><li><p>Niezależny, wdrażany niezależnie</p><div class="ulist"><ul><li><p>Wdrażany w sposób automatyczny</p></li></ul></div></li><li><p>Działa we własnym procesie</p></li><li><p>Jest właścicielem swoich danych</p></li><li><p>Integruje się <em>explicite</em> z użyciem powszechnych interfejsów (nie jest np. statycznie linkowany, wywoływany w pamięci)</p></li></ul></div></section><section id="slide_czym_nie_jest_mikroserwis"><h2>Czym <strong>nie</strong> jest mikroserwis?</h2><div class="ulist"><ul><li><p>Mały serwis (niewiele linijek kodu) komunikujący się z główną aplikacją z wykorzystaniem REST (w pełni od nie zależny)</p></li><li><p>Uproszone API (np. REST) dla istniejącego serwisu, dodane do monolitycznej aplikacji</p></li><li><p>Kilka aplikacji, na pojedynczym serwerze, korzystających ze współdzielonych zasobów (bazy danych, systemu plików)</p></li><li><p>Serwis zależny od innych usług w ekosystemie, w sposób uniemożliwiający niezależne aktualizacje</p></li><li><p>Aplikacja <em>zapakowana</em> w kontener Dockera</p></li><li><p>Usługa <em>obsługiwana</em> ręcznie, bez automatyzacji testów, wdrożenia i utrzymania</p></li></ul></div></section><section id="slide_co_łączy_udane_wdrożenia_mikroserwisów"><h2>Co łączy udane wdrożenia mikroserwisów</h2><div class="ulist"><ul><li><p>Ewolucja od architektury monolitycznej (PHP, Ruby, PostreSQL) w kierunku mikrousług</p><div class="ulist"><ul><li><p>Zespoły zaznajomione z domeną (e-commerce), świadome ograniczeń i wyzwań (<em>spikes</em>)</p></li><li><p>Jasno określone kryteria docelowe (identyfikacja aktualnych problemów)</p></li></ul></div></li><li><p>Skala rozwiązania</p><div class="ulist"><ul><li><p>Możliwość rozwiązywania trudnych problemów (aplikacja, infrastruktura, domena)</p></li></ul></div></li><li><p>Własne rozwiązania zarządzania infrastrukturą</p></li><li><p>Organizacje otwarte na zmiany (zwinność organizacji) i opensource (korzystają i oddają)</p></li></ul></div></section><section id="slide_monolityczne_aplikacje_vs_microservices"><h2>Monolityczne aplikacje vs microservices </h2><div class="dlist"><dl><dt class="hdlist1">Problemy z monolitem</dt><dd><div class="ulist"><ul><li><p>Trudne w rozwoju i utrzymaniu (<em>long term technology stack commitment</em>)</p><div class="ulist"><ul><li><p>Nawet jeżeli podzielone na warstwy - wciąż występują wewnętrzne, niewidoczne sprzęgnięcia</p></li><li><p>Nowe sprzęgnięcia pojawiają się bardzo łatwo, w sposób niekontrolowany</p></li><li><p>Pojedynczy proces (w systemie) umożliwia odwołania poza "kontraktem"</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_monolityczne_aplikacje_vs_microservices_2"><h2>Monolityczne aplikacje vs microservices (2)</h2><div class="dlist"><dl><dt class="hdlist1">Problemy z monolitem</dt><dd><div class="ulist"><ul><li><p>Trudne w testowaniu i wdrażaniu (zależności, <em>atomic releases and rollbacks</em>)</p></li><li><p>Trudny w skalowaniu (trzeba skalować całość podczas gdy od jednej usługi oczekiwana jest lepsza wydajność)</p></li><li><p><strong>FUD</strong>: jeżeli działa - nie dotykać, nie naprawiać</p></li><li><p>Ładne diagramy rzadko kiedy przekładają się na ładny kod</p></li></ul></div></dd></dl></div></section><section id="slide_monolityczne_aplikacje_vs_microservices_3"><h2>Monolityczne aplikacje vs microservices (3)</h2><div class="dlist"><dl><dt class="hdlist1">Zalety monolitu</dt><dd><div class="ulist"><ul><li><p>statyczna architektura - brak większych (rewolucyjnych) zmian</p></li><li><p>kilka repozytoriów i zależności do zainstalowania,</p></li><li><p>prosty sposób postawienia całego środowiska,</p></li><li><p>prosta integracja zmian do wdrożenia,</p></li><li><p>prosty do utrzymania na produkcji,</p></li><li><p>proste śledzenie interakcji w kodzie.</p></li></ul></div></dd></dl></div></section><section id="slide_monolityczne_aplikacje_vs_microservices_4"><h2>Monolityczne aplikacje vs microservices (4)</h2><div class="dlist"><dl><dt class="hdlist1">Problemy z mikro usługami</dt><dd><div class="ulist"><ul><li><p>Równie trudno (jak w monolicie) ogarnąć całość rozwiązania</p><div class="ulist"><ul><li><p>Ale całość nie jest konieczna to rozwijania tylko części aplikacji</p></li></ul></div></li><li><p>Nowy model działalności (np. DevOps)</p></li><li><p>Nowy sposób lokalizowania problemów</p><div class="ulist"><ul><li><p>Diagnoza <strong>gdzie</strong> problem wystąpił</p></li><li><p>W następnej kolejności analiza <strong>dlaczego</strong> i <strong>jak</strong> naprawiać</p></li></ul></div></li><li><p>Potencjalne problemy wydajnościowe (latency)</p></li></ul></div></dd></dl></div></section><section id="slide_monolityczne_aplikacje_vs_microservices_5"><h2>Monolityczne aplikacje vs microservices (5)</h2><table class="tableblock frame-all grid-all" style=""><colgroup><col><col></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Silna enkapsulacja modułów, moduły relatywnie proste</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Trudne do opanowania rozproszenie systemu, dużo autonomicznych jednostek</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Niezależne wdrożenia i testy</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Brak silnych więzów spójności / integralności (<em>eventual consistency</em>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Niezależne charakterystyki skalowania i wydajności</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Network latencies</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Różnorodność technologiczna (dostosowanie narzędzi do problemu)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Wyzwania organizacyjne i utrzymaniowe (skomplikowane narzędzi i zarządzania zależnościami)</p></td></tr></table></section><section id="slide_monolityczne_aplikacje_vs_microservices_6"><h2>Monolityczne aplikacje vs microservices (6)</h2><div class="ulist"><ul><li><p>Czy architektura mikro usług to powinno być <em>goto architecture</em>?</p><div class="ulist"><ul><li><p><em>Monolith First</em> (<a href="https://martinfowler.com/bliki/MonolithFirst.html" class="bare">https://martinfowler.com/bliki/MonolithFirst.html</a> - 06.2015)</p></li><li><p><em>Don’t start with a monolith</em> (<a href="https://martinfowler.com/articles/dont-start-monolith.html" class="bare">https://martinfowler.com/articles/dont-start-monolith.html</a> - 06.2015)</p></li></ul></div></li><li><p>Czy architektura monolityczna jest zła?</p><div class="ulist"><ul><li><p><em>If you can&#8217;t build a monolith, what makes you think microservices are the answer?</em> (<a href="http://www.codingthearchitecture.com/2014/07/06/distributed_big_balls_of_mud.html" class="bare">http://www.codingthearchitecture.com/2014/07/06/distributed_big_balls_of_mud.html</a> - 06.2014)</p></li></ul></div></li></ul></div></section><section id="slide_it_depends"><div class="quoteblock"><blockquote>any decent answer to an interesting question begins, "it depends&#8230;&#8203;"</blockquote><div class="attribution">&#8212; Kent Beck</div></div></section><section id="slide_dlaczego_monolity_nie_działają"><h2>Dlaczego monolity nie działają?</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Dlaczego każdy projekt <em>green field</em> staje się legacy, i jest to tylko i wyłącznie funkcja czasu?</p></div></div></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>Nie pytamy <strong>czy</strong> się stanie trudny w utrzymaniu - tylko <strong>kiedy</strong></p></div></div></div></section><section id="slide_dlaczego_monolity_nie_działają_2"><h2>Dlaczego monolity nie działają? (2)</h2><div class="ulist"><ul><li><p>Cargo-cult architecture (standardy organizacyjne)</p></li><li><p>Zależności pomiędzy softwarem a ludźmi (<em>Bob The Builder</em>)</p></li><li><p>Klątwa systemów legacy</p><div class="ulist"><ul><li><p>Problemy techniczne (trudności w utrzymaniu - <em>technology eof</em>)</p></li><li><p>Problemy organizacyjne (trudności z rekrutacją - <em>code camps</em>)</p></li><li><p>Problemy biznesowe (<em>all features <strong>weren&#8217;t</strong> made equal</em>, <em>atomic 6moths release cycle</em>)</p></li></ul></div></li></ul></div></section><section id="slide_dlaczego_mikrousługi_nie_działają"><h2>Dlaczego mikrousługi nie działają?</h2><div class="ulist"><ul><li><p>Nie ma możliwości <em>"mechanicznego podziału"</em> złożonego systemu na mniejsze części - m.in. z powodu <em>"zależności biznesowych"</em>. Brak znajomości reguł domeny prowadzi często do <em>"rozproszonego monolitu"</em>.</p></li><li><p>Decydując się na mikro usługi nie zdajemy sobie sprawy z kosztów, których nie widać w rozwiązaniach monolitycznych: zależności, wdrożenie, utrzymanie.</p></li></ul></div></section></section>
<section><section id="slide_microservices_przykładowe_wdrożenia" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Microservices - przykładowe wdrożenia</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Przykładowe wdrożenia architektury mikrousług</td></tr></table></div></section><section id="slide_mikroserwisy_przykładowe_wdrożenia"><h2>Mikroserwisy - przykładowe wdrożenia</h2><div class="paragraph"><p>Wdrożenia architektury mikrousług na przykładzie</p></div>
<div class="ulist"><ul><li><p>Allegro (<a href="https://allegro.tech/" class="bare">https://allegro.tech/</a>)</p></li><li><p>Zalando (<a href="https://zalando.github.io/" class="bare">https://zalando.github.io/</a>)</p></li><li><p>Gilt (<a href="http://tech.gilt.com/" class="bare">http://tech.gilt.com/</a>)</p></li></ul></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><strong>Disclaimer</strong><br>
Nie jestem związany z ww. firmami. Wiedza o wdrożeniach i platformach mikrousługowych jest wiedzą ogólnodostępną.</td></tr></table></div></section><section id="slide_allegro_1"><h2>Allegro (1)</h2><div class="ulist"><ul><li><p>Platforma aukcji internetowych w Polsce</p></li><li><p>Monolityczna aplikacja Qeppo (PHP + Oracle) - od samego początku Allegro (1999)</p></li><li><p>12MLoC w 2012 (masa krytyczna)</p></li></ul></div>
<div class="imageblock" style=""><img src="images/allegro-arch.png" alt="allegro arch"></div></section><section id="slide_allegro_2"><h2>Allegro (2)</h2><div class="ulist"><ul><li><p>Decyzja w 2013 nie była pójściem w kierunku mikro usług a SOA</p></li></ul></div>
<div class="imageblock" style=""><img src="images/allegro-domains.png" alt="allegro domains"></div></section><section id="slide_allegro_3"><h2>Allegro (3)</h2><div class="ulist"><div class="title">Dlaczego SOA?</div><ul><li><p>potrzeba szybszego developmentu dla 50+ zwinnych zespołów,</p></li><li><p>potrzeba niezależnego skalowania poszczególnych części platformy,</p></li><li><p>potrzeba większej odporności platformy na awarie,</p></li><li><p>potrzeba przejścia na nowocześniejsze technologie (JVM),</p></li><li><p>potrzeba zoptymalizowania kosztów utrzymania i rozwoju,</p></li><li><p>architektura na kolejne kilka(naście) lat rozwoju Allegro.</p></li></ul></div></section><section id="slide_allegro_4"><h2>Allegro (4)</h2><div class="dlist"><dl><dt class="hdlist1">2013</dt><dd><div class="ulist"><ul><li><p>System bootstrapowania usług</p></li><li><p>Zalążek docelowej architektury (Service Discovery, Logger)</p></li></ul></div></dd><dt class="hdlist1">2014</dt><dd><div class="ulist"><ul><li><p>Pierwsze usługi działają produkcyjnie</p></li></ul></div></dd><dt class="hdlist1">2015</dt><dd><div class="ulist"><ul><li><p>Nowa przechodzi audyt</p></li><li><p>Data driven development (korzystanie z danych - Data Science)</p></li><li><p>Powstają nowe produkty w oparciu o nową architekturę</p></li><li><p>Nowe rozwiązania (Mesos, Consul, Zipkin)</p></li></ul></div></dd></dl></div></section><section id="slide_allegro_5"><h2>Allegro (5)</h2><div class="dlist"><dl><dt class="hdlist1">2016 - Allegro App Engine</dt><dd><div class="ulist"><ul><li><p>repozytorium git z kodem z zainicjalizowanego szablonu,</p></li><li><p>plany CI/CD (testowanie, wersjonowanie i wdrażanie usługi),</p></li><li><p>dashboardy z logami aplikacyjnymi (Kibana)</p></li><li><p>dashboardy z metrykami technicznymi i biznesowymi (Graphite + Grafana),</p></li><li><p>“czujki” w systemach monitorujących,</p></li><li><p>polityki dyżurowania i eskalacji w PagerDuty,</p></li><li><p>profil usługi w katalogu usług,</p></li><li><p>wdrożenie na środowisko developerskie.</p></li></ul></div></dd></dl></div></section><section id="slide_allegro_6"><h2>Allegro (6)</h2><div class="dlist"><dl><dt class="hdlist1">Implementacja</dt><dd><div class="ulist"><ul><li><p>jak inne usługi mnie mogą skonsumować?</p></li><li><p>jak ja mogę skonsumować inne usługi?</p></li><li><p>jak mogę wystawić swoje API na zewnątrz?</p></li><li><p>jak mogę siebie zabezpieczyć przed innymi usługami?</p></li><li><p>jak mnie później debuggować?</p></li><li><p>jak być spójnym z całą resztą architektury?</p></li></ul></div></dd></dl></div></section><section id="slide_allegro_7"><h2>Allegro (7)</h2><div class="dlist"><dl><dt class="hdlist1">Orchiestracja usług</dt><dd><div class="ulist"><ul><li><p><strong>Hermes</strong> (rozproszony pub/sub) w Allegro (oparte o Apache Kafka),</p></li><li><p>każda usługa może opublikować zdarzenie,</p></li><li><p>każda usługa może skonsumować dowolne inne zdarzenie,</p></li><li><p>każde zdarzenie ma swój wersjonowany schemat,</p></li><li><p>wszystkie zdarzenia dostępne są do analityki offline.</p></li></ul></div></dd></dl></div></section><section id="slide_allegro_8"><h2>Allegro (8)</h2><div class="imageblock" style=""><img src="images/allegro-deployment.png" alt="allegro deployment"></div></section><section id="slide_allegro_9"><h2>Allegro (9)</h2><div class="ulist"><ul><li><p>prod: 3500 CPU, 6.5 TB pamięci, 1500 kontenerów,</p></li><li><p>test: 512 CPU, 1 TB pamięci RAM, 500 kontenerów,</p></li><li><p>dev: 1200 CPU, 2 TB pamięci RAM, 2200 kontenerów,</p></li><li><p>wdrożenia produkcyjne na miesiąc:</p><div class="ulist"><ul><li><p>1341 (prod),</p></li><li><p>2899 (test),</p></li><li><p>2775 (dev)</p></li></ul></div></li><li><p>ca. 50 wdrożeń na godzinę</p></li></ul></div></section><section id="slide_allegro_10"><h2>Allegro (10)</h2><div class="dlist"><dl><dt class="hdlist1">Monitoring mikrousług</dt><dd><div class="ulist"><ul><li><p>health checks (Marathon, Consul),</p></li><li><p>statystyki kontenerów,</p></li><li><p>metryki aplikacji (Graphite) + czujki na nich (Alamo),</p></li><li><p>trace’y (Zipkin),</p></li><li><p>logi aplikacji + czujki na nich (Sentry),</p></li><li><p>monitoring frontendu (Appdex),</p></li><li><p>automatyzacja obsługi incydentów (Pagerduty).</p></li></ul></div></dd></dl></div></section><section id="slide_allegro_11"><h2>Allegro (11)</h2><div class="dlist"><dl><dt class="hdlist1">Aktualne wyzwania (as of 2017)</dt><dd><div class="ulist"><ul><li><p>450+ mikrousług w katalogu usług i konsoli AppEngine,</p></li><li><p>7 tys. repozytoriów z kodem,</p></li><li><p>11 tys. planów CI/CD,</p></li><li><p>ca. 9.7 mln metryk na minutę,</p></li><li><p>ca. 60 GB logów na minutę,</p></li><li><p>100 Gb kodu źródłowego,</p></li><li><p>2 mln artefaktów o łącznej wielkości 5 TB (po kompresji).</p></li></ul></div></dd></dl></div></section><section id="slide_gilt_1"><h2>Gilt (1)</h2><div class="ulist"><ul><li><p>Gilt.com - <em>Luxury goods flash-sales; traffic to the website spikes massively fifteen minutes before the time the sale starts, and then rapidly reduces over the next two hours before returning to a low baseline</em></p></li></ul></div>
<div class="imageblock" style=""><img src="images/gilt-monitoring.png" alt="gilt monitoring"></div></section><section id="slide_gilt_2"><h2>Gilt (2)</h2><div class="ulist"><ul><li><p>2007: aplikacja Ruby on Rails oparta o PostgreSQL</p></li></ul></div>
<div class="imageblock" style=""><img src="images/gilt-ror_monolith.png" alt="gilt ror monolith"></div></section><section id="slide_gilt_3"><h2>Gilt (3)</h2><div class="ulist"><ul><li><p>2011: loosely-typed monolythic JVM services</p></li></ul></div>
<div class="imageblock" style=""><img src="images/gilt-arch_evolution.png" alt="gilt arch evolution"></div></section><section id="slide_gilt_4"><h2>Gilt (4)</h2><div class="ulist"><ul><li><p>2015: microservices</p></li></ul></div>
<div class="imageblock" style=""><img src="images/gilt-arch_microservices.png" alt="gilt arch microservices"></div></section><section id="slide_gilt_5"><h2>Gilt (5)</h2><div class="ulist"><ul><li><p>Szablon serwisu</p></li></ul></div>
<div class="imageblock" style=""><img src="images/gilt-service_template.png" alt="gilt service template"></div></section><section id="slide_gilt_6"><h2>Gilt (6)</h2><div class="ulist"><ul><li><p>Szablon wdrożenia</p></li></ul></div>
<div class="imageblock" style=""><img src="images/gilt-deployment_template.png" alt="gilt deployment template"></div></section><section id="slide_gilt_7"><h2>Gilt (7)</h2><div class="imageblock" style=""><img src="images/gilt-deploy_instances.png" alt="gilt deploy instances"></div></section><section id="slide_gilt_8"><h2>Gilt (8)</h2><div class="imageblock" style=""><img src="images/gilt-deploy_ami_sizes.png" alt="gilt deploy ami sizes"></div></section><section id="slide_gilt_9"><h2>Gilt (9)</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Organizacja odpowiedzialności</p><div class="ulist"><ul><li><p>Departamenty są odpowiedzialne za aplikacje (20 +/- 4 osoby)</p></li><li><p>Zespoły (5 +/- 2 osoby) są odpowiedzialne za budowanie i monitorowanie swoich usług</p></li></ul></div></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="images/gilt-organisation.png" alt="gilt organisation"></div></div></td></tr></table></section><section id="slide_gilt_10"><h2>Gilt (10)</h2><div class="dlist"><dl><dt class="hdlist1">Aktualne wyzwania</dt><dd><div class="ulist"><ul><li><p>Testing in Production. Tylko 15% zespołów w Gilt ma środowiska testowe (<em>staging environments</em>)</p></li><li><p>Maksymalizować wykorzystanie istniejących usług AWS: Code Pipeline, Code Deploy, Cloud Formation.</p></li><li><p>Lekki narzędzie do wspierania <em>cannary releases</em>, <em>roll-out</em> i <em>roll-back</em></p></li></ul></div></dd></dl></div>
<div class="quoteblock"><blockquote><strong>Andrey’s Rule of Six:</strong> We could solve this now, or, just wait six months, and Amazon will provide a solution</blockquote><div class="attribution"><cite>Distinguished Engineer at Gilt</cite><br>&#8212; Andrey Kartashov</div></div></section><section id="slide_zalando"><h2>Zalando </h2><div class="dlist"><dl><dt class="hdlist1">2008</dt><dd><div class="ulist"><ul><li><p>Magento (monolityczne środowisko e-commerce napisane w PHP)</p></li><li><p>Problemy z <strong>wydajnością</strong></p></li></ul></div></dd><dt class="hdlist1">2010</dt><dd><div class="ulist"><ul><li><p>Spring + PostgreSQL</p><div class="ulist"><ul><li><p>Procedury składowane + wiele operacji <em>w bliskości danych</em></p></li></ul></div></li><li><p>Problemy: <strong>utrzymanie i rozszerzalność</strong></p><div class="ulist"><ul><li><p>Skalowanie zespołów (wszyscy modyfikują te same procedury składowane)</p></li><li><p>Cały serwis nie działa z powodu pojedynczego błędu</p></li><li><p>Duży codebase &#8594; zależności &#8594; koordynacja</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_zalando_2"><h2>Zalando (2)</h2><div class="dlist"><dl><dt class="hdlist1">2015</dt><dd><div class="ulist"><ul><li><p>Microserwisy: niezależne zespoły, minimalizujące zależności pomiędzy zespołami i ludźmi - <strong>decouple people and software</strong></p></li></ul></div></dd></dl></div>
<div class="imageblock" style=""><img src="images/zalando-stack.png" alt="zalando stack"></div></section><section id="slide_zalando_3"><h2>Zalando (3)</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Push the complexity down to the infrastructure</p></div></div></div>
<div class="quoteblock"><blockquote><div class="ulist"><ul><li><p>Rapid prototyping</p></li><li><p>Rapid application deployment</p></li><li><p>Basic monitoring</p></li></ul></div></blockquote><div class="attribution">&#8212; Martin Fowler</div></div></section><section id="slide_zalando_4"><h2>Zalando (4)</h2><div class="dlist"><dl><dt class="hdlist1">Jak Zalando "<em>zarządza</em>" architekturą?</dt><dd><div class="ulist"><ul><li><p>Rules of play (<a href="https://github.com/lmineiro/zalando-rules-of-play" class="bare">https://github.com/lmineiro/zalando-rules-of-play</a>)</p></li><li><p>Tech radar (<a href="https://github.com/zalando/tech-radar" class="bare">https://github.com/zalando/tech-radar</a>)</p><div class="ulist"><ul><li><p><em>A tool to help teams at Zalando make the right technology choices</em></p></li></ul></div></li><li><p>Peer reviews</p></li><li><p>Shared concepts of core business entities</p></li></ul></div></dd></dl></div></section><section id="slide_zalando_5"><h2>Zalando (5)</h2><div class="imageblock" style=""><img src="images/zalando-frontend.png" alt="zalando frontend"></div><div class="title">Duży nacisk (istotność) elementów frontend</div></section></section>
<section><section id="slide_microservices_ujęcie_organizacyjne" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Microservices - ujęcie organizacyjne</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Mikroserwisy to nie tylko technologia<br>
To także sposób organizacji pracy i firmy</td></tr></table></div></section><section id="slide_technologia_vs_organizacja"><h2>Technologia vs organizacja</h2><div class="ulist"><ul><li><p>W większości firm zespoły organizowane są wokół aspektów technicznych (ang. <em>technical capabilities</em>)</p><div class="ulist"><ul><li><p>Zajmują się poszczególnymi warstwami aplikacji (<em>frontend</em>, <em>backend</em>, <em>wdrożenia</em>)</p></li><li><p>Warstwami organizacji projektu</p></li></ul></div></li><li><p><em>Shared teams</em>: zespół UI/UX, testerzy, backendowcy, frontendowcy</p></li><li><p>Podział organizacji implikuje procesy</p><div class="ulist"><ul><li><p>Proces wprowadzania zmiany, budżetowania, akceptacji</p></li><li><p>Aby tego uniknąć zespół wszystkie zmiany stara się wprowadzić w systemach do których ma dostęp</p></li></ul></div></li></ul></div></section><section id="slide_technologia_vs_organizacja_2"><h2>Technologia vs organizacja</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/conways-law.png" alt="conways law"></div></section><section id="slide_conways_law"><h2>Conway&#8217;s Law</h2><div class="quoteblock"><blockquote>Any organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization&#8217;s communication structure.</blockquote><div class="attribution">&#8212; Melvyn Conway</div></div>
<div class="ulist"><ul><li><p>Communication issues (timezones) &#8658; strict contracts (SOAP)</p></li><li><p>Team mis-alignment and miscommunication &#8658; Adapters + Anti-corruption layers</p></li></ul></div>
<div class="admonitionblock note small"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><a href="http://www.hbs.edu/research/pdf/08-039.pdf" class="bare">http://www.hbs.edu/research/pdf/08-039.pdf</a></td></tr></table></div></section><section id="slide_conways_law_2"><h2>Conway&#8217;s Law (2)</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>(&#8230;&#8203;) can be summarized as “Dysfunctional organizations tend to create dysfunctional applications”. (&#8230;&#8203;) you can’t fix a problem from within the same mindset that created it, so it is often worth investigating whether <strong>restructuring your organization or team would prevent the new application from displaying all the same structural dysfunctions as the original</strong>.<br>
(&#8230;&#8203;) <strong>you may want to begin by breaking down silos that constrain the team’s ability to collaborate effectively</strong>.</p></div></blockquote><div class="attribution">&#8212; Inverse Conway Maneuver</div></div>
<div class="admonitionblock note small"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><a href="http://jonnyleroy.com/2011/02/03/dealing-with-creaky-legacy-platforms/" class="bare">http://jonnyleroy.com/2011/02/03/dealing-with-creaky-legacy-platforms/</a></td></tr></table></div>
<div class="admonitionblock note small"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><a href="https://intellyx.com/2015/06/22/devops-insights-into-conways-law/" class="bare">https://intellyx.com/2015/06/22/devops-insights-into-conways-law/</a></td></tr></table></div></section><section id="slide_conways_law_3"><h2>Conway&#8217;s Law (3)</h2><div class="quoteblock"><blockquote>organization which radically change their system design should expect changes in communication structure</blockquote><div class="attribution">&#8212; Inverse Conway's Law</div></div></section><section id="slide_cross_functional"><h2>Cross-functional</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/PreferFunctionalStaffOrganization.png" alt="PreferFunctionalStaffOrganization"></div></section><section id="slide_cross_functional_2"><h2>Cross-functional</h2><div class="ulist"><ul><li><p>Zespół podejmuje odpowiedzialność za dostarczenie całości rozwiązania</p><div class="ulist"><ul><li><p>Aspekt biznesowy</p></li><li><p>Interfejs użytkownika</p></li><li><p>Przechowywanie i retencja danych</p></li><li><p>Zewnętrzne integracja</p></li></ul></div></li><li><p>Zespół jest odpowiedzialny za projekt, implementacje, wdrożenie oraz za zarządzanie całością procesu</p><div class="ulist"><ul><li><p>Także za monitoring</p></li></ul></div></li><li><p><strong>Czy ktoś czuwa nad całością?</strong></p></li></ul></div></section><section id="slide_praca_projektowa_vs_praca_produktowa"><h2>Praca projektowa vs. Praca produktowa</h2><div class="ulist"><div class="title">Architektura wokół funkcjonalności biznesowych</div><ul><li><p>W świecie mikro usług szalenie ważna jest optyka <strong>produktowa</strong> nie <strong>projektowa</strong></p><div class="ulist"><ul><li><p>Projekt zakończył się z sukcesem, tzn. zakończył się o czasie, w budżecie i w założonym zakresie</p></li><li><p>Dla produktu może to nie mieć sensu</p></li><li><p>Dekompozycja produktu na projekty jest iluzoryczna</p></li></ul></div></li><li><p>Zamiast patrzeć na rozwiązanie jako listę funkcjonalności - patrzymy na wartości które usługa daje klientowi</p><div class="ulist"><ul><li><p>Zespół jest tego świadomy bo zarówno zbiera wymagania, jak i analizuje ruch produkcyjny</p></li></ul></div></li></ul></div></section><section id="slide_kryteria_stosowalności_mikro_usług"><h2>Kryteria stosowalności mikro usług?</h2><div class="ulist"><div class="title">Czy możliwe jest wyodrębnienie zasad "kiedy stosować"?</div><ul><li><p>Duże rozproszone zespoły?</p></li><li><p>Różne (sprzeczne) założenia biznesowe?</p></li><li><p>Oczekiwana skala (<em>throughput</em>)?</p></li><li><p>Oczekiwana różnorodność (integracje, hardware)</p></li></ul></div></section><section id="slide_nim_się_zdecydujemy_na_mikro_usługi"><h2>Nim się zdecydujemy na mikro usługi</h2><div class="ulist"><ul><li><p>Continuous integration / delivery</p><div class="ulist"><ul><li><p>Automatyzacja wdrożenia, <em>cannary releases</em>, <em>rollbacks</em> (?)</p></li><li><p>Kompatybilność wsteczna (na poziomie API, klas, <em>db schema</em>)</p></li></ul></div></li><li><p>Niezależność środowisk i konfiguracji</p><div class="ulist"><ul><li><p>Externalizacja konfiguracji, zmiennych środowiska, 'odnajdywalność'</p></li><li><p><em>Consumer-driven contracts</em> pomiędzy elementami interfejsu</p></li><li><p>Izolowanie błędów - <em>bulkheading</em></p></li></ul></div></li></ul></div></section><section id="slide_nim_się_zdecydujemy_na_mikro_usługi_2"><h2>Nim się zdecydujemy na mikro usługi (2)</h2><div class="ulist"><ul><li><p>Asynchroniczna komunikacja oparta o zdarzenia</p><div class="ulist"><ul><li><p>EventBus, Publish-subscribe synchronicznego zamiast HTTP</p></li><li><p>Bufory, <em>back-pressure</em></p></li><li><p>Brak współdzielenia stanu</p></li><li><p>Circuit breaking (retry policies, timeouts, default values)</p></li></ul></div></li><li><p>Dokumentacja decyzji (architektury)</p></li><li><p>Centralizacja logowania</p></li><li><p><em>Ability to fail</em></p><div class="ulist"><ul><li><p><em>Constant learning culture</em></p></li></ul></div></li></ul></div></section><section id="slide_pomiędzy_mikro_a_makro"><h2>Pomiędzy mikro a makro</h2><div class="dlist"><dl><dt class="hdlist1">Self-Contained Systems (SCS)</dt><dd><div class="ulist"><ul><li><p>Modelowanie serwisów wokół Sagi (z <em>DDD</em>) - <em>long standing transactions</em></p></li><li><p>SCS jest kompletną i autonomiczną aplikacją webową (full stack): domena, dane i procesy (logika) do przetwarzania danych. <em>Monolith per process (per context)</em></p></li><li><p>Komunikacja z innymi serwisami jest asynchroniczna (poprzez http / mq)</p></li><li><p>SCS nie współdzieli kodu z innymi systemami (<em>duplication over coupling</em>)</p></li><li><p>Analogiczne praktyki jak w obszarze mikrousług: <strong>lokalność decyzji</strong>, <strong>izolacja</strong>, <strong>skalowalność i zastępowalność (<em>replaceability</em>)</strong></p></li></ul></div></dd></dl></div>
<div class="admonitionblock note small"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><a href="http://scs-architecture.org/" class="bare">http://scs-architecture.org/</a></td></tr></table></div></section></section>
<section><section id="slide_domain_driven_design" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Domain Driven Design</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Jak dzielić dziedzinę problemu na mniejsze części?</td></tr></table></div></section><section id="slide_jak_dekomponować_mikroserwisy"><h2>Jak dekomponować mikroserwisy?</h2><div class="ulist"><ul><li><p>Jak duża powinna być mikro usługa</p></li><li><p><strong>Should do one thing, should do it well and should do it only</strong></p><div class="ulist"><ul><li><p>Miara ilościowa: 1000 LoC</p></li><li><p>Miara jakościowa: Single Responsibility Principle (<em>small enough and no smaller</em>)</p></li><li><p>Miara jakościowa: bounds a single contex</p></li></ul></div></li></ul></div></section><section id="slide_spis_treści"><h2>Spis treści</h2><div class="ulist"><ul><li><p><strong>Po co Domain Driven Design?</strong></p></li><li><p>Strategiczny rozwój systemu (ang. <em>strategic design</em>)</p></li><li><p><em>Ubiquitous language</em> – komunikacja między programistami i ekspertami dziedzinowymi</p></li></ul></div></section><section id="slide_po_co_ddd"><h2>Po co DDD?</h2><div class="ulist"><ul><li><p>Dla większość projektów, najważniejsze jest zrozumienie funkcjonowania biznesu (domeny, logiki działań w obrębie domeny)</p></li><li><p>Działania i operacje w domenie powinny być oparte o dobrze zdefiniowany model</p></li></ul></div></section><section id="slide_domain_driven_design_2"><h2>Domain Driven Design</h2><div class="ulist"><ul><li><p><strong>DDD</strong> to sposób myślenia, według którego tworzona jest architektura systemu</p></li><li><p>Nacisk położony jest na:</p><div class="ulist"><ul><li><p>Dokładne zrozumienie domeny (dziedziny) biznesowej</p></li><li><p>Wykształcania jednoznacznego języka (słownika) (<em>unambiguous language</em>)</p></li><li><p>Wszechobecny (<em>ubiquitous</em>) język dziedzinowy, w którym porozumiewają się interesariusze i programiści</p></li><li><p>Odwzorowywanie w kodzie bytów i procesów biznesowych zarówno pod względem zachowania jak i zachowania</p></li></ul></div></li></ul></div></section><section id="slide_domain_driven_design_3"><h2>Domain Driven Design</h2><div class="ulist"><ul><li><p>DDD definiuje zestaw konceptów i procedur podstępowania, za pomocą których można modelować rzeczywistość</p></li><li><p>DDD nie dostarcza wzorców i architektur w technicznym znaczeniu tego słowa</p></li></ul></div></section><section id="slide_co_to_jest_domena"><h2>Co to jest domena</h2><div class="ulist"><ul><li><p>Domena to spójny podzbiór rzeczywistości biznesowej wraz obowiązującymi tam zasadami, któremu można przypisać nazwę oraz jednoznaczną odpowiedzialność</p><div class="ulist"><ul><li><p>Finanse, kontroling</p></li><li><p>Sterowanie ruchem sieciowym</p></li></ul></div></li><li><p>Domena wyłania się naturalnie, gdy trudno nam ogarnąć to, co robimy i trzeba spojrzeć na problem z szerszej perspektywy</p></li></ul></div></section><section id="slide_izolacja_domeny"><h2>Izolacja domeny</h2><div class="ulist"><ul><li><p>Domena przekłada się na spójną jednostkę oprogramowania</p></li><li><p>Współpracujące domeny powinny być od siebie odizolowane za pomocą interfejsów</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_domain_isolation.png" alt="DDD domain isolation"></div></section><section id="slide_kiedy_stosować"><h2>Kiedy stosować?</h2><div class="ulist"><ul><li><p>Domena jest złożona (nie wszystkie domeny mają charakter obiektowy)</p></li><li><p>Zespół jest doświadczony w projektowaniu obiektowym</p></li><li><p>Eksperci domenowi są stale dostępni</p></li><li><p>Proces wytwarzania oprogramowania jest iteracyjny</p></li></ul></div></section><section id="slide_jak_odkrywać_domenę"><h2>Jak odkrywać domenę?</h2><div class="exampleblock"><div class="title">Example 1. Eventstorming</div><div class="content"><div class="paragraph"><p>a <strong>flexible</strong> workshop format for <strong>collaborative</strong> exploration of complex <strong>business domains</strong>, beyond silo and specialisation boundaries.</p></div></div></div></section><section id="slide_eventstorming" class="white background" data-background-image="images/eventstorming-30.png" data-background-size="cover"></section><section id="slide_eventstorming_2" class="white background" data-background-image="images/eventstorming-31.png" data-background-size="cover"></section><section id="slide_eventstorming_3" class="white background" data-background-image="images/eventstorming-32.png" data-background-size="cover"></section><section id="slide_eventstorming_4" class="white background" data-background-image="images/eventstorming-33.png" data-background-size="cover"></section><section id="slide_eventstorming_5" class="white background" data-background-image="images/eventstorming-34.png" data-background-size="cover"></section><section id="slide_eventstorming_6" class="white background" data-background-image="images/eventstorming-35.png" data-background-size="cover"></section><section id="slide_eventstorming_7" class="white background" data-background-image="images/eventstorming-36.png" data-background-size="cover"></section><section id="slide_eventstorming_8" class="white background" data-background-image="images/eventstorming-37.png" data-background-size="cover"></section><section id="slide_eventstorming_9" class="white background" data-background-image="images/eventstorming-38.png" data-background-size="cover"></section><section id="slide_eventstorming_10" class="white background" data-background-image="images/eventstorming-39.png" data-background-size="cover"></section><section id="slide_eventstorming_11" class="white background" data-background-image="images/eventstorming-40.png" data-background-size="cover"></section><section id="slide_eventstorming_12" class="white background" data-background-image="images/eventstorming-41.png" data-background-size="cover"></section><section id="slide_eventstorming_13" class="white background" data-background-image="images/eventstorming-42.png" data-background-size="cover"></section><section id="slide_eventstorming_14" class="white background" data-background-image="images/eventstorming-43.png" data-background-size="cover"></section><section id="slide_eventstorming_15" class="white background" data-background-image="images/eventstorming-44.png" data-background-size="cover"></section><section class="white background"><div class="imageblock" style=""><img src="images/eventstorming-196.png" alt="eventstorming 196"></div><div class="title">The self-explaining “picture that explains everything”</div></section><section id="slide_warstwy_ddd_1"><h2>Warstwy DDD (1)</h2><div class="ulist"><div class="title">Warstwa prezentacji</div><ul><li><p>Prezentowanie danych użytkownikowi</p></li><li><p>Odbieranie poleceń od użytkownika</p></li></ul></div>
<div class="ulist"><div class="title">Warstwa aplikacji</div><ul><li><p>Przekierowuje komendy użytkownika do Warstwy domeny</p></li><li><p>Nie wykonuje przetwarzania biznesowego</p></li></ul></div></section><section id="slide_warstwy_ddd_2"><h2>Warstwy DDD (2)</h2><div class="ulist"><div class="title">Warstwa domeny</div><ul><li><p>Implementuje przetwarzanie biznesowe</p></li></ul></div>
<div class="ulist"><div class="title">Warstwa infrastruktury</div><ul><li><p>Zawiera rozwiązania technologiczne takie jak: utrwalanie danych, szyny komunikacyjne itp.</p></li></ul></div></section><section id="slide_warstwy_ddd"><div class="imageblock" style=""><img src="images/DDD_Layers.png" alt="DDD Layers"></div></section><section id="slide_spis_treści_2"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Po co Domain Driven Design?</p></li><li><p><strong>Strategiczny rozwój systemu (ang. <em>strategic design</em>)</strong></p></li><li><p><em>Ubiquitous language</em> – komunikacja między programistami i ekspertami dziedzinowymi</p></li></ul></div></section><section id="slide_proces_i_potencjalne_problemy"><h2>Proces i potencjalne problemy</h2><div class="ulist"><ul><li><p>System informatyzuje pewien zakres domeny</p></li><li><p>W modelu dziedziny pojawia się wiele obiektów powiązanych ze sobą różnymi relacjami i wchodzącymi w różne interakcje</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-problemy1.png" alt="DDD Bounded Context problemy1"></div></section><section id="slide_proces_i_potencjalne_problemy_2"><h2>Proces i potencjalne problemy</h2><div class="ulist"><ul><li><p>Głównym problemem, który stara się rozwiązać DDD, to szybka odpowiedź architektury systemu na zmieniające reguły biznesowe</p></li><li><p>Przy rozbudowanym modelu może być to trudne do osiągnięcia</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-problemy2.png" alt="DDD Bounded Context problemy2"></div></section><section id="slide_bounded_context"><h2>Bounded Context</h2><div class="imageblock" style=""><img src="images/DDD_Bounded_Context.png" alt="DDD Bounded Context"></div></section><section id="slide_bounded_context_2"><h2>Bounded Context</h2><div class="paragraph"><p>Bounded Context nie oznacza enkapsulacji kodu lecz wyodrębnienie <strong>(modelowani)</strong> pewnego zagadnienia w płaszczyznach:</p></div>
<div class="ulist"><ul><li><p>Architektonicznej</p></li><li><p>Organizacyjnej</p></li><li><p>Słownikowej</p></li><li><p>Mentalnej</p></li></ul></div>
<div class="paragraph"><p>&#8203;</p></div>
<div class="quoteblock"><blockquote>Bounded contexts should have a name so that you can talk about them.</blockquote><div class="attribution">&#8212; Eric Evans</div></div></section><section id="slide_bounded_context_a_mikrousługi"><h2>Bounded Context a mikrousługi</h2><div class="ulist"><ul><li><p><em>Bounded Context</em> nie musi oznaczać osobnego serwisu; to może być osobna biblioteka (zależność runtime)</p></li><li><p>Pojedynczy <em>Bounded Context</em> - jeden zespół, jeden ekspert domenowy, jedna grupa użytkowników (klientów)</p><div class="ulist"><ul><li><p>Czy różne role muszą korzystać z tego samego kontekstu? Czy ta sama rola jest rozsiana po kilku kontekstach?</p></li><li><p>Kto odczytuje? Kto zapisuje?</p></li><li><p>Co spaja kontekst, co jest niezmienne?</p></li></ul></div></li></ul></div>
<div class="quoteblock"><blockquote>dziel systemy na małe moduły, tak abyś mógł z tych małych klocków składać większe rzeczy.</blockquote><div class="attribution">&#8212; Każdy konsultant - zawsze</div></div></section><section id="slide_relacje_między_kontekstami"><h2>Relacje między kontekstami</h2><div class="ulist"><ul><li><p>Wyodrębnienie kontekstów pozwala dostrzec relację między nimi</p></li><li><p>Poszczególne relacje dają wskazówki dotyczące organizacji pracy nad systemem</p></li><li><p>Rodzaje relacji</p><div class="ulist"><ul><li><p>Continuous Integration</p></li><li><p>Shared Kernel</p></li><li><p>Customer / Supplier</p></li><li><p>Conformist</p></li><li><p>Anti-corruption Layer</p></li><li><p>Separate Ways</p></li><li><p>Open Host Service</p></li></ul></div></li></ul></div></section><section id="slide_continuous_integration"><h2>Continuous Integration</h2><div class="ulist"><ul><li><p>Utrzymuj model i zespół w skupieniu</p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>Zespół jest mały (do pięciu osób) i dziedzina (system) nie są zbyt rozległe</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-CI.png" alt="DDD Bounded Context CI"></div></section><section id="slide_continuous_integration_2"><h2>Continuous Integration</h2><div class="ulist"><div class="title">Praktyki</div><ul><li><p>Posadź ludzi w jednym pomieszczeniu</p></li><li><p>Organizuj warsztaty projektowania</p></li><li><p>Upowszechniaj wspólny język</p></li><li><p>Dbaj, aby programiści mieli wiedzę domenową</p></li><li><p>Inicjuj spotkania programistów z ekspertami dziedzinowymi</p></li></ul></div></section><section id="slide_shared_kernel"><h2>Shared Kernel</h2><div class="ulist"><div class="title">Kiedy stosować</div><ul><li><p>Zespoły pracują nad niezależnymi elementami systemu, których część można ujednolicić</p></li></ul></div>
<div class="ulist"><div class="title">Przykłady shared kernel</div><ul><li><p>Konwersja układów współrzędnych</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-shared_kernel.png" alt="DDD Bounded Context shared kernel"></div></section><section id="slide_shared_kernel_2"><h2>Shared Kernel</h2><div class="paragraph"><p>Zmiana w jądrze wymaga zgody wszystkich współdzielących</p></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-shared_kernel2.png" alt="DDD Bounded Context shared kernel2"></div></section><section id="slide_customer_supplier"><h2>Customer / Supplier</h2><div class="ulist"><div class="title">Kiedy stosować?</div><ul><li><p>Między zespołami występuje relacja klient-dostawca</p></li><li><p>Zespoły podlegają jednemu menedżerowi</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-customer.png" alt="DDD Bounded Context customer"></div></section><section id="slide_customer_supplier_2"><h2>Customer / Supplier</h2><div class="ulist"><div class="title">Przykłady</div><ul><li><p>Dostawca</p><div class="ulist"><ul><li><p>Dostarcza usługi, zlecenia (np. <code>Zamówienia</code>)</p></li></ul></div></li><li><p>Klient</p><div class="ulist"><ul><li><p>Definiuje testy akceptacyjne, jest dostępny (np. <code>Hurtownia danych</code>)</p></li></ul></div></li></ul></div>
<div class="ulist"><div class="title">Praktyki</div><ul><li><p>Przeniesienie relacji klient-usługodawca na dwa zespoły programistyczne</p></li><li><p>Wspólne planowanie prac, definiowanie wymagań</p></li></ul></div></section><section id="slide_conformist"><h2>Conformist</h2><div class="ulist"><ul><li><p>Zespół <em>customer</em> całkowicie dopasowuje swoje działania do zespołu <em>supplier</em></p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>Zespoły są zarządzane przez menażerów mających różne cele</p></li><li><p>Zespoły są w innych lokacjach lub firmach</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-conformist.png" alt="DDD Bounded Context conformist"></div></section><section id="slide_conformist_2"><h2>Conformist</h2><div class="ulist"><div class="title">Potencjalne problemy</div><ul><li><p>Niedostępność zespołu <em>supplier</em></p></li><li><p>Brak udokumentowanego API usług tworzonych przez zespół <em>supplier</em></p></li><li><p>Zespół <em>customer</em> poświęca dużo czasu na poznawanie efektów prac zespołu <em>supplier</em></p></li></ul></div></section><section id="slide_anti_corruption_layer"><h2>Anti-corruption Layer</h2><div class="ulist"><ul><li><p>Model chroniony jest warstwą abstrakcji, która amortyzuje zewnętrzne zmiany</p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>Gdy nie ma żadnego wpływu na zespół <em>supplier</em></p></li><li><p>System korzysta z kodu legacy</p></li><li><p>System współpracuje z innymi systemami</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-anticorruption.png" alt="DDD Bounded Context anticorruption"></div></section><section id="slide_anti_corruption_layer_2"><h2>Anti-corruption Layer</h2><div class="ulist"><div class="title">Przykłady</div><ul><li><p>Wysokopoziomowe API na urządzenia sieciowe</p></li><li><p>Odizolowanie kodu napisanego w C od nowego kodu tworzonego w C++</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-anticorruption2.png" alt="DDD Bounded Context anticorruption2"></div></section><section id="slide_separate_ways"><h2>Separate Ways</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>To, że coś jest powiązane na poziomie przypadku użycia, nie oznacza, że musi być zintegrowane na poziomie architektury</p></div></blockquote><div class="attribution">&#8212; Eric Evans</div></div></section><section id="slide_separate_ways_2"><h2>Separate Ways</h2><div class="ulist"><div class="title">Kiedy stosować?</div><ul><li><p>Integracja, współpraca, koordynacja między zespołami jest zbyt uciążliwa</p></li><li><p>Obiekty z kontekstów nie współpracują ze sobą</p></li><li><p>Dane nie są wspólne dla wielu kontekstów</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-separate_ways.png" alt="DDD Bounded Context separate ways"></div></section><section id="slide_separate_ways_3"><h2>Separate Ways</h2><div class="ulist"><ul><li><p>Odseparowanie kontekstów oznacza również mentalne rozdzielnie zespołów</p></li><li><p>Zespoły</p><div class="ulist"><ul><li><p>Przestają mówić tym samym językiem</p></li><li><p>Nie spotykają się na wspólnych warsztatach</p></li><li><p>Aby się ze sobą porozumieć muszą zaczynać od pojęć na większym poziomie abstrakcji i ogólności</p></li></ul></div></li></ul></div></section><section id="slide_open_host_service"><h2>Open Host Service</h2><div class="ulist"><ul><li><p>Dobrze zdefiniowane usługi udostępniają funkcjonalności systemu zewnętrznym klientom</p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>System współpracuje z wieloma systemami</p></li><li><p>Utrzymywanie warstwy pośredniczącej jest zbyt kosztowne</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-open_host.png" alt="DDD Bounded Context open host"></div></section><section id="slide_spis_treści_3"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Po co Domain Driven Design?</p></li><li><p>Strategiczny rozwój systemu (ang. <em>strategic design</em>)</p></li><li><p><strong><em>Ubiquitous language</em> – komunikacja między programistami i ekspertami dziedzinowymi</strong></p></li></ul></div></section><section id="slide_nim_zaczniemy_modelować"><h2>Nim zaczniemy modelować</h2><div class="ulist"><ul><li><p>DDD adresuje problemy o złożonym modelu</p><div class="ulist"><ul><li><p>platforma do publikowania blogów ma relatywnie prosty model (posty, komentarze, autorzy, targi, itd.)</p></li></ul></div></li><li><p>DDD ma być platformą współpracy pomiędzy zespołem (którzy rozumieją <em>jak</em>) a ekspertami domenowymi (którzy rozumieją <em>dlaczego</em>)</p><div class="ulist"><ul><li><p>Księgowi, finansiści, ekonomiści, nauczyciele</p></li></ul></div></li><li><p>Jeżeli ekspert domenowy (osoba/osoby, które rozumieją domenę) posługują się innym żargonem niż zespół projektowy, to zachodzi potrzeba translacji (głuchy telefon)</p></li></ul></div></section><section id="slide_ubiquitous_language"><h2>Ubiquitous language</h2><div class="ulist"><ul><li><p>Wszędobylski język (albo wszechobecny język)</p><div class="ulist"><ul><li><p>nazywanie obiektów pojęciami domenowymi</p></li><li><p>nazywanie metod akcjami / czynnościami domenowymi</p></li><li><p>praca w kontekście domeny</p></li><li><p>rozróżnienie obiektów z tożsamością i bez (encje, struktury danych)</p></li></ul></div></li></ul></div></section><section id="slide_ubiquitous_language_2"><h2>Ubiquitous language</h2><div class="ulist"><ul><li><p>Nie musi być to UML - jeżeli nie przemawia on do Eksperta Domenowego</p></li><li><p>Dowolne symbole, wypracowana konwencja w obrębie zespołu - w tym Eksperta Domenowego</p></li><li><p>Szeregowi użytkownicy systemu myślą raczej historyjkami niż abstrakcyjnymi modelami</p><div class="ulist"><ul><li><p>aby Ekspert Domenowy znał i rozumiał szanse oraz ograniczenia jakie niesie technologia</p></li></ul></div></li><li><p>W projekcie powinien istnieć jeden, wspólny model domeny</p><div class="ulist"><ul><li><p>Bez rozróżnienia na różne poziomy abstrakcji (model analityczny, projektowy, developerski)</p></li></ul></div></li></ul></div></section><section id="slide_co_mówi_język"><h2>Co mówi język?</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@DomainService</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">BookKeeper</span> {
    <span class="directive">public</span> Invoice issue(Order order, TaxPolicy taxPolicy) {
        <span class="comment">//...</span>
    }
}</code></pre>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> <span class="type">void</span> addProduct(AggregateId orderId, AggregateId productId, <span class="type">int</span> quantity) {
        Reservation reservation = reservationRepository.load(orderId);
        Product product = productRepository.load(productId);

        <span class="keyword">if</span> (! product.isAvailabe()){
                Client client = loadClient();
                product = suggestionService.suggestEquivalent(product, client);
        }

        reservation.add(product, quantity);
        reservationRepository.save(reservation);
}</code></pre></section><section id="slide_co_mówi_język_2"><h2>Co mówi język?</h2><div class="ulist"><div class="title">Co dokładnie mówi nam model:</div><ul><li><p>fakturę wystawiamy na podstawie całego zamówienia</p></li><li><p>nie ma możliwości wystawienia faktury na poszczególne pozycje</p></li><li><p>nie ma możliwości wystawienia faktury zbiorczej na kilka zamówień</p></li><li><p>możemy obliczać podatki dla dowolnego kraju, jest to domknięcie operacji issue, niezależne od adresu klienta na zamówieniu</p></li></ul></div></section><section id="slide_skutki_uboczne"><h2>Skutki uboczne</h2><div class="ulist"><div class="title">Jako że model jest dokładnie oddany w kodzie, system działa tak jak rozumie to Ekspert Domenowy</div><ul><li><p>Ekspert rozumienie złożoności i kosztu zmian</p></li><li><p>Cały zespół świadomie zaciąga dług techniczny i ogranicza punkty swobody modelu</p><div class="ulist"><ul><li><p>W powyższym przykładzie: nie możemy fakturować kilku zamówień ani poszczególnych pozycji</p></li></ul></div></li></ul></div></section><section id="slide_kiedy_brakuje_języka"><h2>Kiedy brakuje języka?</h2><div class="ulist"><ul><li><p>Typowym symptomem sugerującym konieczność pochylenia się nad modelem są problemy w komunikacji</p><div class="ulist"><ul><li><p>zespół developerski zaczyna używać pojęć niezrozumiałych dla Eksperta Domenowego, niemających uzasadnienia biznesowego <code>FakeOrder</code>, <code>TemporaryItem</code></p></li><li><p>model staje zbyt złożony i wymaga "hackowania" błędnych koncepcji</p></li><li><p>zaczynamy obserwować "brodzenie" - czyli wyraźne spowolnienie prac, mierzone np. poprzez Scrum Velocity</p></li><li><p>złożoność rozwiązania zdaje się być niewspółmiernie większa niż odczuwana intuicyjnie złożoność samego problemu (<em>Accidental vs Essential Complexity</em>)</p></li></ul></div></li></ul></div></section><section id="slide_proces_budowy_języka"><h2>Proces budowy języka</h2><div class="ulist"><ul><li><p>Wraz z Ekspertem Domenowym tworzone są historyjki (opisy sekwencji biznesowych)</p></li><li><p>Budowany jest model oraz definiowane są zmiany stanu modelu</p></li><li><p>Tworzone są zręby kodu (serwisów) poprzez nagłówki klas, nazwy metod (<em>walking skeleton</em>)</p></li><li><p>Tak opracowane scenariusze formalizujemy - tworzymy wykonywalną dokumentację</p><div class="ulist"><ul><li><p>Poprzez BDD (scenariusz akceptacyjne)</p></li><li><p>Struktura <code>Given</code> (Ekspert) - <code>When</code> (Programista) - <code>Then</code> (Ekspert)</p></li></ul></div></li></ul></div></section></section>
<section><section id="slide_projektowanie_i_implementacja" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Projektowanie i implementacja</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Zasady w praktyce</td></tr></table></div></section><section id="slide_czym_jest_mikroserwis_3"><h2>Czym jest mikroserwis?</h2><div class="ulist"><ul><li><p>Niewielki problem biznesowy</p></li><li><p>Niezależny, wdrażany niezależnie i automatycznie</p></li><li><p>Działa we własnym procesie</p></li><li><p>Jest właścicielem swoich danych</p></li><li><p>Integruje się <em>explicite</em> z użyciem powszechnych interfejsów (<em>HTTP</em>)</p></li></ul></div></section><section id="slide_co_charakteryzuje_mikroserwisy"><h2>Co charakteryzuje mikroserwisy?</h2><div class="ulist"><ul><li><p><em>Smart endpoints and dumb pipes</em></p></li><li><p>Decentralizacja danych</p></li><li><p>Decentralizacja zarządzania</p></li><li><p>Automatyzacja infrastruktury</p></li></ul></div></section></section>
<section><section id="slide_co_charakteryzuje_mikroserwisy_2" class="white background"><h2>Co charakteryzuje mikroserwisy?</h2><div class="ulist"><ul><li><p><strong><em>Smart endpoints and dumb pipes</em></strong></p></li><li><p>Decentralizacja danych</p></li><li><p>Decentralizacja zarządzania</p></li><li><p>Automatyzacja infrastruktury</p></li></ul></div></section><section id="slide_smart_endpoints"><h2>Smart endpoints&#8230;&#8203;</h2><div class="ulist"><ul><li><p>Usługa jest właścicielem swoich danych</p></li><li><p>Implementuje specyficzną logikę</p></li><li><p>Działa na zasadzie potoków, stumieni</p><div class="ulist"><ul><li><p>Przyjmuje żądania</p></li><li><p>Aplikuje logikę biznesową</p></li><li><p>Zwraca odpowiedź</p></li></ul></div></li></ul></div></section><section id="slide_dump_pipes"><h2>&#8230;&#8203; dump pipes</h2><div class="ulist"><ul><li><p>Serwisy komunikują się ze sobą na zasadzie stron WWW</p><div class="ulist"><ul><li><p>HTTP request / response</p></li><li><p>Resource API (Hypermedia as the engine of application state)</p></li><li><p>Reverse DNS for service discovery</p></li></ul></div></li><li><p>Brak dodatkowej logiki na poziomie protokołu</p><div class="ulist"><ul><li><p>Jak WS-Choreography, BPEL albo centralna orchiestracja</p></li><li><p>Bez routingu, transformacji, reguł biznesowych</p></li></ul></div></li></ul></div>
<div class="quoteblock"><blockquote>Be of the web, not behind the web</blockquote><div class="attribution"><cite>REST in Practice</cite><br>&#8212; Ian Robinson</div></div></section><section id="slide_the_unix_philosophy"><h2>The Unix philosophy </h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Write programs that do one thing and do it well.</p></div>
<div class="paragraph"><p>Write programs to work together.</p></div>
<div class="paragraph"><p>Write programs to handle text streams, because that is a universal interface.</p></div></blockquote><div class="attribution"><cite>The Unix philosophy</cite><br>&#8212; Ken Thompson</div></div></section><section id="slide_the_unix_philosophy_2"><h2>The Unix philosophy (2)</h2><div class="dlist"><dl><dt class="hdlist1">The UNIX philosophy</dt><dd><div class="olist arabic"><ol class="arabic"><li><p>Make each program do one thing well. To do a new job, build afresh rather than complicate old programs by adding new "features".</p></li><li><p>Expect the output of every program to become the input to another, as yet unknown, program. Don&#8217;t clutter output with extraneous information. Avoid stringently columnar or binary input formats. Don&#8217;t insist on interactive input.</p></li><li><p>Design and build software, even operating systems, to be tried early, ideally within weeks. Don&#8217;t hesitate to throw away the clumsy parts and rebuild them.</p></li><li><p>Use tools in preference to unskilled help to lighten a programming task, even if you have to detour to build the tools and expect to throw some of them out after you&#8217;ve finished using them.</p></li></ol></div></dd></dl></div></section><section id="slide_the_unix_philosophy_3"><h2>The Unix philosophy (3)</h2><div class="paragraph"><p><code>ps aux | grep PROCESS_NAME</code></p></div>
<div class="dlist"><dl><dt class="hdlist1">Dump pipes</dt><dd><div class="ulist"><ul><li><p>Two endpoints: <code>ps</code> and <code>grep</code></p></li><li><p>Well defined protocols: <code>&lt;stdin&gt;</code> and <code>&lt;stdout&gt;</code></p></li><li><p><code>pipe</code> forwards data; data manipulation requires another endpoint</p></li><li><p>Endpoints are testable, pipe is infrastructure</p></li></ul></div></dd><dt class="hdlist1">Not so dump pipes (ESB)</dt><dd><div class="ulist"><ul><li><p>Logic implemented in the transport (message based routing)</p></li><li><p>Configuration and scripts</p></li><li><p>Workflows (routing) and message transformation</p></li></ul></div></dd></dl></div></section><section id="slide_communication_patterns"><h2>Communication patterns </h2><div class="dlist"><dl><dt class="hdlist1">Microservices pipes are communication patterns</dt><dd><div class="ulist"><ul><li><p><strong>Synchronous</strong> (Request-Response): One service invokes another service by making an explicit request, usually to store or retrieve data. The service then expects a response: either a resource or an acknowledgement.</p></li><li><p><strong>Asynchronous</strong> (Observer): Event based, implicit invocation where one service publishes an event and one or more observers that were watching for that event respond to it by running logic asynchronously, outside the awareness of the producer of the event.</p></li></ul></div></dd></dl></div></section><section id="slide_communication_patterns_2"><h2>Communication patterns (2)</h2><div class="imageblock" style=""><img src="images/pipes-centralized.png" alt="pipes centralized" width="80%"></div><div class="title">Make explicit what&#8217;s implicit</div></section><section id="slide_communication_patterns_3"><h2>Communication patterns (3)</h2><div class="ulist"><ul><li><p>The central bus may seem less scary than the network of many direct connections</p></li><li><p>Same tangle of connections still exists in the central bus. <strong>Embedded in a monolithic component</strong></p></li><li><p>A central monolith has a tendency to become excessively complex and can become a performance and engineering bottleneck.</p></li><li><p>Decentralized communications enable a parallel work on different edges of the architecture without breaking other components.</p></li></ul></div></section></section>
<section><section id="slide_co_charakteryzuje_mikroserwisy_3" class="white background"><h2>Co charakteryzuje mikroserwisy?</h2><div class="ulist"><ul><li><p><em>Smart endpoints and dumb pipes</em></p></li><li><p><strong>Decentralizacja danych</strong></p></li><li><p>Decentralizacja zarządzania</p></li><li><p>Automatyzacja infrastruktury</p></li></ul></div></section><section id="slide_decentralizacja_danych"><h2>Decentralizacja danych</h2><div class="ulist"><ul><li><p>Te same koncepcją mają różne znaczenie w rożnych obszarach</p><div class="ulist"><ul><li><p>To pewna oczywistość dla praktyków DDD</p></li><li><p>Jeżeli chcesz się pozbyć architekta na kilka lat poproś go o kanoniczne zdefiniowanie klienta dla np. ubezpieczeń</p></li></ul></div></li><li><p>Każda usługa jest właścicielem własnych danych: zarówno struktury jak i sposobów fizycznego przechowywania danych</p><div class="ulist"><ul><li><p>Wybór silnika danych (sposobu persystencji) w zależności od potrzeb projektowych</p></li><li><p>Bazy relacyjne, dokumentowe, multi-tenance, grafowe</p></li></ul></div></li><li><p>Każdy wybór (decyzja) musi być bezwzględnie udokumentowana</p></li></ul></div></section><section id="slide_decentralizacja_danych_2"><h2>Decentralizacja danych</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/decentralised-data.png" alt="decentralised data"></div></section><section id="slide_a_diagram_of_two_microservices_and_their_shared_database" data-background-image="https://pbs.twimg.com/media/Cd6UYMOWoAAgVUp.jpg:large" data-background-size="cover"><h2>A diagram of two microservices and their shared database</h2></section><section id="slide_konsekwencje"><h2>Konsekwencje</h2><div class="ulist"><ul><li><p>Lack of data consistency</p><div class="ulist"><ul><li><p>Nie ma możliwości przeprowadzenia spójnej aktualizacji po kilku bazach danych</p></li><li><p>Nie istnieje <em>two-phase commit</em></p></li></ul></div></li><li><p>Eventual consistency</p><div class="ulist"><ul><li><p>Jak zarządzać potencjalnym brakiem spójności danych</p></li><li><p>Reguły biznesowe dla błędów i pomyłek (jak w liniach lotnicznych)</p></li><li><p>Koszt poprawek jest z reguły niższy niż implementacja spójne systemu</p></li><li><p>Problemem są systemy księgowe i finansowe</p></li></ul></div></li></ul></div></section><section id="slide_polyglot_persistence"><h2>Polyglot persistence</h2><div class="dlist"><dl><dt class="hdlist1">Our storage business requirements</dt><dd><div class="ulist"><ul><li><p><strong>Data Consistency</strong></p></li><li><p><strong>Data Availability</strong></p></li></ul></div></dd><dt class="hdlist1">Our storage technical requirements</dt><dd><div class="ulist"><ul><li><p><strong>Read/Write Balance</strong> - different read and write volumes, peaks and expected throughput.</p></li><li><p><strong>Data Structure</strong> - relations vs documentsData consistency</p></li><li><p><strong>Data Querying</strong> - simple key vs multiple values from different columns</p></li><li><p><strong>Data Lifecycle</strong> - volatile, temporary nature of data, long time data retention</p></li><li><p><strong>Data Size</strong>, <strong>Data Replication</strong> and <strong>Sharding</strong></p></li></ul></div></dd></dl></div></section><section id="slide_cap_theorem"><h2>CAP theorem</h2><div class="quoteblock"><blockquote>The CAP Theorem states that, in a distributed system, you can only have two out of the following three guarantees across a write/read pair: Consistency, Availability, and Partition Tolerance - one of them must be sacrificed.</blockquote></div></section><section id="slide_cap_theorem_2"><div class="ulist"><ul><li><p><strong>Consistency</strong> - A read is guaranteed to return the most recent write for a given client</p></li><li><p><strong>Availability</strong> - A non-failing node will return a reasonable response within a reasonable amount of time (no error or timeout)</p></li><li><p><strong>Partition Tolerance</strong> - The system will continue to function when network partitions occur</p></li></ul></div>
<div class="imageblock" style=""><img src="https://robertgreiner.com/content/images/2019/09/CAP-overview.png" alt="CAP overview"></div></section><section id="slide_cap_theorem_3"><h2>CAP theorem</h2><div class="dlist"><dl><dt class="hdlist1">Given that networks aren&#8217;t completely reliable, you must tolerate partitions in a distributed system</dt><dd><div class="ulist"><ul><li><p>CP - Consistency / Partition Tolerance</p></li><li><p>AP - Availability / Partition Tolerance</p></li></ul></div></dd></dl></div></section><section id="slide_consistency_partition_tolerance"><h2>Consistency / Partition Tolerance</h2><div class="paragraph"><p>Wait for a response from the partitioned node which could result in a timeout error. The system can also choose to return an error, depending on the scenario you desire. Choose Consistency over Availability when your business requirements dictate atomic reads and writes.</p></div>
<div class="imageblock" style=""><img src="http://robertgreiner.com/content/images/2019/09/CAP-CP.png" alt="CAP CP"></div></section><section id="slide_availability_partition_tolerance"><h2>Availability / Partition Tolerance</h2><div class="paragraph"><p>Return the most recent version of the data you have, which could be stale. This system state will also accept writes that can be processed later when the partition is resolved. Choose Availability over Consistency when your business requirements allow for some flexibility around when the data in the system synchronizes. Availability is also a compelling option when the system needs to continue to function in spite of external errors (shopping carts, etc.)</p></div>
<div class="imageblock" style=""><img src="http://robertgreiner.com/content/images/2019/09/CAP-AP.png" alt="CAP AP"></div></section><section><div class="ulist"><div class="title">Consistency vs. Availability</div><ul><li><p>All information are stored in a consistent fashion (placed in a single atomic store) - <strong>consistency</strong></p></li><li><p>Information are distributed in a peer-to-peer manner (eventual consistency) - <strong>availability</strong></p></li></ul></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>(&#8230;&#8203;) it is impossible for a distributed computer system to simultaneously provide all three of the following guarantees: Consistency, Availability and Partition tolerance.</p></div></div></div></section><section><div class="imageblock" style=""><img src="http://markglh.github.io/BigData-IoT-Presentation-Slides/images/cap-theorum.png" alt="cap theorum"></div><div class="title">Database CAP</div></section><section id="slide_pacelc_theorem"><h2>PACELC theorem</h2><div class="quoteblock"><blockquote>(&#8230;&#8203;) in case of network partitioning <strong>(P)</strong> in a distributed computer system, one has to choose between availability <strong>(A)</strong> and consistency <strong>(C)</strong> (as per the CAP theorem), but else <strong>(E)</strong>, even when the system is running normally in the absence of partitions, one has to choose between latency <strong>(L)</strong> and consistency <strong>(C)</strong>.</blockquote></div></section><section><div class="imageblock" style=""><img src="https://miro.medium.com/max/4336/1*CKg81ACH_aj-RRVTnH_HWw.png" alt="1*CKg81ACH aj RRVTnH HWw"></div></section><section id="slide_jaką_bazę_wybrać"><h2>Jaką bazę wybrać? </h2><div class="ulist"><ul><li><p>Warstwa sieciowa: TCP/IP? HTTP?</p><div class="ulist"><ul><li><p>Persystetne połączenie sieciowe vs. komunikacja pakietami (możliwość przełączenia serwerów)</p></li></ul></div></li><li><p>Sposób organizacji danych: klucz-wartość, dokument, graf, <em>big table</em>, <em>wide column</em>? (pobierania wyników, zawężania wyników wyszukiwania)</p></li><li><p>Sposób przechowywania danych: w pamięci, persystentnie?</p><div class="ulist"><ul><li><p>Tylko ulotny cache czy przechowywanie danych</p></li></ul></div></li><li><p>Sposób przechowywania danych: zapis binarny, serializacja?</p></li><li><p>Retencja danych: brak, <em>least recently used</em>?</p></li><li><p>Kluster / rozproszenie: <em>share nothing</em>, <em>sharding</em>, <em>master-slave</em>?</p></li><li><p>Sposób sychronizacji: <em>point-to-point</em>, <em>ring</em>? (także pomiędzy datacentres.)</p></li></ul></div></section><section id="slide_jaką_bazę_wybrać_2"><h2>Jaką bazę wybrać? (2)</h2><div class="dlist"><dl><dt class="hdlist1">Facebook używa MySQL</dt><dd><div class="ulist"><ul><li><p>Brak JOIN&#8217;ów oraz pobierania dużych ilości danych (<em>large scans</em>)</p></li><li><p>Konfiguracja preferująca dostępność danych ponad ich spójność</p></li><li><p>Asychroniczna replikacja pomiędzy data centrami (<em>eventual consistency</em>)</p></li><li><p>Brak transakcji pomiędzy danych z różnych shard&#8217;ów</p></li><li><p>MySQL + memcache dla danych <em>social graph</em></p></li></ul></div></dd></dl></div></section><section id="slide_jaką_bazę_wybrać_3"><h2>Jaką bazę wybrać? (3)</h2><div class="dlist"><dl><dt class="hdlist1">Bazy relacyjne</dt><dd><div class="ulist"><ul><li><p>Izolacja transakcji i wersjonowanie wierszy</p><div class="ulist"><ul><li><p>Oracle, MsSQL: MVCC (heavy read)</p></li><li><p>MsSQL: lock (heavy write)</p></li></ul></div></li><li><p>Przechowywanie danych w pamięci</p><div class="ulist"><ul><li><p>Oracle: OLAP (analiza)</p></li><li><p>MsSQL: OLTP (transaction processing)</p></li></ul></div></li><li><p>Skalowanie (np. sharding)</p></li></ul></div></dd></dl></div></section><section id="slide_jaką_bazę_wybrać_4"><h2>Jaką bazę wybrać? (4)</h2><div class="dlist"><dl><dt class="hdlist1">Bazy klucz wartość</dt><dd><div class="ulist"><ul><li><p>Memcache (killer feature: <strong>cache</strong>)</p><div class="ulist"><ul><li><p>Klient musi wiedzieć który serwer odpytać</p></li></ul></div></li><li><p>Riak (killer feature: <strong>fault tolerance</strong>)</p><div class="ulist"><ul><li><p>Replikacja danych pomiędzy węzłami i pomiędzy data centers</p></li></ul></div></li><li><p>Redis (killer feature: <strong>speed</strong>)</p><div class="ulist"><ul><li><p>Samodzielna odbudowa klastra (<em>auto-healing</em>)</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_jaką_bazę_wybrać_5"><h2>Jaką bazę wybrać? (5)</h2><div class="imageblock" style=""><img src="images/column-family-store-building-blocks.png" alt="column family store building blocks"></div></section><section id="slide_jaką_bazę_wybrać_6"><h2>Jaką bazę wybrać? (6)</h2><div class="dlist"><dl><dt class="hdlist1">Bazy <em>big table</em> (optymalizacja ilości pobieranych danych)</dt><dd><div class="ulist"><ul><li><p>Cassandra  (killer feature: <strong>szybkość</strong>)</p><div class="ulist"><ul><li><p>Architektura pierścienia, spójność na poziomie komórki, szybkość odczytów i zapisów, regulowane poziomy spójności</p></li><li><p>Availability over consistency</p></li></ul></div></li><li><p>HBase (killer feature: <strong>raporty</strong>)</p><div class="ulist"><ul><li><p>Append only, Spójność na poziomie wiersza</p></li><li><p>Consistency over availability</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_jaką_bazę_wybrać_7"><h2>Jaką bazę wybrać? (7)</h2><div class="dlist"><dl><dt class="hdlist1">Bazy dokumentowe</dt><dd><div class="ulist"><ul><li><p>MongoDB (killer feature: <strong>szybkość i rozproszenie</strong>)</p><div class="ulist"><ul><li><p>Struktura danych, zapytania, filtry</p></li><li><p>Sharding oraz asynchroniczna replikacja danych (tylko odczyty z mastera są spójne)</p></li></ul></div></li><li><p>Couchbase (killer feature: <strong>Couchbase Mobile</strong>)</p><div class="ulist"><ul><li><p>Spójność na poziomie dokumentu oraz (N1QL - pseudo SQL)</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_co_musimy_rozumieć"><h2>Co musimy rozumieć? </h2><div class="ulist"><div class="title">Co to jest sharding?</div><ul><li><p>Metoda podziału danych aby pojedynczy zbiór danych (logicznie połączonych) przechowywać w kilku bazach danych</p><div class="ulist"><ul><li><p>Sharding jest konieczny jeżeli zbiór danych jest zbyt duży aby pomieścić go na jednej fizycznej maszynie</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="https://cdn-images-1.medium.com/max/800/1*yyHih3GveWruzwYgLxTu3w.png" alt="1*yyHih3GveWruzwYgLxTu3w"></div></section><section id="slide_co_musimy_zrozumieć_2"><h2>Co musimy zrozumieć? (2)</h2><pre class="CodeRay listingblock"><code class="ruby language-ruby"><span class="comment"># Partycjonowanie wertykalne</span>
fetch_user_data(user_id) -&gt; db[“USER”].fetch(user_id)
fetch_photo(photo_id) -&gt;    db[“PHOTO”].fetch(photo_id)
<span class="comment"># Partycjonowanie horyzontalne</span>
fetch_user_data(user_id) -&gt; user_db[user_id % <span class="integer">2</span>].fetch(user_id)</code></pre></section><section id="slide_co_musimy_zrozumieć_3"><h2>Co musimy zrozumieć? (3)</h2><div class="ulist"><ul><li><p>Sharding pionowy odbywa się na poziomie aplikacji</p><div class="ulist"><ul><li><p>Logika aplikacji odwołuje się do odpowiedniej bazy po odpowiednie dane</p></li></ul></div></li><li><p>Sharding poziomu odbywa się na poziomie bazy i jest dla aplikacji przeźroczysty</p><div class="ulist"><ul><li><p>np. Cassandra, MongoDB, HBase, ElasticSearch</p></li></ul></div></li><li><p>Sharding ma swoje ograniczenia</p><div class="ulist"><ul><li><p><strong>cross-partition operations</strong> - konieczność przeszukiwania po kilku bazach</p></li><li><p><strong>hotspots</strong> - nierównomierna dystrybucja danych</p></li></ul></div></li></ul></div></section><section id="slide_co_musimy_zrozumieć_4"><h2>Co musimy zrozumieć? (4)</h2><div class="ulist"><div class="title">Wybór algorytmu podziału (<em>shardingu</em>)</div><ul><li><p>W jaki sposób odczytujemy dane?</p><div class="ulist"><ul><li><p>Jeżeli batch - może lepiej dopisywać dane do końca pliku?</p></li></ul></div></li><li><p>W jaki sposób dane mają być rozproszone?</p><div class="ulist"><ul><li><p>Zrzucamy tą odpowiedzialność na serwer? Samodzielnie podejmujemy decyzje?</p></li><li><p>Nieefektywny podział powoduje powstanie <em>hotspotów</em> i potrafi zaprzepaścić korzyści rozproszenia danych</p></li></ul></div></li></ul></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>What has been sharded, cannot be unsharded <em>(easily)</em></p></div></div></div></section><section id="slide_co_musimy_zrozumieć_5"><h2>Co musimy zrozumieć? (5)</h2><div class="imageblock" style=""><img src="https://cdn-images-1.medium.com/max/800/1*fx3wbDDGHo2cgcAvDiHkDg.png" alt="1*fx3wbDDGHo2cgcAvDiHkDg"></div><div class="title">Algorithmic Sharding</div>
<div class="ulist"><ul><li><p>Klient samodzielnie podejmuje decyzję który węzeł wywołać, na podstawie funkcji hashującej</p></li><li><p>Odczyty z pojedynczego węzła lub (przy braku klucza partycji) wymuszane jest skanowanie wszystkich węzłów</p></li><li><p>Przykłady: Memchaced, Cassandra, Riak</p></li></ul></div></section><section id="slide_co_musimy_zrozumieć_6"><h2>Co musimy zrozumieć? (6)</h2><div class="ulist"><ul><li><p>Jak zachowa się nasza funkcja hashująca w momencie dodania kolejnych węzłów (serwerów)?</p><div class="ulist"><ul><li><p>W większość przypadków oznacza to konieczność ponownego przenoszenia wszystkich danych</p></li></ul></div></li><li><p>Algorytmy <em>consistent hashing</em> pozwalają łatwo dodawać kolejne wezły i automatycznie przenosić dane wraz z zachowaniem spójności</p></li><li><p>W momencie zmiany rozmiaru tablicy hasującej tylko część kluczy będzie wymagało ponownego mapowania</p><div class="ulist"><ul><li><p><code>K/n</code> (liczba kluczy / rozmiary tablicy hashującej) kluczy będzie wymagać zmiany</p></li></ul></div></li></ul></div></section><section id="slide_hashing_function"><h2>Hashing function</h2><div class="imageblock" style=""><img src="images/hashing-function.jpg" alt="hashing function"></div></section><section id="slide_hashing_function_2"><h2>Hashing function</h2><div class="imageblock" style=""><img src="images/hashing-function_2.jpg" alt="hashing function 2"></div></section><section id="slide_consistent_hashing"><h2>Consistent hashing</h2><div class="imageblock" style=""><img src="https://ik.imagekit.io/ably/ghost/medium/max/1600/1*002BDjvoadVRbPyo0lkuiQ.png?tr=w-1520" alt="1*002BDjvoadVRbPyo0lkuiQ" width="50%"></div></section><section id="slide_consistent_hashing_2"><h2>Consistent hashing</h2><div class="imageblock" style=""><img src="https://ik.imagekit.io/ably/ghost/medium/max/1600/1*yhBejrSaatHa4b0gr96tvQ.png?tr=w-1520" alt="1*yhBejrSaatHa4b0gr96tvQ" width="50%"></div></section><section id="slide_consistent_hashing_3"><h2>Consistent hashing</h2><div class="imageblock" style=""><img src="https://ik.imagekit.io/ably/ghost/medium/max/1600/1*59Mn6sT0Wu7qQJmX1FOhtw.png?tr=w-1520" alt="1*59Mn6sT0Wu7qQJmX1FOhtw" width="50%"></div></section><section id="slide_co_musimy_zrozumieć_7"><h2>Co musimy zrozumieć? (7)</h2><div class="imageblock" style=""><img src="https://cdn-images-1.medium.com/max/800/1*9we5WT45G7_unZ6n0N6ncw.png" alt="1*9we5WT45G7 unZ6n0N6ncw"></div><div class="title">Dynamic sharding</div>
<div class="ulist"><ul><li><p>Wprowadzamy do systemu <em>service locatora</em> który podejmuje decyzje z którego węzła należy skorzystać</p><div class="ulist"><ul><li><p>Wszystkie późniejsze operacje odczytu i zapisu odbywają się w obrębie pojedynczego węzła</p></li></ul></div></li></ul></div></section><section id="slide_co_musimy_zrozumieć_8"><h2>Co musimy zrozumieć? (8)</h2><div class="ulist"><ul><li><p><em>Service locator</em> to potencjalne single point of failure</p><div class="ulist"><ul><li><p>Trudno jest replikować</p></li><li><p>Misrouted reads - coś ala cache-miss w procesorach</p></li><li><p>Misrouted writes - znikające dane</p></li></ul></div></li><li><p>Takie podejście spotyka się w bazach nakierowanych na spójność a nie dostępność (Consistency over Availability)</p></li><li><p>Przykłady: Apache HBase, MongoDB</p></li></ul></div></section><section id="slide_co_musimy_zrozumieć_9"><h2>Co musimy zrozumieć? (9)</h2><div class="imageblock" style=""><img src="https://cdn-images-1.medium.com/max/800/1*o5Tv6C2bMdBn8U7Lcq3PDw.png" alt="1*o5Tv6C2bMdBn8U7Lcq3PDw"></div><div class="title">Entity groups</div>
<div class="ulist"><ul><li><p>O ile poprzednie podejścia były typowe dla baz klucz &#8594; wartość, nie jest one wystarczające dla baz relacyjnych</p></li><li><p><em>Entity grouping</em> opiera się na przechowywaniu powiązanych danych w obrębie pojedynczej partycji (i silnej spójności danych w obrębie partycji)</p></li><li><p>Przykłady: relacyjne bazy danych</p></li></ul></div></section><section id="slide_co_musimy_zrozumieć_10"><h2>Co musimy zrozumieć? (10)</h2><div class="ulist"><div class="title">Czy mamy aż tak duży zestaw danych?</div><ul><li><p>Większa maszyna</p><div class="ulist"><ul><li><p>cache i repliki - dla aplikacji typu <em>read-heavy</em></p></li></ul></div></li><li><p>Podział funkcjonalny</p><div class="ulist"><ul><li><p>Sharding tylko dla danych które tego potrzebują (duże tabele a nie kompletna baza danych)</p></li><li><p>Dobranie bazy do problemu (<em>full-text search</em>, grafy, analityka)</p></li></ul></div></li></ul></div></section><section id="slide_co_musimy_zrozumieć_11"><h2>Co musimy zrozumieć? (11)</h2><div class="olist arabic"><div class="title">Dobieranie bazy do problemu</div><ol class="arabic"><li><p>Serializowane / binarne obiekty w kolumnach <code>Blob</code></p><div class="ulist"><ul><li><p>&#8594; Key-value store</p></li></ul></div></li><li><p>Płaskie struktury obiektów bez relacji (zdenormalizowane)</p><div class="ulist"><ul><li><p>&#8594; Dokumentowe struktury danych</p></li></ul></div></li><li><p>Słowniki (dane referencyjne) przetrzymywane w pamięci (<em>in-memory cache</em>)</p><div class="ulist"><ul><li><p>&#8594; Key-value store</p></li></ul></div></li><li><p>Skomplikowane zapytanie (wielopoziomowe, wielokrotne złączenia)</p><div class="ulist"><ul><li><p>&#8594; Może struktura danych jest drzewiasta / grafowa (Neo4j)</p></li></ul></div></li><li><p>Nasz model relacyjny jest OK</p></li></ol></div></section><section id="slide_co_musimy_zrozumieć_12"><h2>Co musimy zrozumieć? (12)</h2><div class="imageblock" style=""><img src="https://image.slidesharecdn.com/rediscluster-110623004234-phpapp02/95/redis-cluster-2-728.jpg?cb=1308789816" alt="redis cluster 2 728"></div><div class="title">Point-to-point replica</div></section><section id="slide_co_musimy_zrozumieć_13"><h2>Co musimy zrozumieć? (13)</h2><div class="imageblock" style=""><img src="http://hadooptutorial.info/wp-content/uploads/2016/01/arc_write-singleDCConOne.png" alt="arc write singleDCConOne"></div><div class="title">Ring replica</div></section><section id="slide_brak_transakcji_i_kompensacja"><h2>Brak transakcji i kompensacja</h2><div class="paragraph"><div class="title">Consistency protocols</div><p>these patterns are directly derived from cache access patterns, which nicely
translate into working with polyglot persistence denormalized views and auxiliary
indexes</p></div>
<div class="paragraph"><p>these patterns respond to a million dollar question, how to keep all your
data sources in sync</p></div></section><section id="slide_write_through"><h2>write through</h2><div class="paragraph"><p>in this pattern, whenever you modify state of persistent store, you modify
state of other stores, be it by rebuilding denormalized views or updating auxiliary
indexes</p></div>
<div class="imageblock" style=""><img src="images/ditaa-write-through.png" alt="ditaa write through"></div></section><section id="slide_write_behind"><h2>write behind</h2><div class="paragraph"><p>in this pattern, whenever you modify state of persistent store, you modify state
state of other stores, but asynchronously,</p></div>
<div class="imageblock" style=""><img src="images/ditaa-write-behind.png" alt="ditaa write behind"></div></section><section id="slide_read_through"><h2>read through</h2><div class="paragraph"><p>you update views on first read from master persistent store,<br>
be careful on consistency, it would be good to invalidate entries in views on
write</p></div>
<div class="imageblock" style=""><img src="images/ditaa-read-through.png" alt="ditaa read through"></div></section><section id="slide_pubsub"><h2>pubsub</h2><div class="paragraph"><p>publish/subscribe, where incoming write operation is published on topic, and
all subscribed store are performing updates<br>
it works when update to master doesn&#8217;t require processing of the message which
remaining stores need to be aware off or all stores are equal among others</p></div>
<div class="imageblock" style=""><img src="images/ditaa-pub-sub.png" alt="ditaa pub sub" width="80%"></div></section><section id="slide_przykład"><h2>Przykład</h2><div class="ulist"><div class="title">Co robi GMail?</div><ul><li><p>przechowuje maile</p></li><li><p>umożliwia wyszukiwanie po pełnym tekście wiadomości</p></li><li><p>podpowiada znajomych (friends circle) oraz relacje pomiędzy wiadomościami</p></li></ul></div></section><section><div class="imageblock" style=""><img src="images/ditaa-gmail.png" alt="ditaa gmail"></div></section></section>
<section><section id="slide_co_charakteryzuje_mikroserwisy_4" class="white background"><h2>Co charakteryzuje mikroserwisy?</h2><div class="ulist"><ul><li><p><em>Smart endpoints and dumb pipes</em></p></li><li><p>Decentralizacja danych</p></li><li><p><strong>Decentralizacja zarządzania</strong></p></li><li><p>Automatyzacja infrastruktury</p></li></ul></div></section><section id="slide_decentralizacja_zarządzania"><h2>Decentralizacja zarządzania</h2><div class="ulist"><ul><li><p>Każdy zespół wybiera możliwie najlepsze narzędzia i metody</p><div class="ulist"><ul><li><p>Sposób wytwarzania</p></li><li><p>Stos technologiczny</p></li></ul></div></li><li><p>Poruszamy się w obrębie konwencji a nie standardów</p></li><li><p>&#8230;&#8203; ale co zrobić na dyżurze?</p></li></ul></div></section><section id="slide_architecture_board"><h2>Architecture board</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Organizacja odpowiedzialności</p><div class="ulist"><ul><li><p>Departamenty są odpowiedzialne za aplikacje (20 +/- 4 osoby)</p></li><li><p>Zespoły (5 +/- 2 osoby) są odpowiedzialne za budowanie i monitorowanie swoich usług</p></li></ul></div></li></ul></div>
<div class="admonitionblock note small"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><a href="https://github.com/gilt/arch-board" class="bare">https://github.com/gilt/arch-board</a></td></tr></table></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="images/gilt-organisation.png" alt="gilt organisation"></div></div></td></tr></table></section><section id="slide_architecture_guild"><h2>Architecture guild</h2><div class="ulist"><ul><li><p>Align the architecture of the system to the business goals</p></li><li><p>Find and recommend solutions to shared problems</p></li><li><p>Share architecture and technical knowledge</p></li></ul></div></section><section id="slide_architecture_guild_2"><h2>Architecture guild (2)</h2><div class="dlist"><dl><dt class="hdlist1">Align the architecture of the system to the business goals</dt><dd><p>When the architecture does not correspond to the goals of the organization, implementing each new feature takes longer with time, or even becomes impossible. The old monolithic backend system is a good example of architecture that went in the opposite direction.</p></dd></dl></div></section><section id="slide_architecture_guild_3"><h2>Architecture guild (3)</h2><div class="dlist"><dl><dt class="hdlist1">Find and recommend solutions to shared problems</dt><dd><p>Infrastructure and cross cutting concerns are shared between teams, so it makes sense to share the solutions to common problems among the organization. The architecture guild is responsible for recommendations to issues that have long lasting consequences or a high cost of change. This is especially important if a decision by one team, influences other teams.<br>
Examples:</p><div class="ulist"><ul><li><p>using Apache Kafka for messaging and stream processing.</p></li><li><p>building Tailored Service Templates for teams to jumpstart new services.</p></li><li><p>providing required cost-effective Databases for common topologies (key-value, document, relational. etc.).</p></li></ul></div></dd></dl></div></section><section id="slide_architecture_guild_4"><h2>Architecture guild (4)</h2><div class="dlist"><dl><dt class="hdlist1">Share architecture and technical knowledge</dt><dd><p>Make sure that all the teams have necessary architecture vision and knowledge, with good visibility into how the system works, and where it is heading. This is achieved by providing architecture diagrams, consulting all decision with people that have to work with its consequences, and involving all the business and IT in the aligning process.</p></dd></dl></div></section><section id="slide_co_najwięcej_powie_o_aplikacji"><h2>Co najwięcej powie o aplikacji</h2><div class="ulist"><ul><li><p>Warstwy (dostęp do danych, logika, widoki)?</p></li><li><p>Procesy?</p></li><li><p>Dane?</p></li><li><p>Infrastruktura?</p></li></ul></div></section><section id="slide_warstwy"><div class="imageblock" style=""><img src="images/introduction-leaky_abstraction.png" alt="introduction leaky abstraction"></div><div class="title">Warstwy aplikacji</div></section><section><div class="imageblock" style=""><img src="http://static.codingthearchitecture.com/presentations/oreillysaconlondon2016-modular-monoliths/slides/slide.081.png" alt="slide.081"></div></section><section><div class="imageblock" style=""><img src="http://static.codingthearchitecture.com/presentations/oreillysaconlondon2016-modular-monoliths/slides/slide.083.png" alt="slide.083"></div></section><section><div class="imageblock" style=""><img src="http://static.codingthearchitecture.com/presentations/oreillysaconlondon2016-modular-monoliths/slides/slide.086.png" alt="slide.086"></div></section><section id="slide_problemy_z_projektowaniem"><div class="imageblock" style=""><img src="images/introduction-architecture_vs_reality.png" alt="introduction architecture vs reality"></div><div class="title">Problemy z projektowaniem</div></section><section id="slide_problemy_z_projektowaniem_2"><div class="imageblock" style=""><img src="images/introduction-architecture_vs_reality-eb1.png" alt="introduction architecture vs reality eb1"></div><div class="title">Problemy z projektowaniem</div></section><section id="slide_problemy_z_projektowaniem_3"><div class="imageblock" style=""><img src="images/introduction-architecture_vs_reality-eb2.png" alt="introduction architecture vs reality eb2"></div><div class="title">Problemy z projektowaniem</div></section><section id="slide_pojmowanie_architektury"><h2>Pojmowanie architektury</h2><div class="ulist"><ul><li><p>"Architektura" starzeje się bardzo szybko</p><div class="ulist"><ul><li><p><em>Too much design in the architecture</em></p></li><li><p>"Odcinamy się" w złym momencie, dokumenty architektoniczne zawierają zbyt dużo mało istotnych szczegółów implementacyjnych</p></li><li><p><em>We architect the wrong thing</em></p></li></ul></div></li></ul></div></section><section id="slide_pojmowanie_architektury_2"><h2>Pojmowanie architektury (2)</h2><div class="ulist"><ul><li><p>Architektura - wyznacza kierunek</p><div class="quoteblock"><blockquote><div class="paragraph"><p>Two architectural questions:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>What is the structure of the system?</p></li><li><p>What is the purpose of such structure?</p></li></ol></div></blockquote></div></li><li><p>Projekt - szczegóły opisu</p></li></ul></div></section><section id="slide_pojmowanie_architektury_2_2"><h2>Pojmowanie architektury (2)</h2><div class="ulist"><div class="title">Gdzie to przypiąć?</div><ul><li><p>kontekst biznesowy</p></li><li><p>przypadki i tempo zmian</p></li><li><p>kontekst organizacji</p><div class="ulist"><ul><li><p>Czy da się pozyskać ludzi do projektu, jak wygląda rynek pracy?</p></li><li><p>potencjał kompetencyjny zespołu</p></li></ul></div></li><li><p>przypadki zmian (częstotliwość, intensywność, różnorodność)</p></li><li><p>analiza systemu: interakcje z otoczeniem, przetwarzanie zadań, zakres zmian, bezpieczeństwo,  <strong>czas życia i dostępność, trwałość danych</strong></p></li><li><p>czy to jest <em>core domain</em> (buy before you build)?</p></li></ul></div></section><section id="slide_pojmowanie_architektury_3"><h2>Pojmowanie architektury (3)</h2><div class="ulist"><div class="title">Mikro usługi</div><ul><li><p>Ciągła ewolucja systemu (no <em>end-state</em>)</p><div class="ulist"><ul><li><p>Sposób zarządzania zmianą (ewolucją systemu)</p></li></ul></div></li><li><p>Szczegóły implementacyjne poszczególnych usług mają pośrednie znaczenie dla całości rozwiązania (enkapsulacja)</p><div class="ulist"><ul><li><p>Tak długo jak spełniane są oczekiwania innych, współpracujących serwisów</p></li></ul></div></li><li><p>Istotny jest strumień i struktura płynących przez system danych oraz interakcje pomiędzy poszczególnymi usługami.</p></li></ul></div></section><section id="slide_oczekiwania_biznesu"><h2>Oczekiwania "biznesu"</h2><div class="ulist"><ul><li><p>Żeby było szybko</p><div class="ulist"><ul><li><p>Rozwiązania architektoniczne powinny <strong>szybko</strong> zaradzić problemom</p></li><li><p>Brak <strong>zdefiniowanego procesu</strong> pracy nad architekturą</p></li><li><p>Rozwój architektury powinien odbywać się <strong>w międzyczasie</strong></p></li></ul></div></li><li><p>Ewolucja nie rewolucja</p><div class="ulist"><ul><li><p>Nie zmieniać od razu wszystkiego, lecz stopniowo tylko to, co konieczne</p></li><li><p>Architektura <strong>powinna dojrzewać</strong> wraz z funkcjonalnościami systemu</p></li><li><p>Zapominamy, że ewolucja również wymaga czasu</p></li></ul></div></li></ul></div></section><section id="slide_oczekiwania_biznesu_2"><h2>Oczekiwania "biznesu" (2)</h2><div class="ulist"><ul><li><p>Dużo magicznych sztuczek</p><div class="ulist"><ul><li><p>Sprytny trik architektoniczny rozwiąże problemy</p></li><li><p>Nie zmieniać zbyt wiele, a jedynie nieznacznie zmodyfikować</p></li><li><p>Nie potrzeba na to zbyt wiele wysiłku</p></li></ul></div></li></ul></div></section><section id="slide_obawy_senior_programisty"><h2>Obawy senior programisty</h2><div class="ulist"><ul><li><p>Jak się do tego zabrać?</p><div class="ulist"><ul><li><p>Czym zająć się w pierwszej kolejności</p></li><li><p>Jak wybrać pomiędzy alternatywnymi rozwiązaniami problemu?</p></li><li><p>Kto powinien zająć się poprawianiem architektury?</p></li><li><p>Jak się upewnić, czy wszystko wciąż działa?</p></li><li><p>Czy mam wystarczającą wiedzę i umiejętności?</p></li></ul></div></li></ul></div></section><section id="slide_obawy_senior_programisty_2"><h2>Obawy senior programisty (2)</h2><div class="ulist"><ul><li><p>Co mi wolno?</p><div class="ulist"><ul><li><p>Czy trzeba poprosić kogoś o zgodę? Kogo?</p></li><li><p>Jak przekonać moich zwierzchników że warto?</p></li><li><p>Ile czasu zajmą zmiany?</p></li><li><p>Czy to jest właściwy moment, aby się tym zająć?</p></li></ul></div></li><li><p>Czy to jest moja sprawa?</p><div class="ulist"><ul><li><p>Brak poczucia odpowiedzialności za architekturę</p></li><li><p>Koncentrowanie się wyłącznie na własnym fragmencie kodu</p></li><li><p>Nienazwany proces nie będzie działał</p></li></ul></div></li></ul></div></section><section id="slide_jak_zalando_zarządza_architekturą"><h2>Jak Zalando "<em>zarządza</em>" architekturą?</h2><div class="ulist"><ul><li><p>Tech radar (<a href="https://github.com/zalando/tech-radar" class="bare">https://github.com/zalando/tech-radar</a>)</p><div class="ulist"><ul><li><p><em>A tool to help teams at Zalando make the right technology choices</em></p></li></ul></div></li><li><p>Rules of play (<a href="https://github.com/lmineiro/zalando-rules-of-play" class="bare">https://github.com/lmineiro/zalando-rules-of-play</a>)</p></li><li><p>Peer reviews</p></li><li><p>Shared concepts of core business entities</p></li></ul></div></section><section id="slide_tech_radar"><h2>Tech-radar </h2><div class="ulist"><div class="title">Dlaczego budować własny <em>tech-radar</em>?</div><ul><li><p>Będąc zaangażowanym w projekt żyjemy w swego rodzaju bańce</p><div class="ulist"><ul><li><p>Ciężko nadążać na zmianami poza naszym własnym środowiskiem</p></li></ul></div></li><li><p>Tech-radar do "żyjący" dokument - ulegający regularnym modyfikacją (np. podczas regularnych spotkań face-to-face)</p></li><li><p>Balans ryzyka nowych technologii i poziomu adopcji rozwiązań</p></li><li><p>Ciągłość analizy: śledzenie zmian, adopcji i powtarzalności</p></li><li><p>Spójne narzędzie wspierające decyzje projektowe pomiędzy zespołami</p><div class="ulist"><ul><li><p>Plus komunikat do organizacji (prezentacje, spotkania wewnętrzne)</p></li></ul></div></li></ul></div></section><section id="slide_tech_radar_2"><h2>Tech-radar (2)</h2><div class="imageblock" style=""><img src="https://practicalli.github.io/clojure/images/thoughtworks-tech-radar.png" alt="thoughtworks tech radar"></div></section><section id="slide_tech_radar_3"><h2>Tech-radar (3)</h2><div class="ulist"><ul><li><p>Poza samą informację o technologiach (nazwą) dobrze jest utrzymywać opis: co, dlaczego, po co oraz opis ryzyk związanych z technologiami</p><div class="ulist"><ul><li><p>Np. React.js i kwestie licencji (BSD + patents)</p></li><li><p>Doświadczenie zespołów oraz problemy / zyski</p></li></ul></div></li><li><p>Sama mapa technologii nie jest wystarczająca bez powiązania z decyzjami technicznymi poszczególnych zespołów <em>(technology peer review)</em></p></li></ul></div></section><section id="slide_zalando_rules_of_play"><h2>Zalando "Rules of play"</h2><div class="ulist"><ul><li><p>Każdy chciałby aby jego aplikacje były: <em>resilient, extensible, maintainable, scalable on demand</em></p><div class="ulist"><ul><li><p>Same określenie własności aplikacji (<strong>co</strong>) nie gwarantuje zachowania jakości oraz nie daje kierunkowskazu (<strong>jak</strong>)</p></li></ul></div></li><li><p><em>"Rules of play</em> to zestaw zasad (pryncypiów architektonicznych) które są podstawą usług w Zalando</p><div class="ulist"><ul><li><p>jak budować serwisy</p></li><li><p>jak dzielić (dekomponować)</p></li><li><p>jak wdrażać</p></li><li><p>jak pracować z <em>legacy</em></p></li></ul></div></li></ul></div></section><section id="slide_zwinna_architektura_w_korporacji"><h2>Zwinna architektura w korporacji</h2><div class="ulist"><ul><li><p>Zalando "Rules of play" opiera się na konwencjach i minimalizuje biurokrację</p><div class="ulist"><ul><li><p>Serwis "na produkcji" jest istotniejszy niż jego dokumentacja</p></li><li><p>Zespół który go zbudował, wdraża go i monitoruje - minimalizuje to ilość potrzebnej dokumentacji i opisów</p></li><li><p>Nie dokumentujmy za dużo, skoro i tak czas życie serwisów jest krótki</p></li></ul></div></li></ul></div></section><section id="slide_zwinna_architektura_w_korporacji_2"><h2>Zwinna architektura w korporacji (2)</h2><div class="ulist"><div class="title">Jak mało dokumentacji wystarczy korporacji?</div><ul><li><p>Reguły, zasady, wskazówki dotyczące architektury (<em>architecture principles</em>)</p></li><li><p>Zasady stanowią pomosty łączące poszczególne wartości z rezultatami.</p><div class="ulist"><ul><li><p>Wartości (<em>prostota, elastyczność</em>) są uniwersalne, trudno jednak stosować je
bezpośrednio</p></li></ul></div></li><li><p>Zasady wyznaczają kierunek rozwiązań (<em>Solution Architecture / Solution Description</em>)</p></li><li><p>Warunkiem sukcesu jest uczestnictwo <em>"architekta"</em> w procesie wytwarzania (ciągłość przekazywania wiedzy)</p></li></ul></div></section><section id="slide_pryncypia_architektoniczne"><h2>Pryncypia architektoniczne</h2><div class="ulist"><ul><li><p>Application requests must be traceable with Shared Components</p></li><li><p>Breaking changes must be detected at design-time</p></li><li><p>Contract first development</p></li><li><p>Documentation for Shared Components API must be provided</p></li><li><p>Encrypt a communications channel for sensitive data</p></li><li><p>Internal services use rest/http (json) / external services should be SOAP compliant</p></li><li><p>Services (everything under UI) should be stateless</p></li><li><p>Services must be self-documenting</p></li></ul></div></section><section id="slide_przykład_2"><h2>Przykład</h2><div class="paragraph"><p><strong>Application requests must be traceable with Shared Components</strong></p></div>
<div class="paragraph"><div class="title">Rationale</div><p>A Reactive Application are in their essence Message driven, the calls are always asynchronous, so from the caller’s point of view, it makes the call, and then sometime later a result appears.
When the requestor creates a request message, it assigns the request a request ID—an identifier that is different from those for all othercurrently outstanding requests, that is, requests that do not yet have replies.
When the replier processes the request, it saves the request ID and adds that ID to the reply as a correlation ID.
When the requestor processes the reply, it uses the correlation ID to know which request the reply is for. This is called a Correlation Identifier because of the way the caller uses the identifier to correlate (i.e., match; show the relationship) each reply to the request that caused it.</p></div></section><section id="slide_przykład_3"><h2>Przykład</h2><div class="paragraph"><p><strong>Application requests must be traceable with Shared Components</strong></p></div>
<div class="olist arabic"><div class="title">Implications</div><ol class="arabic"><li><p>Correlation id should be an element of Shared Components API</p></li><li><p>User’s request flow must be reproducible based on log files and the correlation id</p></li></ol></div></section><section id="slide_przykład_2_2"><h2>Przykład (2)</h2><div class="paragraph"><p><strong>Services must be self-documenting</strong></p></div>
<div class="paragraph"><div class="title">Rationale</div><p>When a service contract is explored, this service must be self-explanatory. The required documentation for the service should be minimal, and mainly serve to explain the semantics of the used query parameters and media-types)</p></div></section><section id="slide_przykład_2_3"><h2>Przykład (2)</h2><div class="paragraph"><p><strong>Services must be self-documenting</strong></p></div>
<div class="olist arabic"><div class="title">Implications</div><ol class="arabic"><li><p>If WS-* web service is used, WSDL will serve as the base for the documentation.</p></li><li><p>The REST services should use relations and links to show intent regarding how these services should be used.</p></li><li><p>For REST services a text document must be created and stored in the repository together with the REST service definition</p><div class="ulist"><ul><li><p>This document explains, in a human-readable manner, how the service is to be used.</p></li><li><p>Appropriate tooling should be used to provide comprehensive documentations in the least invasive way</p></li></ul></div></li></ol></div></section><section id="slide_czy_potrzebuje_do_tego_mikroserwisów"><h2>Czy potrzebuje do tego mikroserwisów?</h2><div class="ulist"><ul><li><p>Wartości są uniwersalne, to samo podejście można stosować przy architekturach monolitycznych</p></li><li><p>Współodpowiedzialny, cross-funkcjonalny zespół</p><div class="ulist"><ul><li><p>Trudniej jest to przeprowadzić dla dużej grupy ludzi</p></li><li><p>Projekt monolityczny obejmuje swoim zakres zbyt wiele domen aby było to pojmowalne przez pojedyncze osoby</p></li></ul></div></li><li><p>W mniejszych zespołach łatwiej zbudować komunikację i nieformalny przepływ informacji</p></li></ul></div></section><section id="slide_zarządzanie_architekturą"><h2>Zarządzanie architekturą</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Lokalne decyzje to nie oznacza anarchii i dowolności we wszystkich możliwych elementach</p></div></div></div></section><section id="slide_integration_architecture_principles"><h2>Integration Architecture Principles</h2><div class="ulist"><div class="title">Przykładowy zestaw reguł dla procesów integracyjnych</div><ul><li><p>Szyna <em>(defined broadly)</em> nie może zawierać logiki aplikacyjnej</p></li><li><p>Proces komunikacji pomiędzy serwisami musi być spójny</p></li><li><p>Rozwój serwisów jest transparentny i dobrze zdefiniowany</p></li><li><p>Logi w obrębie systemu wykorzystywane są w celach statystycznych</p></li><li><p>SOAP do integracji z zewnętrznymi aplikacjami (contract-first), REST do integracji wewnętrznej</p></li></ul></div></section><section id="slide_principles_example_1"><h2>Principles example (1)</h2><div class="ulist"><div class="title">SOAP do integracji z zewnętrznymi aplikacjami (contract-first)</div><ul><li><p>Komunikacja z zewnętrznymi partnerami (<em>vendorami</em>) wymaga ściśle określonego kontraktu</p></li><li><p>Nie mamy wpływu na to w jaki sposób zewnętrzne zespoły realizują (implementują, konsumują) serwisy</p></li><li><p>Specyfikacje SOAP / WSDL / XSD umożliwiają adekwatne opisanie serwisu udostępnianego (konsumowanego) przez organizację</p><div class="ulist"><ul><li><p>Ograniczone są w ten sposób potencjalne błędy semantyczne i syntaktyczne w komunikacji pomiędzy różnymi partnerami</p></li></ul></div></li></ul></div></section><section id="slide_principles_example_2"><h2>Principles example (2)</h2><div class="ulist"><div class="title">REST do integracji wewnętrznej</div><ul><li><p>Do komunikacji wewnątrz aplikacji (organizacji) wystarczające jest podejście RESTful</p><div class="ulist"><ul><li><p>Unikamy nadmiarowego i skomplikowane standardu SOAP do serwisów które mają był łatwe do używania i tworzenia; które działają pomiędzy różnymi elementami wewnątrz systemu</p></li><li><p>Dla serwisów RESTowych oczekiwane jest wykorzystanie HATEOAS ("Hypermedia as the engine of application state") - ułatwiających stworzenie dobrego systemu wersjonowania usług, definicji przesyłanych struktur danych oraz powiązań pomiędzy zasobami.</p></li></ul></div></li></ul></div></section><section id="slide_implementation_principles"><h2>Implementation Principles</h2><div class="ulist"><ul><li><p>GIT for source control</p></li><li><p>JVM languages unless</p></li><li><p>MongoDB for non-relational storage</p></li><li><p>MySQL for relational storage</p></li><li><p>Services must follow a specific versioning scheme</p></li></ul></div></section><section id="slide_principles_example"><h2>Principles example</h2><div class="paragraph"><p>Services must follow a specific versioning scheme</p></div>
<div class="paragraph"><div class="title">Rationale</div><p>There are breaking and non-breaking changes when new functionality is added to a service. Each REST service should follow a specific versioning scheme, to make sure consumers know when they need to upgrade and what the effect on consumer code is.</p></div>
<div class="olist arabic"><div class="title">Implications</div><ol class="arabic"><li><p>WSDLs and schemas must be set up in such a way that they can be easily versioned. This means that we have to make sure the namespaces used reflect the correct version of a service or message.</p></li><li><p>REST services will also have to be versioned. This means that in their content-type description a version number must be present.</p></li></ol></div></section><section id="slide_jak_to_się_przekłada_na_konkrety"><h2>Jak to się przekłada na konkrety?</h2><div class="ulist"><ul><li><p><strong>Preferencja rozwiązań REST</strong></p><div class="ulist"><ul><li><p>niczego nie możemy być pewni - problemy trzeba znajdywać wcześniej niż na produkcji</p></li></ul></div></li><li><p><strong>Services must be self-documenting</strong></p><div class="ulist"><ul><li><p>trzeba w automatyczny sposób budować dokumentację oraz opisy poszczególnych usług</p></li></ul></div></li><li><p><strong>Services must follow a specific versioning scheme</strong></p><div class="ulist"><ul><li><p>usługi należy wersjonować - strategia wersjonowania jest wtórna</p></li></ul></div></li></ul></div></section><section id="slide_jak_to_się_przekłada_na_konkrety_2"><h2>Jak to się przekłada na konkrety? (2)</h2><div class="ulist"><ul><li><p><strong>Contract first development</strong></p><div class="ulist"><ul><li><p><em>Consumer</em> zawiera oczekiwania wobec <em>Providera</em> w formie kontaktu</p></li><li><p>Kontrakt jest oddzielnym dokumentem, oddzielnie wersjonowanym</p></li><li><p>Kontrakty są współdzielone z <em>providerem</em> (daje to wgląd dostawcy jakie są oczekiwania wobec niego)</p></li><li><p><em>Provider</em> i może automatycznie testować czy wprowadzane zmiany nie naruszają kontraktów</p></li><li><p><em>Consumer</em> może weryfikować niezmienność kontraktu na wcześniejszych etapach</p></li></ul></div></li></ul></div></section><section id="slide_driving_architecture_with_principles"><h2>Driving architecture with principles</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Pryncypia architektoniczne nabierają jeszcze większego znaczenia - inaczej każdy serwis będzie inny</p></div></div></div></section><section id="slide_dokumentowania_rozwiązania"><h2>Dokumentowania rozwiązania</h2><div class="ulist"><ul><li><p>Pre <strong>Solution Architecture</strong></p><div class="ulist"><ul><li><p>Stakeholders and Concerns</p></li><li><p>Principles and Constraints</p></li><li><p>Functional requirements</p></li><li><p>Tasks (<em>areas of consideration</em>)</p></li></ul></div></li><li><p><strong>Solution Architecture</strong> - Solution Description</p><div class="ulist"><ul><li><p>Solution Context, Logical View, Implementation View</p></li><li><p>Assessment - reflect on the architecture from the perspective of the most important input statements</p></li></ul></div></li></ul></div></section><section id="slide_dokumentowania_rozwiązania_2"><h2>Dokumentowania rozwiązania</h2><div class="paragraph"><p><strong>Context</strong> section should answer the following types of questions:</p></div>
<div class="ulist"><ul><li><p>What is this software project/product/system all about?</p></li><li><p>What is it that&#8217;s being built?</p></li><li><p>How does it fit into the existing environment? (e.g. systems, business processes, etc)</p></li><li><p>Who is using it? (users, roles, actors, personas, etc)</p></li></ul></div></section><section id="slide_dokumentowania_rozwiązania_3"><h2>Dokumentowania rozwiązania</h2><div class="paragraph"><p><strong>Functional overview</strong> are key functions of the system (use cases, user stories, etc). A functional overview should answer the following types of questions:</p></div>
<div class="ulist"><ul><li><p>Is it clear what the system actually does?</p></li><li><p>Is it clear who the important users are (roles, actors, personas, etc) and how the system caters for their needs?</p></li><li><p>Is it clear what the system does from a process perspective?</p></li><li><p>What are the major processes and flows of information through the system?</p></li></ul></div></section><section id="slide_dokumentowania_rozwiązania_4"><h2>Dokumentowania rozwiązania</h2><div class="dlist"><dl><dt class="hdlist1">Constraints</dt><dd><div class="ulist"><ul><li><p>Time, budget and resources.</p></li><li><p>Approved technology lists and technology constraints.</p></li><li><p>Target deployment platform.</p></li><li><p>Existing systems and integration standards.</p></li><li><p>Local standards (e.g. development, coding, etc).</p></li><li><p>Public standards (e.g. HTTP, SOAP, XML, XML Schema, WSDL, etc).</p></li><li><p>Standard protocols.</p></li><li><p>Standard message formats.</p></li><li><p>Size of the software development team.</p></li><li><p>&#8230;&#8203;</p></li></ul></div></dd></dl></div></section><section id="slide_dokumentowania_rozwiązania_5"><h2>Dokumentowania rozwiązania</h2><div class="paragraph"><p>Which <strong>architecture principles</strong> do apply in the given context?</p></div>
<div class="ulist"><ul><li><p>Architectural layering strategy.</p></li><li><p>The Hollywood principle (don&#8217;t call us, we&#8217;ll call you).</p></li><li><p>DRY (don&#8217;t repeat yourself) / Prefer duplication over coupling</p></li><li><p>Ensure all components are stateless (e.g. to ease scaling).</p></li><li><p>Prefer a rich domain model / Prefer an anaemic domain model.</p></li><li><p>Always prefer stored procedures / Never use stored procedures.</p></li><li><p>Buy rather than build.</p></li></ul></div></section><section id="slide_software_architecture_document"><h2>Software Architecture document</h2><div class="ulist"><ul><li><p>What does the "big picture" look like?</p></li><li><p>Is there are clear structure?</p></li><li><p>Is it clear how the system works from the "30,000	 foot view"?</p></li><li><p>Does it show the major containers and technology choices?</p></li><li><p>Does it show the major components and their interactions?</p></li><li><p>What are the key internal interfaces? (e.g. a web service between your web and business tiers)</p></li></ul></div></section><section id="slide_dokumentowanie_decyzji"><h2>Dokumentowanie decyzji </h2><div class="ulist"><ul><li><p>Architektura to historia podjętych (albo nie) decyzji</p></li><li><p>Decyzje mają:</p><div class="ulist"><ul><li><p>Tytuł</p></li><li><p>Kontekst</p></li><li><p>Decyzję</p></li><li><p>Status (zaakceptowana, odrzucona)</p></li><li><p>Konsekwencje</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><a href="http://thinkrelevance.com/blog/2011/11/15/documenting-architecture-decisions">Michael Nygard - Documenting Architecture Decisions</a></p></div>
<div class="paragraph"><p><a href="https://github.com/npryce/adr-tools">Nat Pryce - A command-line tool for working with Architecture Decision Records</a></p></div></section><section id="slide_dokumentowanie_decyzji_2"><h2>Dokumentowanie decyzji (2)</h2><div class="dlist"><dl><dt class="hdlist1">Title</dt><dd><p>These documents have names that are short noun phrases. For example, "<em>ADR 1: Deployment on Ruby on Rails 3.0.10</em>" or "<em>ADR 9: LDAP for Multitenant Integration</em>"</p></dd></dl></div>
<div class="quoteblock"><blockquote><div class="paragraph"><p>ADR004: Markdown format</p></div></blockquote></div></section><section id="slide_dokumentowanie_decyzji_3"><h2>Dokumentowanie decyzji (3)</h2><div class="dlist"><dl><dt class="hdlist1">Context</dt><dd><p>This section describes the forces at play, including technological, political, social, and project local. These forces are probably in tension, and should be called out as such. The language in this section is value-neutral. It is simply describing facts.</p></dd></dl></div></section><section id="slide_dokumentowanie_decyzji_4"><h2>Dokumentowanie decyzji (4)</h2><div class="quoteblock"><div class="title">Context of ADR004: Markdown format</div><blockquote><div class="paragraph"><p>The decision records must be stored in a plain text format:</p></div>
<div class="ulist"><ul><li><p>This works well with version control systems.</p></li><li><p>It allows the tool to modify the status of records and insert hyperlinks when one decision supercedes another.</p></li><li><p>Decisions can be read in the terminal, IDE, version control browser, etc.</p></li></ul></div>
<div class="paragraph"><p>People will want to use some formatting: lists, code examples, and so on and to view the decision records in a more readable format than plain text.</p></div></blockquote></div></section><section id="slide_dokumentowanie_decyzji_5"><h2>Dokumentowanie decyzji (5)</h2><div class="dlist"><dl><dt class="hdlist1">Decision</dt><dd><p>This section describes our response to these forces. It is stated in full sentences, with active voice. "We will &#8230;&#8203;"</p></dd></dl></div>
<div class="quoteblock"><blockquote><div class="paragraph"><p>Record architecture decisions in Markdown format.</p></div></blockquote></div>
<div class="dlist"><dl><dt class="hdlist1">Status</dt><dd><p>A decision may be "proposed" if the project stakeholders haven&#8217;t agreed with it yet, or "accepted" once it is agreed. If a later ADR changes or reverses a decision, it may be marked as "deprecated" or "superseded" with a reference to its replacement.</p></dd></dl></div>
<div class="quoteblock"><blockquote><div class="paragraph"><p>Accepted</p></div></blockquote></div></section><section id="slide_dokumentowanie_decyzji_6"><h2>Dokumentowanie decyzji (6)</h2><div class="dlist"><dl><dt class="hdlist1">Consequences</dt><dd><p>This section describes the resulting context, after applying the decision. All consequences should be listed here, not just the "positive" ones. A particular decision may have positive, negative, and neutral consequences, but all of them affect the team and project in the future</p></dd></dl></div>
<div class="quoteblock"><div class="title">Consequences of ADR004: Markdown format</div><blockquote><div class="paragraph"><p>Decisions can be read in the terminal.</p></div>
<div class="paragraph"><p>Decisions will be formatted nicely and hyperlinked by the browsers of project hosting sites like GitHub and Bitbucket.</p></div>
<div class="paragraph"><p>Tools like Pandoc can be used to convert the decision records into HTML or PDF.</p></div></blockquote></div></section><section id="slide_governance_model"><h2>Governance model</h2><div class="ulist"><ul><li><p>Architektura nigdy nie jest ani dobra ani zła</p><div class="ulist"><ul><li><p>Jest zależna od punktu odniesienia (<em>frame of reference</em>)</p></li></ul></div></li><li><p>W jaki sposób zarządzać jej zmianą i ewolucją?</p><div class="ulist"><ul><li><p>Które elementy ściśle kontrolować?</p></li><li><p>Które elementy centralizować?</p></li><li><p>Gdzie pozwalać na <em>lokalne</em> decyzje projektowe? Lokalne optymalizacja?</p></li></ul></div></li></ul></div></section><section id="slide_jak_żyć"><h2>Jak żyć?</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>All I need from documentation</p></div>
<div class="ulist"><ul><li><p>context</p></li><li><p>goals</p></li><li><p>quality scenarios</p></li><li><p>concepts (principles)</p></li><li><p>structures</p></li></ul></div></blockquote><div class="attribution">&#8212; Dierk Konig</div></div></section><section id="slide_arc42"><h2>ARC42</h2><div class="imageblock" style=""><img src="images/introduction-arc42.jpg" alt="introduction arc42"></div></section><section id="slide_arc42_2"><h2>ARC42 (2)</h2><div class="ulist"><ul><li><p>Introduction and Goals - the introduction to the architecture documentation should list the driving forces that software architects must consider in their decisions.</p><div class="ulist"><ul><li><p>Requirements Overview</p></li><li><p>Quality Goals</p></li><li><p>Stakeholders</p></li></ul></div></li></ul></div></section><section id="slide_arc42_3"><h2>ARC42 (3)</h2><div class="ulist"><ul><li><p>Architecture Constraints</p><div class="ulist"><ul><li><p>Technical Constraints - hardware and software infrastructure, applied technologies (operating systems, middleware, databases, programming languages)</p></li><li><p>Organizational Constraints - organizational, structural, and resource-related constraints. This category also covers standards and legal constraints that you must comply with.</p></li><li><p>Conventions - coding guidelines, documentation guidelines, guidelines for version and configuration management, naming conventions</p></li></ul></div></li></ul></div></section><section id="slide_arc42_4"><h2>ARC42 (4)</h2><div class="ulist"><ul><li><p>System Scope and Context - Business, Technical context, External interfaces</p></li><li><p>Solution Strategy - A short summary and explanation of the fundamental solution ideas and strategies.</p></li><li><p>Building Blocks view - web application, mobile application. Application layering</p></li><li><p>Runtime view (process or workflow view) - describes the behavior and interaction of the system’s building blocks as runtime elements (processes, tasks, activities, threads)</p></li></ul></div></section><section id="slide_arc42_5"><h2>ARC42 (5)</h2><div class="ulist"><ul><li><p>Deployment view - describes the environment within which the system is executed. It describes the geographic distribution of the system or the structure of the hardware components that execute the software. It documents workstations, processors, network topologies and channels, as well as other elements of the physical system environment. The deployment view shows the system from the operator’s point of view</p></li><li><p>Concepts - examples of frequent cross-cutting concerns (a.k.a. aspects in some programming languages), which doesn&#8217;t fit a single building block</p><div class="ulist"><ul><li><p>Domain models, Persistency, UI, Security</p></li></ul></div></li></ul></div></section><section id="slide_arc42_6"><h2>ARC42 (6)</h2><div class="ulist"><ul><li><p>Design decisions - all important design decisions and their reasons, in a form of problem, constaint, assumptions, considered alternatives, decision</p></li><li><p>Quality scenarios - summarizes all you (or other stakeholders) might need to systematically evaluate the architecture against the quality requirements</p></li><li><p>Technical risks - list of identified technical risks, ordered by priority</p></li></ul></div></section><section id="slide_c4_diagrams"><h2>C4 diagrams </h2><div class="ulist"><div class="title">Rationale</div><ul><li><p>create a number of diagrams</p></li><li><p>at varying levels of abstraction.</p></li><li><p>simpler diagrams can describe software in a more effective way than a single complex diagram that tries to describe everything</p></li></ul></div>
<div class="quoteblock"><blockquote>If you try to model all the fine details up front, you will get bogged down. Learn the big picture while using placeholders for the details.</blockquote><div class="attribution">&#8212; Vernon Vaughn</div></div></section><section id="slide_c4_diagrams_2"><h2>C4 diagrams (2)</h2><div class="imageblock" style=""><img src="images/introduction-c4.png" alt="introduction c4"></div></section><section id="slide_c4_context"><h2>C4 - Context</h2><div class="ulist"><div class="title">A context diagram helps you to answer the following questions.</div><ul><li><p>What is the software system that we are building (or have built)?</p></li><li><p>Who is using it?</p></li><li><p>How does it fit in with the existing IT environment?</p></li></ul></div></section><section id="slide_c4_containers"><h2>C4 - Containers</h2><div class="ulist"><div class="title">A container diagram helps you answer the following questions.</div><ul><li><p>What is the overall shape of the software system?</p></li><li><p>What are the high-level technology decisions?</p></li><li><p>How are responsibilities distributed across the system?</p></li><li><p>How do containers communicate with one another?</p></li><li><p>As a developer, where do I need to write code in order to implement features?</p></li></ul></div></section><section id="slide_c4_components"><h2>C4 - Components</h2><div class="ulist"><div class="title">A component diagram helps you answer the following questions.</div><ul><li><p>What components/services is the system made up of?</p></li><li><p>It is clear how the system works at a high-level?</p></li><li><p>Do all components/services have a home (i.e. reside in a container)?</p></li></ul></div></section></section>
<section><section id="slide_co_charakteryzuje_mikroserwisy_5" class="white background"><h2>Co charakteryzuje mikroserwisy?</h2><div class="ulist"><ul><li><p><em>Smart endpoints and dumb pipes</em></p></li><li><p>Decentralizacja danych</p></li><li><p>Decentralizacja zarządzania</p></li><li><p><strong>Automatyzacja infrastruktury</strong></p></li></ul></div></section><section id="slide_build_pipeline"><h2>Build pipeline</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/basic-pipeline.png" alt="basic pipeline"></div>
<div class="ulist"><ul><li><p>W jaki sposób zapewnić aby każdy z powyższych testów był przeprowadzany na środowisku odzwierciedlającym produkcję?</p></li><li><p>Jak to wykonać w "klasycznym środowisku"</p><div class="ulist"><ul><li><p>People per server ratio; avarage IT: 1 per 200 - 500 machines</p></li><li><p>Facebook: 1 per <strong>25000</strong> - <a href="https://hbr.org/2015/06/an-inside-look-at-facebooks-approach-to-automation-and-human-work">Source</a></p></li></ul></div></li></ul></div></section><section id="slide_devops_approach"><h2>DevOps approach</h2><div class="ulist"><div class="title">Problemy</div><ul><li><p><strong>time gap</strong> - wdrażaj rzadko (co pół roku)</p><div class="ulist"><ul><li><p>Jako że lepiej trudne rzeczy robić rzadko</p></li></ul></div></li><li><p><strong>personnel gap</strong> - różni ludzie robią różne rzeczy</p></li><li><p><strong>tools gap</strong> - diametralnie inne stosy technologiczne pomiędzy dev i ops (Nginx, SQLite, and OS X / Apache, MySQL, and Linux)</p></li></ul></div>
<div class="ulist"><div class="title">Zasady</div><ul><li><p><strong>Jenkins</strong> do wszystkiego</p></li><li><p>Nigdy nie patrz wstecz - wdrożenia tylko w przód</p></li><li><p>Nie tykamy serwerów - <em>no ssh</em></p></li></ul></div></section></section>
<section><section id="slide_microservices_patterns" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Microservices patterns</h2></section><section id="slide_microservices_patterns_2"><h2>Microservices patterns</h2><div class="ulist"><ul><li><p>Externalize User Interface</p></li><li><p>Consumer driven contracts + microservices testing</p></li><li><p>Front-end architectures (API Gateway, BFF - Backends for Frontends)</p></li><li><p>Circuit breaker</p></li><li><p>Load balancing and Service orchestration</p></li><li><p>Choreography vs orchestration</p></li><li><p>Distributed logging and monitoring</p></li><li><p>Application security</p></li></ul></div></section></section>
<section><section id="slide_pattern_1_externalized_ui"><h2>Pattern #1: Externalized UI</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Leaving user interface for web developers</p></div></div></div></section><section id="slide_intent"><h2>Intent</h2><div class="paragraph"><p>In order to have a meaningful and valuable user experience, information must be</p></div>
<div class="olist arabic"><ol class="arabic"><li><p><strong>Useful</strong>: Your content should be original and fulfill a need</p></li><li><p><strong>Usable</strong>: Site must be easy to use</p></li><li><p><strong>Desirable</strong>: Image, identity, brand, and other design elements are used to evoke emotion and appreciation</p></li><li><p><strong>Findable</strong>: Content needs to be navigable and locatable on-site and off-site</p></li><li><p><strong>Accessible</strong>: Content needs to be accessible to people with disabilities(+ Inclusive)</p></li><li><p><strong>Credible</strong>: Users must trust and believe what you tell them</p></li></ol></div></section><section id="slide_problem"><h2>Problem</h2><div class="dlist"><dl><dt class="hdlist1">Refreshing frontend</dt><dd><div class="ulist"><ul><li><p>Stack changes (migrating from JSP, JSF, Struts 1.x, GWT - you call it)</p></li><li><p>Hard to find th right people.</p><div class="ulist"><ul><li><p>Full-stack that goes beyond backend and frontend in JavaScript</p></li></ul></div></li><li><p>Stack incompatibility</p><div class="ulist"><ul><li><p>Need to know Java to do JavaScript (GWT)</p></li><li><p>Need to know Maven to build the application</p></li><li><p><em>Save - redeploy - refresh</em> vs. <em>Save - refresh</em></p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_discussion"><h2>Discussion</h2><div class="ulist"><ul><li><p>Duality of the technology stack</p><div class="ulist"><ul><li><p>NodeJS + npm + bower + webpack &#8230;&#8203;</p></li><li><p>Java + Maven / Gradle / &#8230;&#8203;</p></li></ul></div></li><li><p>Nobody wants JSF&#8230;&#8203;</p></li></ul></div></section><section><div class="dlist"><dl><dt class="hdlist1">Needs and tools mismatch</dt><dd><div class="ulist"><ul><li><p>some features and impossible <em>(or unbelievably expensive)</em></p><div class="ulist"><ul><li><p>30 days for simple button change</p></li><li><p>working against the framework, not together with it</p></li></ul></div></li><li><p>look-and-feel expectations</p><div class="ulist"><ul><li><p>free canvas vs. component based approach</p></li><li><p>Material Design vs Adobe Flex UI Components</p></li></ul></div></li></ul></div></dd></dl></div></section><section><div class="dlist"><dl><dt class="hdlist1">Organizational shift</dt><dd><div class="ulist"><ul><li><p>unable to find the right people for the job</p><div class="ulist"><ul><li><p>different aesthetics between backend engineers and frontend engineers</p></li><li><p>the myth of full stack developer</p></li></ul></div></li><li><p>new roles (User Experience Designer)</p><div class="ulist"><ul><li><p>old communication problems (us vs. them)</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_structure_build_process"><h2>Structure - Build process</h2><div class="ulist"><ul><li><p>Maven</p><div class="ulist"><ul><li><p>Orchestrate external build process through Maven</p></li><li><p>Collect results into a single distribution</p></li><li><p>JAR, Zip - you call it</p></li></ul></div></li><li><p>From server perspective the whole JavaScript is 'rather static'</p></li></ul></div></section><section id="slide_structure_deployment"><h2>Structure - Deployment</h2><div class="ulist"><ul><li><p>What was created in the previous step is actually a <em>WebJar</em></p><div class="ulist"><ul><li><p>A client-side web library packaged into JAR (Java Archive) file</p></li></ul></div></li><li><p><em>Servlet 3.0</em> specification prescribes way to server static assets from Jar files</p><div class="ulist"><ul><li><p>the WebJars that are in the <code>WEB-INF/lib</code> directory are automatically made available as static resources</p></li><li><p>this works because anything in a <code>META-INF/resources</code> directory in a JAR in <code>WEB-INF/lib</code> is automatically exposed as a static resource.</p></li></ul></div></li><li><p>The WebJar needs to be a dependency of the application</p></li></ul></div></section><section id="slide_structure_splitting_the_application"><h2>Structure - Splitting the application</h2><div class="olist arabic"><ol class="arabic"><li><p>Split EARs into multiple WARs</p></li><li><p>One application per server</p></li><li><p>Build, deploy and manage independently</p></li></ol></div>
<div class="imageblock" style=""><img src="https://wdc.objectstorage.softlayer.net/v1/AUTH_7046a6f4-79b7-4c6c-bdb7-6f68e920f6e5/Code-Articles/cl-refactor-microservices-bluemix-trs-1/images/fig1.png" alt="fig1"></div></section><section id="slide_exercise" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #0: Frontend backend split</p></div></div></div></section></section>
<section><section id="slide_pattern_2_consumer_driven_contracts"><h2>Pattern #2: Consumer driven contracts</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Early verification of expectations of a consumer (or producer) on a service</p></div></div></div></section><section id="slide_intent_2"><h2>Intent</h2><div class="paragraph"><p>Consumer Driven Contracts drives the development of the Provider from its Consumers point of view, which means consumer describes what and how it wants to receive the information (in a form of a contract) and then provider implements the service following the given contract.
It allows testing interactions between service providers and consumers in isolation against a contract.</p></div>
<div class="paragraph"><p>&#8203;</p></div>
<div class="dlist"><dl><dt class="hdlist1">As producers</dt><dd><p>We	are	trying	to	ensure	that	when	we	deploy	a	new	service	to
production,	our	changes	won’t	break	consumers.</p></dd><dt class="hdlist1">As consumers</dt><dd><p>We want to know early (design-time, not runtime) that producer is changing.</p></dd></dl></div></section><section id="slide_problem_2"><h2>Problem</h2><div class="ulist"><ul><li><p>In-process calls (methods, services, <code>@Local</code> EJBs) are replaced with out-of-process calls (HTTP, AMPQ)</p></li><li><p>In microservices environments, different services are no longer wired together under the same runtime. Changes in the exposed interfaces for these services can no longer be caught by the compiler.</p><div class="ulist"><ul><li><p>Without the necessary precautions, there are a lot of ways these interactions can be broken by changes made in the different services</p></li></ul></div></li></ul></div>
<div class="quoteblock"><blockquote>(&#8230;&#8203;) gives you the certainty that the stubs that you’re using were created by the service that you’re calling. Also if you can use them it means that they were tested against the producer’s side. In other words - you can trust those stubs.</blockquote></div></section><section id="slide_discussion_2"><h2>Discussion</h2><div class="imageblock" style=""><img src="images/patterns/consumer-driven-contracts-a4a80.png" alt="consumer driven contracts a4a80" width="50%"></div>
<div class="dlist"><dl><dt class="hdlist1">Things that can go with integration like this</dt><dd><div class="ulist"><ul><li><p>Change of the endpoint URL (e.g. GET <code>/stockLevels</code> renamed to GET <code>/stockLevel</code>)</p></li><li><p>Change in the expected parameters (e.g. GET <code>/stockLevels</code> expecting a new mandatory <code>category</code> field)</p></li><li><p>Change in the response payload (returns an <code>array</code>, instead of having an <code>array</code> wrapped in an <code>object</code>)</p></li></ul></div></dd></dl></div></section><section id="slide_structure"><h2>Structure</h2><div class="olist arabic"><ol class="arabic"><li><p>The consumer defines what it expects from a specific request to a service</p><div class="ulist"><ul><li><p>In a way accepted both for consumer and producer</p></li></ul></div></li><li><p>The provider and the consumer agree on this contract</p><div class="ulist"><ul><li><p>Provider needs to know about the tests, validate them</p></li><li><p>Consumers and provider might have to agree on some form of common state (if the provider is not stateless or depends on other services)</p></li></ul></div></li><li><p>The provider continuously verifies that the contract is fulfilled</p></li></ol></div></section><section><div class="imageblock" style=""><img src="images/patterns/consumer-driven-contracts-ba2f9.png" alt="consumer driven contracts ba2f9"></div></section><section><div class="imageblock" style=""><img src="images/patterns/consumer-driven-contracts-e4bed.png" alt="consumer driven contracts e4bed"></div></section><section><div class="imageblock" style=""><img src="images/patterns/consumer-driven-contracts-ca9ec.png" alt="consumer driven contracts ca9ec"></div></section><section id="slide_dont_share_libraries_share_contracts"><h2>Don&#8217;t share libraries - share contracts</h2><div class="imageblock" style=""><img src="https://image.slidesharecdn.com/geecon2016-scalingmicroservicesatgilt-160519132206/95/geecon-2016-scaling-microservices-at-gilt-54-638.jpg?cb=1463664274" alt="geecon 2016 scaling microservices at gilt 54 638"></div></section><section id="slide_generate_client_based_on_a_api_docs"><h2>Generate client based on a API docs</h2><div class="imageblock" style=""><img src="https://image.slidesharecdn.com/geecon2016-scalingmicroservicesatgilt-160519132206/95/geecon-2016-scaling-microservices-at-gilt-55-638.jpg?cb=1463664274" alt="geecon 2016 scaling microservices at gilt 55 638"></div></section><section id="slide_example"><h2>Example</h2><div class="dlist"><dl><dt class="hdlist1">Known implementations</dt><dd><div class="ulist"><ul><li><p><a href="https://docs.pact.io/" class="bare">https://docs.pact.io/</a></p></li><li><p><a href="http://thoughtworks.github.io/pacto/" class="bare">http://thoughtworks.github.io/pacto/</a></p></li><li><p><a href="https://github.com/spring-cloud/spring-cloud-contract" class="bare">https://github.com/spring-cloud/spring-cloud-contract</a></p></li><li><p><a href="http://arquillian.org/arquillian-pact/" class="bare">http://arquillian.org/arquillian-pact/</a></p></li></ul></div></dd></dl></div></section><section id="slide_exercise_2" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #1: Splitting up monoliths</p></div></div></div></section></section>
<section><section id="slide_pattern_3_api_gateway"><h2>Pattern #3: API Gateway</h2></section><section id="slide_intent_3"><h2>Intent</h2><div class="paragraph"><p>Direct Client‑to‑Microservice communication rarely makes sense, due to:</p></div>
<div class="ulist"><ul><li><p>mismatch between the needs of the client and the fine‑grained APIs exposed by each of the microservices,</p></li><li><p>some communication protocols might not be <em>web-friendly</em> (binary RPC protocols used by some AMQP messaging protocols) - neither browser not firewall friendly,</p></li><li><p>tight coupling might appear and it can make refactoring microservices difficult.</p></li></ul></div></section><section id="slide_problem_3"><h2>Problem</h2><div class="imageblock" style=""><img src="images/patterns/api-gateway_microservices_client.png" alt="api gateway microservices client"></div></section><section id="slide_discussion_3"><h2>Discussion</h2><div class="dlist"><dl><dt class="hdlist1">API Gateway</dt><dd><div class="ulist"><ul><li><p>a server that is the single entry point into the system</p><div class="ulist"><ul><li><p>similar to the Facade pattern from object‑oriented design</p></li></ul></div></li><li><p>encapsulates the internal system architecture and provides an API that is tailored to each client</p></li><li><p>might have other responsibilities such as authentication, monitoring, load balancing, caching, request shaping and management, and static response handling</p></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="images/patterns/api-gateway_microservices_client_2.png" alt="api gateway microservices client 2"></div></section><section><div class="dlist"><dl><dt class="hdlist1">Benefits</dt><dd><div class="ulist"><ul><li><p>encapsulates the internal structure of the application</p><div class="ulist"><ul><li><p>provides each kind of client with a specific API</p></li><li><p>reduces the number of round trips between the client and application</p></li><li><p>simplifies the client code</p></li></ul></div></li></ul></div></dd><dt class="hdlist1">Drawbacks</dt><dd><div class="ulist"><ul><li><p>additional system (landscape) component (to be developed, deployed and managed)</p></li><li><p>potential bottleneck</p><div class="ulist"><ul><li><p>API Gateway must be updated in order to expose each microservices endpoint</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_implementation"><h2>Implementation</h2><div class="dlist"><dl><dt class="hdlist1">Various design issues for consideration</dt><dd><div class="ulist"><ul><li><p>performance and scalability</p></li><li><p>service invocation</p></li><li><p>service discovery</p></li><li><p>reactive programming model</p></li><li><p>handling partial failures</p></li></ul></div></dd></dl></div></section><section><div class="dlist"><dl><dt class="hdlist1">Performance and scalability</dt><dd><div class="ulist"><ul><li><p>asynchronous and nonblocking I/O</p></li></ul></div></dd></dl></div>
<div class="imageblock" style=""><img src="images/patterns/api-gateway_timeouts.png" alt="api gateway timeouts"></div></section><section><div class="dlist"><dl><dt class="hdlist1">Service invocation</dt><dd><div class="ulist"><ul><li><p>Different services might embrace different inter-process communication styles</p><div class="ulist"><ul><li><p>Message brokers (JMS / AMQP)</p></li><li><p>Brockerless (Zeromq)</p></li><li><p>Synchronous HTTP</p></li></ul></div></li></ul></div></dd><dt class="hdlist1">Service discovery</dt><dd><div class="ulist"><ul><li><p>API Gateway needs information about location (IP address) of each microservice it communicates with</p><div class="ulist"><ul><li><p>This information cannot be hardwire, due to dynamic nature of the microservice environment</p></li><li><p>While infrastructure elements (message brokers) might have static location, application services might change from deployment to deployment</p></li></ul></div></li></ul></div></dd></dl></div></section><section><div class="dlist"><dl><dt class="hdlist1">Reactive programming model</dt><dd><div class="ulist"><ul><li><p>Important when goes beyond simple routing requests to an appropriate backend service</p></li><li><p>Dependency between requests</p><div class="ulist"><ul><li><p>validate the request by calling an authentication service</p></li><li><p>routing the request to a backend service afterwards</p></li></ul></div></li><li><p>Managing multiple, dependent asynchronous calls</p></li></ul></div></dd><dt class="hdlist1">Handling partial failures</dt><dd><div class="ulist"><ul><li><p>some downstream services might respond slowly or be unavailable</p><div class="ulist"><ul><li><p>API Gateway should never block indefinitely waiting for a response</p></li><li><p>failure handling might depend on the specific scenario and which service is failing (default value, static / cached data, or returning error to a client)</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_examples"><h2>Examples</h2><div class="ulist"><ul><li><p>Neflix Zuul</p></li><li><p>Amazon API Gateway</p></li><li><p>Homegrown implementation</p></li></ul></div></section><section><div class="imageblock" style=""><img src="images/patterns/api-gateway_zuul.png" alt="api gateway zuul"></div></section><section id="slide_exercise_3" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #2: API Gateway</p></div></div></div></section></section>
<section><section id="slide_pattern_4_circuit_breaker"><h2>Pattern #4: Circuit breaker</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Circumvent subsequent requests when the system is not healthy</p></div></div></div></section><section id="slide_intent_4"><h2>Intent</h2><div class="quoteblock"><blockquote>Detect excess usage, fail first, and open the circuit. More abstractly, the circuit breaker exists to allow one subsystem (an electrical circuit) to fail (excessive current draw, possibly from a short-circuit) without destroying the entire system (the house).</blockquote><div class="attribution"><cite>Release It</cite><br>&#8212; Michael Nygard</div></div></section><section id="slide_problem_4"><h2>Problem</h2><div class="paragraph"><p>To contain and manage failure without having it cascade throughout the services participating in the workflow:</p></div>
<div class="ulist"><ul><li><p>never be sure how the other system will behave when the communication diverge from the “happy path”</p><div class="ulist"><ul><li><p>never trust that the other service will behave according to the established protocol</p></li></ul></div></li><li><p>minimize the risk of having one system overloading another during unexpected load
increase</p></li><li><p>avoiding cascading failures requires services that are fully decoupled and isolated</p></li></ul></div></section><section id="slide_discussion_4"><h2>Discussion</h2><div class="paragraph"><p>""
Bulkheading has been used in the ship construction for centuries as a way to “create watertight compartments that can contain water in the case of a hull breach or other leak.” The ship is divided into distinct and completely isolated watertight compartments, so that if compartments are filled up with water, the leak does not spread and the ship can continue to function and reach its destination.
""</p></div>
<div class="imageblock" style=""><img src="images/patterns/circuit-breakers-bbbb3.png" alt="circuit breakers bbbb3" width="40%"></div></section><section><div class="quoteblock"><blockquote>""
Resilience - the ability to heal from failure - depends on compartmentalization and containment of failure, and can only be achieved by breaking free from the strong coupling of synchronous communication.
""</blockquote><div class="attribution"><cite>Reactive Microservices Architecture</cite><br>&#8212; Jonas Boner</div></div></section><section><div class="dlist"><dl><dt class="hdlist1">Timeouts</dt><dd><div class="ulist"><ul><li><p>Easiest way to accomodate a failure of upstream service</p><div class="ulist"><ul><li><p>How long can I wait?</p></li></ul></div></li><li><p>Important on all out-of-process calls + default timeout for everything</p></li><li><p>Log timeouts, analyze and change them accordingly</p></li></ul></div></dd><dt class="hdlist1">Circuit breakers</dt><dd><div class="ulist"><ul><li><p>Capture failures</p></li><li><p>Retry tasks and</p></li><li><p>If the failure persists, quarantine the service for a specific period of time while waiting for the service to recover</p></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="images/patterns/circuit-breakers-29665.png" alt="circuit breakers 29665"></div></section><section><div class="imageblock" style=""><img src="images/patterns/circuit-breakers-41ce8.png" alt="circuit breakers 41ce8"></div></section><section id="slide_structure_2"><h2>Structure</h2><pre class="CodeRay listingblock"><code>setup_timer()
try(client.call()) {
  if (unsuccessful) {
    adjust_counters()
  }
}</code></pre></section><section id="slide_example_2"><h2>Example</h2><div class="dlist"><dl><dt class="hdlist1">Tools</dt><dd><div class="ulist"><ul><li><p><a href="https://github.com/jhalterman/failsafe" class="bare">https://github.com/jhalterman/failsafe</a></p></li><li><p><a href="https://github.com/Netflix/Hystrix" class="bare">https://github.com/Netflix/Hystrix</a></p></li><li><p><a href="https://github.com/javaslang/javaslang-circuitbreaker" class="bare">https://github.com/javaslang/javaslang-circuitbreaker</a></p></li><li><p><a href="https://github.com/Comcast/jrugged" class="bare">https://github.com/Comcast/jrugged</a></p></li></ul></div></dd><dt class="hdlist1">Flavours</dt><dd><div class="ulist"><ul><li><p>AOP approach (Hystrix)</p></li><li><p>Callable approach (Failsafe)</p></li></ul></div></dd></dl></div></section><section id="slide_example_2_2"><h2>Example (2)</h2><div class="ulist"><ul><li><p>Executable logic can be passed through Failsafe as simple lambda expressions or method references. In Hystrix, your executable logic needs to be placed in a HystrixCommand implementation.</p></li><li><p>Asynchronous executions in failsafe are performed on a user supplied ThreadPool / Scheduler. In Hystrix, asynchronous commands are executed on internally managed thread pools for particular dependencies.</p></li><li><p>Failsafe supports retries in addition to circuit breakers</p></li></ul></div></section><section id="slide_implementation_2"><h2>Implementation</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> <span class="predefined-type">Object</span> run() <span class="directive">throws</span> <span class="exception">Exception</span> {

    <span class="type">long</span> start = <span class="predefined-type">System</span>.currentTimeMillis();
    <span class="keyword">try</span> {
        <span class="comment">//set timers to reset circuit</span>
        <span class="keyword">if</span> (errorCounter &gt;= maxNbrOfFailures) <span class="keyword">return</span> defaultValue;
        <span class="keyword">return</span> ic.proceed();
    } <span class="keyword">catch</span> (<span class="exception">Exception</span> ex) {
        errorCounter++;
        <span class="keyword">throw</span> ex;
    } <span class="keyword">finally</span> {
        <span class="type">long</span> duration = <span class="predefined-type">System</span>.currentTimeMillis() - start;
        <span class="keyword">if</span> (duration &gt;= timeout)
            errorCounter++;
    }
}</code></pre></section><section id="slide_rules_of_thumb_timeouts"><h2>Rules of thumb - timeouts</h2><div class="dlist"><dl><dt class="hdlist1">Apply to Integration Points, Blocked Threads, and Slow Responses</dt><dd><p>The Timeouts pattern prevents calls to Integration Points from becoming Blocked Threads. Thus, they avert Cascading Failures.</p></dd><dt class="hdlist1">Apply to recover from unexpected failures</dt><dd><p>When an operation is taking too long, sometimes we don’t care why&#8230;&#8203;we just need to give up and keep moving. The Timeouts pattern lets us do that.</p></dd><dt class="hdlist1">Consider delayed retries</dt><dd><p>Most of the explanations for a timeout involve problems in the network or the remote system that won’t be resolved right away.
Immediate retries are liable to hit the same problem and result in another timeout.
That just makes the user wait even longer for his error message.
Most of the time, you should queue the operation and retry it later.</p></dd></dl></div></section><section id="slide_rules_of_thumb_circuit_breaking"><h2>Rules of thumb - circuit breaking</h2><div class="dlist"><dl><dt class="hdlist1">Don’t do it if it hurts</dt><dd><p>Circuit Breaker is the fundamental pattern for protecting your system from all manner of Integration Points problems.
When there’s a difficulty with Integration Points, stop calling it!</p></dd><dt class="hdlist1">Use together with Timeouts</dt><dd><p>Circuit Breaker is good at avoiding calls when Integration Points has a problem.
The Timeouts pattern indicates that there is a problem in Integration Points.</p></dd><dt class="hdlist1">Expose, track, and report state changes</dt><dd><p>Popping a Circuit Breaker <em>always</em> indicates there is a serious problem. It should be visible to operations. It should be reported, recorded, trended, and correlated.</p></dd></dl></div></section><section id="slide_exercise_4" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #3: Circuit breaker</p></div></div></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #4: Netflix Zuul</p></div></div></div></section></section>
<section><section id="slide_pattern_5_load_balancing_and_discovery"><h2>Pattern #5: Load balancing and discovery</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>To improve the distribution of workloads across multiple computing resources,
a service needs a list of available instances.</p></div></div></div><div class="sidebarblock"><div class="content"><div class="paragraph"><p>In order to communicate with another instance, a service needs to
know the other service’s address.</p></div></div></div></section><section id="slide_intent_5"><h2>Intent</h2><div class="dlist"><dl><dt class="hdlist1">All solutions under <em>Load balancing and Service Discovery</em> umbrella provide</dt><dd><div class="ulist"><ul><li><p>mechanism	for	an	instance	to	register	itself</p></li><li><p>they	provide	a way	to	find	other	service	once	it’s	registered</p></li><li><p>provide a way to balance workload between instances</p></li></ul></div></dd></dl></div>
<div class="paragraph"><p>Service	discovery	gets	more	complicated, though,	when	we	are	start considering	an	environment	where	we	are	constantly	destroying	and deploying	new	instances	of	services.</p></div></section><section id="slide_problem_5"><h2>Problem</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Figure out where is the service I&#8217;d like to call<br>
And how to call it</p></div></div></div></section><section><div class="imageblock" style=""><img src="images/patterns/configuration-and-discovery-53962.png" alt="configuration and discovery 53962" width="55%"></div></section><section id="slide_discussion_5"><h2>Discussion</h2><div class="dlist"><dl><dt class="hdlist1">Simplest solutions (sufficient for load balancing)</dt><dd><div class="ulist"><ul><li><p>hardcode the physical address and port of all the services that a service needs to use</p></li><li><p>have addresses and ports externalized into a configuration file provided at startup time</p></li></ul></div></dd></dl></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>Both cases forces static deployment (no changes in the infrastructure) which contradicts microservices agility (a distributed monolith?)</p></div></div></div></section><section><div class="dlist"><dl><dt class="hdlist1">Realistic solution (fully dynamic environment)</dt><dd><div class="ulist"><ul><li><p>location of services is provided indirectly (decoupled between the services through shared abstractions)</p></li></ul></div></dd></dl></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>In microservicers environments services stay decoupled and mobile</p></div></div></div></section><section id="slide_structure_3"><h2>Structure</h2><div class="dlist"><dl><dt class="hdlist1">Client-Side Load Balancing (Service Discovery)</dt><dd><div class="ulist"><ul><li><p>each service register itself in a central registry</p></li><li><p>all services look up the information</p></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="images/patterns/configuration-and-discovery-70d46.png" alt="configuration and discovery 70d46" width="60%"></div></section><section><div class="dlist"><dl><dt class="hdlist1">Server-Side Load Balancing (Service Discovery)</dt><dd><div class="ulist"><ul><li><p>store the information on the load-balancer (AWS Elastic Load Balancing works that way)</p></li><li><p>clients always call same address which encapsulate the dynamic changes of implementations</p></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="images/patterns/configuration-and-discovery-b6478.png" alt="configuration and discovery b6478"></div></section><section id="slide_fallacies_of_distributed_computing"><h2>Fallacies of distributed computing</h2><div class="quoteblock"><blockquote>""
are a set of assertions made by L Peter Deutsch and others at Sun Microsystems describing false assumptions that programmers new to distributed applications invariably make
""</blockquote><div class="attribution">&#8212; Wikipedia</div></div></section><section id="slide_8_fallacies"><div class="olist arabic"><div class="title">8 Fallacies of Distributed Computing</div><ol class="arabic"><li><p>The Network is Reliable</p></li><li><p>Latency is Zero</p></li><li><p>Bandwidth is Infinite</p></li><li><p>The Network is Secure</p></li><li><p>Topology Doesn’t Change</p></li><li><p>There is One Administrator</p></li><li><p>Transport Cost is Zero</p></li><li><p>The Network is Homogeneous</p></li></ol></div></section><section id="slide_cap_theorem_4"><h2>CAP theorem</h2><div class="quoteblock"><blockquote>The CAP Theorem states that, in a distributed system, you can only have two out of the following three guarantees across a write/read pair: Consistency, Availability, and Partition Tolerance - one of them must be sacrificed.</blockquote></div></section><section id="slide_cap_theorem_5"><h2>CAP theorem</h2><div class="ulist"><ul><li><p><strong>Consistency</strong> - A read is guaranteed to return the most recent write for a given client</p></li><li><p><strong>Availability</strong> - A non-failing node will return a reasonable response within a reasonable amount of time (no error or timeout)</p></li><li><p><strong>Partition Tolerance</strong> - The system will continue to function when network partitions occur</p></li></ul></div></section><section id="slide_cap_theorem_6"><h2>CAP theorem</h2><div class="ulist"><ul><li><p>Given that networks aren&#8217;t completely reliable, you must tolerate partitions in a distributed system, period</p></li><li><p>CP - Consistency / Partition Tolerance</p></li><li><p>AP - Availability / Partition Tolerance</p></li></ul></div></section><section id="slide_consistency_partition_tolerance_2"><h2>Consistency / Partition Tolerance</h2><div class="paragraph"><p>Wait for a response from the partitioned node which could result in a timeout error. The system can also choose to return an error, depending on the scenario you desire. Choose Consistency over Availability when your business requirements dictate atomic reads and writes.</p></div>
<div class="imageblock" style=""><img src="http://robertgreiner.com/content/images/2019/09/CAP-CP.png" alt="CAP CP"></div></section><section id="slide_availability_partition_tolerance_2"><h2>Availability / Partition Tolerance</h2><div class="paragraph"><p>Return the most recent version of the data you have, which could be stale. This system state will also accept writes that can be processed later when the partition is resolved. Choose Availability over Consistency when your business requirements allow for some flexibility around when the data in the system synchronizes. Availability is also a compelling option when the system needs to continue to function in spite of external errors (shopping carts, etc.)</p></div>
<div class="imageblock" style=""><img src="http://robertgreiner.com/content/images/2019/09/CAP-AP.png" alt="CAP AP"></div></section><section><div class="ulist"><div class="title">Consistency vs. Availability</div><ul><li><p>All information are stored in a consistent fashion (placed in a single atomic store) - <strong>consistency</strong></p></li><li><p>Information are distributed in a peer-to-peer manner (eventual consistency) - <strong>availability</strong></p></li></ul></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>(&#8230;&#8203;) it is impossible for a distributed computer system to simultaneously provide all three of the following guarantees: Consistency, Availability and Partition tolerance.</p></div></div></div></section><section id="slide_potential_problems_as_of_eureka"><h2>Potential problems (as of Eureka) </h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>How long does it take to propagate a newly registered service</p></div></div></div></section><section id="slide_potential_problems_as_of_eureka_2"><h2>Potential problems (as of Eureka) (2)</h2><div class="olist arabic"><ol class="arabic"><li><p>Client Registration<br>
Happens at the first heartbeat sent to the server. Since the client just started, the server doesn&#8217;t know anything about it and replies with a 404 forcing the client to register. The client then immediately issues a second call with all the registration information. The client is now registered.<br>
<strong>The first heartbeat happens 30 seconds after startup</strong></p></li><li><p>Server ResponseCache<br>
The server maintains a response cache that is updated every <strong>30s by default</strong>. So even if your instance is just registered, it won&#8217;t appear in the result of a call to the <code>/eureka/apps</code> REST endpoint.<br>
<strong>Can take up to a minute for service to be visible</strong></p></li></ol></div></section><section id="slide_potential_problems_as_of_eureka_3"><h2>Potential problems (as of Eureka) (3)</h2><div class="olist arabic"><ol class="arabic" start="3"><li><p>Client cache refresh<br>
Eureka client maintain a cache of the registry information. This cache is refreshed every <strong>30 seconds by default</strong>. It may take another 30s before a client decides to refresh its local cache and discover newly registered instances.<br>
<strong>Total timing: 90seconds</strong></p></li><li><p>LoadBalancer refresh<br>
The load balancer used by Ribbon gets its information from the local Eureka client. It also maintains a local cache to avoid calling the discovery client for every request. <strong>This cache is refreshed every 30s.</strong></p></li></ol></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>It may take <strong>up to 2 minutes</strong> for newly registered instance to start receiving traffic.</p></div></div></div></section><section id="slide_example_3"><h2>Example</h2><div class="dlist"><dl><dt class="hdlist1">Known implementations</dt><dd><div class="ulist"><ul><li><p>Zookeeper</p></li><li><p>Consul</p></li><li><p>Eureka</p></li></ul></div></dd></dl></div></section><section id="slide_exercise_5" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #5 &amp; #6: Load balancing</p></div></div></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #6 &amp; #8: Service discovery</p></div></div></div></section></section>
<section><section id="slide_pattern_6_service_orchestration"><h2>Pattern #6: Service orchestration</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>As we start to model more and more complex logic, we have to deal with the problem of managing business processes that stretch across the boundary of individual services</p></div></div></div></section><section id="slide_problem_6"><h2>Problem</h2><div class="dlist"><dl><dt class="hdlist1">Orchestration</dt><dd><div class="ulist"><ul><li><p>Single point of failure</p></li><li><p>Bottleneck</p></li></ul></div></dd><dt class="hdlist1">Choreography</dt><dd><div class="ulist"><ul><li><p>Eventual consistency</p></li><li><p>Nondeterministic behaviour</p></li></ul></div></dd></dl></div></section><section id="slide_discussion_6"><h2>Discussion</h2><div class="imageblock" style=""><img src="images/patterns/patterns-orchestration-cc803.png" alt="patterns orchestration cc803" width="55%"></div><div class="title">Application flow</div></section><section id="slide_ochestration"><h2>Ochestration</h2><div class="ulist"><ul><li><p>Relies on <em>central brain</em> which guides and drives the process</p><div class="ulist"><ul><li><p>Flowchart can be taken directly to code</p></li></ul></div></li><li><p>Potential bottle neck or single point of failure</p><div class="ulist"><ul><li><p>Easy to reflect application flow / logic in code</p></li><li><p>Easiest to implement and maintain (monitor)</p></li><li><p>Hardest to scale</p></li></ul></div></li><li><p>Possible to leverage dedicated instrumentation and visualisation tools</p><div class="ulist"><ul><li><p>Rules engines / business process management</p></li></ul></div></li><li><p>Implied synchronous requets / response on every step of the process</p></li></ul></div></section><section id="slide_orchestration"><div class="imageblock" style=""><img src="images/patterns/patterns-orchestration-fe459.png" alt="patterns orchestration fe459"></div></section><section id="slide_choreography"><h2>Choreography</h2><div class="ulist"><ul><li><p>Each step is notified about expectations and let it figure out the details</p><div class="ulist"><ul><li><p>Event based communication</p></li><li><p>Services emit asynchronous events</p></li></ul></div></li><li><p>Potential non-deterministic behaviour</p><div class="ulist"><ul><li><p>Eventually consistent application state</p></li></ul></div></li><li><p>Decoupling solution</p><div class="ulist"><ul><li><p>Naturally scalable</p></li><li><p>If more subscribers are interested in particular event no additional work is required in the <em>Customer service</em></p></li></ul></div></li><li><p>Additional effort on monitoring and tracking the right behaviour</p></li></ul></div></section><section id="slide_choreography_2"><div class="imageblock" style=""><img src="images/patterns/patterns-orchestration-76d6b.png" alt="patterns orchestration 76d6b"></div></section><section id="slide_implementation_3"><h2>Implementation</h2><div class="ulist"><ul><li><p>Asynchronous, nonblocking I/O</p><div class="ulist"><ul><li><p>Dedicated thread pool (dedicated <code>ExecutorService</code>)</p></li></ul></div></li><li><p>CompletableFuture</p></li><li><p>RxJava</p></li><li><p>JDeferred (<em>Deferred/Promise library similar</em>)</p></li></ul></div></section><section><div class="imageblock" style=""><img src="images/patterns/flavours-json-over-http.png" alt="flavours json over http" style="background: white"></div></section><section><pre class="CodeRay listingblock"><code class="java language-java">CompletableFuture&lt;<span class="predefined-type">Boolean</span>&gt; isObscene = CompletableFuture
    .supplyAsync(() -&gt; profanity.checkProfanity(phrase));

CompletableFuture&lt;Optional&lt;DictionaryWord&gt;&gt; noTranslation =
    CompletableFuture.completedFuture(Optional.empty());

CompletableFuture&lt;Optional&lt;DictionaryWord&gt;&gt; maybeDictTranslation =
    CompletableFuture.supplyAsync(() -&gt; dict.translate(phrase));

CompletableFuture&lt;Optional&lt;DictionaryWord&gt;&gt; maybeBablaTranslation =
    CompletableFuture.supplyAsync(() -&gt; babla.translate(phrase));

CompletableFuture&lt;Optional&lt;DictionaryWord&gt;&gt; takeFirst =
    maybeDictTranslation.applyToEither(maybeBablaTranslation, Function.identity());

CompletableFuture&lt;Optional&lt;DictionaryWord&gt;&gt; future =
    isObscene.thenCompose(b -&gt; b ? noTranslation: takeFirst);

Optional&lt;DictionaryWord&gt; word = future.join();
<span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">translate = </span><span class="delimiter">&quot;</span></span> + word);</code></pre></section><section><div class="imageblock" style=""><img src="images/patterns/flavours-event-broker.png" alt="flavours event broker" style="background: white"></div></section></section>
<section><section id="slide_pattern_7_observability"><h2>Pattern #7: Observability</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Monitor the small things, and use aggregation to see the bigger picture</p></div></div></div></section><section id="slide_intent_6"><h2>Intent</h2><div class="quoteblock"><blockquote>Modern Internet services are often implemented as complex, large-scale distributed systems. These applications are constructed from collections of software modules that may be developed by different teams, perhaps in different programming languages, and could span many thousands of machines across multiple physical facilities. Tools that aid in understanding system behavior and reasoning about performance issues are invaluable in such an environment.</blockquote></div></section><section id="slide_problem_7"><h2>Problem</h2><div class="ulist"><ul><li><p>A simple service communication diagram is in fact distributed among multiple services and instances</p></li><li><p>Individual log processing is close to impossible</p></li><li><p>Application context is becoming important (deployment skew I/O metrics)</p></li></ul></div></section><section id="slide_discussion_7"><h2>Discussion</h2><div class="dlist"><dl><dt class="hdlist1">Past times monitoring</dt><dd><div class="ulist"><ul><li><p><strong>Reactive monitoring</strong> (Naigos)</p></li><li><p>Monitors infrastructure and alerts when resources are running low (out of disk, CPU, or memory)</p></li></ul></div></dd><dt class="hdlist1">Future friendly (quality) monitoring</dt><dd><div class="ulist"><ul><li><p>Proactive alerts</p></li><li><p>Different categories of tracked data</p></li><li><p>Real time log aggregation</p></li><li><p>Services interactions</p></li></ul></div></dd></dl></div></section><section id="slide_classes_of_monitoring_services"><h2>Classes of monitoring services</h2><div class="dlist"><dl><dt class="hdlist1">Class 0 (Context-Less Monitoring)</dt><dd><div class="ulist"><ul><li><p>Think <strong>ping</strong></p></li><li><p>Collects information and alerts if there is an anomaly</p></li><li><p>Look at the state of the infrastructure as it is at the moment of observation, compare with a threshold value to decide if the state is healthy or not</p></li><li><p>Raw measurements without any additional context</p></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="https://blog.container-solutions.com/hs-fs/hubfs/Imported_Blog_Media/monitoring_image07-1.png?width=3800&name=monitoring_image07-1.png" alt="monitoring image07 1.png?width=3800&name=monitoring image07 1"></div></section><section><div class="dlist"><dl><dt class="hdlist1">Class 1 (Stateful Monitoring)</dt><dd><div class="ulist"><ul><li><p>Think <strong>Naigos</strong></p></li><li><p>Crossing the threshold value was not a sufficient to trigger an alert.</p></li><li><p>Compare the current sample with the information on past values of the measurement, to ensure that this was truly an anomaly deserving attention.</p></li><li><p><em>State Flapping</em> occurs when a service or host changes state too frequently, resulting in a storm of problem and recovery notifications. Flapping can be indicative of configuration problems (i.e. thresholds set too low), troublesome services, or real network problems.</p></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="https://blog.container-solutions.com/hs-fs/hubfs/Imported_Blog_Media/monitoring_image08-1.png?width=2000&name=monitoring_image08-1.png" alt="monitoring image08 1.png?width=2000&name=monitoring image08 1" width="90%"></div></section><section><div class="dlist"><dl><dt class="hdlist1">Class 2 (Syntactic Monitoring)</dt><dd><div class="ulist"><ul><li><p>Understanding the correlation between services</p><div class="ulist"><ul><li><p>Such correlations exist if there are functional or structural dependencies between components, e.g. two containers competing for I/O bandwidth of a physical host that runs them</p></li></ul></div></li><li><p>Understand both historical context (previous behavior) as well as syntactic (structural) context</p><div class="ulist"><ul><li><p>If related components degrade one after another (“domino effect”)</p></li></ul></div></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="https://blog.container-solutions.com/hs-fs/hubfs/Imported_Blog_Media/monitoring_image09-1.png?width=1800&name=monitoring_image09-1.png" alt="monitoring image09 1.png?width=1800&name=monitoring image09 1" width="80%"></div></section><section id="slide_modern_observability"><h2>Modern observability</h2><div class="ulist"><ul><li><p>Readiness and liveness probes</p></li><li><p>Health checks</p></li><li><p>Centralize logging (access all logs from a single place)</p></li><li><p>Correlate requests between services (traceId, correlationId)</p></li><li><p>Instrument a service to gather statistics about individual operations</p></li><li><p>Alerting based self contained metrics</p></li></ul></div></section><section><div class="imageblock" style=""><img src="https://blog.container-solutions.com/hs-fs/hubfs/Imported_Blog_Media/monitoring_image05-1.png?width=3998&name=monitoring_image05-1.png" alt="monitoring image05 1.png?width=3998&name=monitoring image05 1" width="75%"></div><div class="title">Applying wrong class of monitoring</div></section><section><div class="imageblock" style=""><img src="https://blog.container-solutions.com/hs-fs/hubfs/Imported_Blog_Media/monitoring_image03-1.png?width=3998&name=monitoring_image03-1.png" alt="monitoring image03 1.png?width=3998&name=monitoring image03 1" width="75%"></div><div class="title">Applying wrong class of monitoring</div></section><section id="slide_implementation_4"><h2>Implementation</h2><div class="quoteblock"><div class="title">Drapper, a Large-Scale Distributed Systems Tracing Infrastructure</div><blockquote>Google’s production distributed systems tracing infrastructure, and describe how our design goals of low overhead, application-level transparency, and ubiquitous deployment on a very large scale system were met.</blockquote></div></section><section id="slide_distributed_tracing_span"><h2>Distributed tracing - <strong>Span</strong></h2><div class="dlist"><dl><dt class="hdlist1">The basic unit of work (e.g. sending RPC)</dt><dd><div class="ulist"><ul><li><p>Spans are started and stopped</p></li><li><p>They keep track of their timing information</p></li><li><p>Once you create a span, you must stop it at some point in the future</p></li><li><p>Has a parent and can have multiple children</p></li></ul></div></dd></dl></div></section><section id="slide_distributed_tracing_trace"><h2>Distributed tracing - <strong>Trace</strong></h2><div class="dlist"><dl><dt class="hdlist1">A set of spans forming a tree-like structure</dt><dd><div class="ulist"><ul><li><p>For example, if you are running a book store then</p><div class="ulist"><ul><li><p>Trace could be retriving a list of available books</p></li><li><p>Assuming that to retrive the books you have to send 3 requests to 3 services
then you could have at least 3 spans (1 for each hop) forming 1 trace</p></li></ul></div></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="https://raw.githubusercontent.com/spring-cloud/spring-cloud-sleuth/master/docs/src/main/asciidoc/images/trace-id.png" alt="trace id" width="90%"></div></section><section id="slide_distributed_tracing_annotations"><h2>Distributed tracing - <strong>Annotations</strong></h2><div class="dlist"><dl><dt class="hdlist1">Events logs</dt><dd><div class="ulist"><ul><li><p>Client Sent (CS) - The client has made a request</p></li><li><p>Server Received (SR) - The server side got the request and will start processing it</p><div class="ulist"><ul><li><p>Subtractions the CS timestamp from CR timestamp gives the network latency.</p></li></ul></div></li><li><p>Server Send (SS) - Annotated upon completion of request processing</p><div class="ulist"><ul><li><p>SS timestamp - SR timestamp &#8594; time needed by the server side to process the request</p></li></ul></div></li><li><p>Client Received (CR) - Signifies the end of the span.</p><div class="ulist"><ul><li><p>The client has successfully received the response from the server side</p></li></ul></div></li></ul></div></dd></dl></div></section><section><div class="imageblock" style=""><img src="https://raw.githubusercontent.com/spring-cloud/spring-cloud-sleuth/master/docs/src/main/asciidoc/images/zipkin-ui.png" alt="zipkin ui"></div></section><section><div class="imageblock" style=""><img src="http://zipkin.io/public/img/architecture-1.png" alt="architecture 1"></div></section><section><div class="imageblock" style=""><img src="images/patterns/zipkin-tracing-seq-diagram.png" alt="zipkin tracing seq diagram"></div></section><section><div class="imageblock" style=""><img src="https://raw.githubusercontent.com/spring-cloud/spring-cloud-sleuth/master/docs/src/main/asciidoc/images/kibana.png" alt="kibana"></div></section><section id="slide_exercise_6" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #7: Monitoring</p></div></div></div></section></section>
<section><section id="slide_pattern_8_application_security"><h2>Pattern #8: Application security</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Don&#8217;t reinvent the wheel. Security is so critical that in most cases you want to trust code written by companies that are in the business of security.</p></div></div></div></section><section id="slide_oauth2"><h2>OAuth2</h2></section><section><div class="imageblock" style=""><img src="images/patterns/security-oauth-flow.png" alt="security oauth flow" width="80%"></div></section><section id="slide_jwt"><h2>JWT</h2></section><section><div class="imageblock" style=""><img src="https://cdn.auth0.com/content/jwt/jwt-diagram.png" alt="jwt diagram"></div></section><section id="slide_jwt_2"><h2>JWT (2)</h2><div class="ulist"><ul><li><p>Self-contained - zawierają wszystkie potrzebne informacje</p></li><li><p>Działają pomiędzy różnymi środowiskami (językami programowania)</p></li><li><p>Łatwe do przesyłania jako element URL lub nagłówek</p></li></ul></div></section><section id="slide_jwt_struktura_1"><h2>JWT - struktura (1)</h2><div class="ulist"><ul><li><p>header (base64)</p><pre class="CodeRay listingblock"><code class="json language-json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">typ</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">JWT</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">alg</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">HS256</span><span class="delimiter">&quot;</span></span>
}</code></pre></li><li><p>payload (JWT Claims: registered, public and private)</p><pre class="CodeRay listingblock"><code class="json language-json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">iss</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">scotch.io</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="key"><span class="delimiter">&quot;</span><span class="content">exp</span><span class="delimiter">&quot;</span></span>: <span class="integer">1300819380</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Jakub</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>  <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre></li></ul></div></section><section id="slide_jwt_struktura_2"><h2>JWT - struktura (2)</h2><div class="ulist"><ul><li><p>signature</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="javascript language-javascript"><span class="keyword">var</span> encodedString = base64UrlEncode(header)
                + <span class="string"><span class="delimiter">&quot;</span><span class="content">.</span><span class="delimiter">&quot;</span></span>
                + base64UrlEncode(payload);

HMACSHA256(encodedString, <span class="string"><span class="delimiter">'</span><span class="content">secret</span><span class="delimiter">'</span></span>);</code></pre></section><section id="slide_security_and_csrf"><h2>Security and CSRF</h2><div class="olist arabic"><ol class="arabic"><li><p>Token is stored at the client side and is subject to theft</p><div class="ulist"><ul><li><p>LocalStorage can be accessed through XSS attacks</p></li><li><p>Cookies can be used during CSRF (impersonalisation)</p></li></ul></div></li><li><p>Server needs to ensure that the token is coming from a trustworthy side</p><div class="ulist"><ul><li><p>JWT token is stored in <code>HttpOnly</code> cookie and transfered via HTTPS</p></li><li><p>Verification of <code>origin</code> and <code>referrer</code> - attacks coming from different domains</p></li><li><p>Additional data (JWT signature) stored in _non-standard cookie_and transfer as HTTP Header (<code>X-XSRF-TOKEN</code>)</p></li></ul></div></li><li><p>When the client submits both elements the consistency is checked (origin and modifications) - <strong>Double Submit Cookies Method</strong></p></li></ol></div></section><section id="slide_exercise_7" class="live-demo"><h2>Exercise</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Task #8: Security</p></div></div></div></section></section>
<section><section id="slide_refaktoryzacja_monolitów" data-background-image="background_blue.jpg" data-background-size="cover"><h2>Refaktoryzacja monolitów</h2></section><section id="slide_stan_istniejący_architektura"><h2>Stan istniejący (architektura)</h2><div class="ulist"><ul><li><p>3-tiered application</p><div class="ulist"><ul><li><p>Warstwa interfejsu użytkownika (GWT, JSF, Silverflight, Flash)</p></li><li><p>Warstwa uslug (komponentów biznesowych &#8594; logika aplikacji + <code>ManagedBean JSF</code>, SOAP WebServices)</p></li><li><p>Warstwa persystencji (baza danych)</p></li><li><p>Warstwa componentów integracyjnych (wejściowych i wyjściowych) (opcjonalnie)</p></li></ul></div></li></ul></div></section><section id="slide_stan_istniejący_problemy"><h2>Stan istniejący (problemy)</h2><div class="ulist"><ul><li><p>Powiązania (sprzężenia) pomiędzy elementami aplikacji (obszarami funkcjonalnymi) - skutkujące niemożliwym do utrzymanie kodem</p></li><li><p>Zależności pomiędzy elementami w kodzie skutkujące sprzężeniami w <em>runtime</em> - żądania blokują i czekają</p></li><li><p>Problemy ze skalowaniem systemu: im więcej system <em>ma pracy</em>, tym dłużej trwają zapytania, tym dużej blokowane są wątki</p></li><li><p>Blokowanie bazy danych że względu na operowanie w zakresie pojedynczej transakcji.</p></li></ul></div></section><section id="slide_nim_zaczniemy_refaktoryzację"><h2>Nim zaczniemy refaktoryzację</h2><div class="paragraph"><p>Implementacja monitoringu na samym początku okazuje się być kluczowa, aby śledzić czy poszczególne serwisy podlegając zmianą nadal <em>robią to co mają robić</em></p></div>
<div class="dlist"><dl><dt class="hdlist1">Implementacja monitoringu to dodatkowo</dt><dd><div class="ulist"><ul><li><p><strong>Analiza użycia</strong>: weryfikacja które elementy systemu używane są najintensywniej (dodatkowo, które są zmieniane - <em>churn</em> / <em>Feather&#8217;s Quadrant</em>) - możliwe że warto zacząć od tych elementów systemu</p></li><li><p><strong>Analiza wydajności</strong>: które elementy systemu są wąskimi gardłami, które są zasobożerne - możliwe że to są potencjalni kandydaci do refaktoryzacji</p></li></ul></div></dd></dl></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>Każdy system na zawsze tylko jedno ograniczenie</p></div></div></div></section><section><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Podejście od strony kodu</p></div></div></div></section><section id="slide_migracja_kodu"><h2>Migracja kodu</h2><div class="olist arabic"><ol class="arabic"><li><p>REST / JMS - pozostają bez zmian</p><div class="ulist"><ul><li><p>REST jako zasoby dla aplikacji frontendowej</p></li></ul></div></li><li><p>SOAP i EJB</p><div class="ulist"><ul><li><p>Implementacja wzorca <code>Service Facade</code> jest prosta do przełożenia na serwis <em>asset-based</em> (zmiana CRUDowych metod RPC na operacje na pojedynczych obiektach)</p></li><li><p>Pewna doza kompatybilności JAXB i JSON może być pomocna</p></li></ul></div></li><li><p>Servlet / JSP / JSF</p><div class="ulist"><ul><li><p>Konwersja 'logiki' zawartej w serwletach, <em>managed bean</em> w kierunku obiektów domenowych DDD.</p></li></ul></div></li></ol></div></section><section id="slide_migracja_nowe_funkcjonalności"><h2>Migracja / nowe funkcjonalności</h2><div class="imageblock" style=""><img src="https://cdn.wp.nginx.com/wp-content/uploads/2016/03/Adding_a_secure_microservice_alongside_a_monolithic_application.png" alt="Adding a secure microservice alongside a monolithic application" width="55%"></div></section><section id="slide_jak_zrobić_glue_code"><h2>Jak zrobić <em>glue code</em></h2><div class="ulist"><ul><li><p>Wywołanie zdalnych API dostarczonych przez <em>legacy application</em></p></li><li><p>Bezpośrednie połączenie do istniejących danych</p></li><li><p>Przetrzymywanie i synchronizowanie własnej kopi danych</p><div class="ulist"><ul><li><p>Eventual consistency / Event based integration</p></li></ul></div></li></ul></div></section><section id="slide_wyodrębnienie_istniejącego_kodu"><div class="imageblock" style=""><img src="images/Richardson-microservices-part7-extract-module_1.png" alt="Richardson microservices part7 extract module 1"></div></section><section id="slide_wyodrębnienie_istniejącego_kodu_2"><div class="imageblock" style=""><img src="images/Richardson-microservices-part7-extract-module_2.png" alt="Richardson microservices part7 extract module 2"></div></section><section id="slide_gdy_http_to_za_mało"><h2>Gdy HTTP to za mało</h2><div class="imageblock" style=""><img src="http://www.planetgeek.ch/wp-content/uploads/2012/09/Slide18.jpg" alt="Slide18"></div></section><section><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Podejście od strony domeny</p></div></div></div></section><section id="slide_jak_przeprowadzić_migrację_1"><h2>Jak przeprowadzić migrację (1)</h2><div class="paragraph"><p>Wraz z ekspertami domenowymi identyfikujemy kluczowe zdarzenia w obrębie systemu ("utworzenie klienta", "modyfikacja klienta", "rozpoczęcie procesu płatności", "zakończenie procesu płatności").</p></div>
<div class="paragraph"><p>Aplikacja rozpoczyna rozgłaszanie wiadomości (zdarzeń), a wraz z każdą aktualizacją systemu dodajemy więcej zdarzeń - nawet jeżeli nie są obsługiwane przez pozostałe elementy systemu</p></div></section><section id="slide_jak_przeprowadzić_migrację_2"><h2>Jak przeprowadzić migrację (2)</h2><div class="paragraph"><p>Nowe funkcjonalności (potencjalnie na <em>obrzeżach</em> systemu) mogą zacząć używać opublikowanych zdarzeń jako wyzwalaczy (<em>triggerów</em>).</p></div>
<div class="paragraph"><p>Przykładowo: funkcjonalności eksportu, przeliczenia w tle wymagane np. do raportów, tworzenie nowy elementów (wydarzeń) to listy zadań, de-duplikacja danych na potrzeby wydajności.</p></div>
<div class="paragraph"><p>Dzięki temu nowe moduły (funkcjonalności) mogą pojawiać się w systemie minimalizując konieczność ingerencji w istniejący kod.</p></div></section><section id="slide_jak_przeprowadzić_migrację_3"><h2>Jak przeprowadzić migrację (3)</h2><div class="paragraph"><p>Wyzwaniem może być pozostawienie spójnego interfejsu użytkownika. Pomimo rozbicia systemu na niezależne elementy, oczekiwane jest że interfejs użytkownika pozostanie spójny.</p></div>
<div class="paragraph"><p>Możliwe podejścia to:</p></div>
<div class="ulist"><ul><li><p>Single Page Application (SPA) - monolit na poziomie warstwy UI</p></li><li><p>Komponenty UI (np. dyrektywy AngularJS, komponenty ReactJS) - przywiązanie do konkretnej technologii</p></li><li><p>Niezależne komponenty - każdy mikroserwis samodzielnie publikuje fragment UI (snippet)</p><div class="ulist"><ul><li><p>Zalando Project Mosaic (<a href="https://www.mosaic9.org/" class="bare">https://www.mosaic9.org/</a>)</p></li><li><p>Allegro OpBox</p></li></ul></div></li></ul></div></section><section><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Podejście od strony danych</p></div></div></div></section><section id="slide_migracja_struktur_relacyjnych"><h2>Migracja struktur relacyjnych</h2><div class="olist arabic"><ol class="arabic"><li><p>Zero Downtime migrations</p></li><li><p>Back and Forward compatibility</p></li><li><p>Baby steps (Small batch sizes)</p></li><li><p>Avoid locks</p></li></ol></div></section><section><div class="title">Kiedyś</div><pre class="CodeRay listingblock"><code>ALTER TABLE customers RENAME COLUMN wrong TO correct;</code></pre>
<div class="title">Teraz</div><pre class="CodeRay listingblock"><code>ALTER TABLE customers ADD COLUMN correct VARCHAR(20);
UPDATE customers SET correct = wrong WHERE id &lt; 100;
UPDATE customers SET correct = wrong WHERE id &lt; 200;
&lt;code update&gt;
&lt;code update&gt;
&lt;code update&gt;
(later...)ALTER TABLE customers DELETE COLUMN wrong</code></pre></section><section id="slide_zmiana_nazwy_kolumny_typu_danych"><h2>Zmiana nazwy kolumny / typu danych</h2><div class="olist arabic"><ol class="arabic"><li><p>Tworzenie nowej kolumny</p></li><li><p>Kod czyta ze starej kolumny, zapisuje do obu</p></li><li><p>Kopiujemy dane mały kawałkami</p></li><li><p>Kod czyta z nowej kolumny, zapisuje do obu</p></li><li><p>Kod czyta i zapisuje do nowej kolumny</p></li><li><p>Usuwamy starą kolumnę</p></li></ol></div></section><section id="slide_wyodrębnienie_danych"><h2>Wyodrębnienie danych</h2><div class="dlist"><dl><dt class="hdlist1">Widok</dt><dd><div class="ulist"><ul><li><p>Najłatwiejszy i najpopularniejszy</p></li><li><p>Spójność kosztem problemów z wydajnością</p></li><li><p>Bazy muszą być dla siebie widoczne</p></li></ul></div></dd><dt class="hdlist1">Widok zmaterializowany</dt><dd><p> </p></dd><dt class="hdlist1">Klonowanie tabel poprzez triggery</dt><dd><div class="ulist"><ul><li><p>Różny wsparcie w zależności o silnika bazy danych</p></li></ul></div></dd></dl></div></section><section id="slide_wyodrębnienie_danych_2"><h2>Wyodrębnienie danych</h2><div class="dlist"><dl><dt class="hdlist1">Klonowanie tabel poprzez zewnętrzne procesy ETL</dt><dd><div class="ulist"><ul><li><p>Wiele różnych narzędzi</p></li><li><p>Wymaga zewnętrznego <em>schedulera</em></p></li><li><p>Może operować na kilku bazach danych jednocześnie</p></li></ul></div></dd><dt class="hdlist1">Event sourcing</dt><dd><div class="ulist"><ul><li><p>Konwersja operacji bazodanowych na zdarzenia</p></li><li><p>Łatwa analiza danych</p></li><li><p>Brak silnej spójności danych</p></li></ul></div></dd></dl></div></section></section>
<section><section id="slide_restafarianizm" data-background-image="background_blue.jpg" data-background-size="cover"><h2>RESTafarianizm</h2></section><section id="slide_orientacja_na_zasoby"><h2>Orientacja na zasoby</h2><div class="ulist"><ul><li><p>Podejście REST (Representational State Transfer) - rok 2000</p><div class="ulist"><ul><li><p>tradycyjne techniki i metody HTTP (GET, POST, PUT, DELETE) są w zupełności wystarczające</p></li><li><p>lekkie podejście nie wymagające specjalnych implementacji po stronie klienta</p></li><li><p>unikalny URL reprezentuje komponent usług sieciowych a nie konkretną usługę</p></li><li><p>bezpośrednia dostępność usług ułatwia ich integrację</p></li></ul></div></li></ul></div></section><section id="slide_rest"><h2>REST </h2><div class="dlist"><dl><dt class="hdlist1">Bazując na protokole HTTP, REST zakłada</dt><dd><div class="ulist"><ul><li><p>Komunikację klient - serwer</p><div class="ulist"><ul><li><p>SOAP można było wykorzystywać także przy innych protokołach komunikacyjnych</p></li></ul></div></li><li><p>Brak stanu (bezstanwość) serwera</p></li><li><p>Cache</p></li><li><p>Jednolity interfejs</p><div class="ulist"><ul><li><p>Jednoznaczna identyfikacja zasobu (poprzez URI)</p></li><li><p>Manipulacja zasobami poprzez ich reprezentację</p></li><li><p>Samoopisujące się wiadomości</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_rest_2"><h2>REST (2)</h2><div class="ulist"><ul><li><p>Komunikacja następuje w oparciu o metody HTTP</p><div class="ulist"><ul><li><p>GET, POST, PUT, DELETE</p></li></ul></div></li><li><p>Informacja zwrotna to status HTTP</p><div class="ulist"><ul><li><p>200 OK, 201 Created, 204 No Content, 400 Bad Request, 404 Not Found</p></li></ul></div></li><li><p>Dodatkowe (meta) informacje poprzez nagłówki</p><div class="ulist"><ul><li><p>Accept: application/json; charset=utf-8</p></li><li><p>Accept-encoding: gzip</p></li><li><p>Content-type: application/json; charset=utf-8</p></li></ul></div></li></ul></div></section><section id="slide_rest_3"><h2>REST (3)</h2><div class="ulist"><div class="title">Zasady RESTa mogą prowadzić do ograniczeń</div><ul><li><p>Podział klient-serwer</p></li><li><p>Bezstanowość serwera</p></li><li><p>Cache</p></li><li><p>Jednolity interfejs</p><div class="ulist"><ul><li><p>Identyfikacja zasobów</p></li><li><p>Manipulacja zasobami przez reprezentacje</p></li><li><p>Samoopisujące się wiadomości</p></li><li><p>HATEOAS</p></li></ul></div></li><li><p>Podział na warstwy</p></li></ul></div></section><section id="slide_rest_4"><h2>REST (4)</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Data Element</th><th class="tableblock halign-left valign-top">Modern Web Examples</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">resource</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">the intended conceptual target of a hypertext reference</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">resource identifier</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">URL, URN</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">representation</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">HTML document, JPEG image</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">representation metadata</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">media type, last-modified time</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">resource metadata</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">source link, alternates, vary</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">control data</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">if-modified-since, cache-control</p></td></tr></table></section><section id="slide_integracja_systemów_to_także_api"><h2>Integracja systemów to także API</h2><div class="dlist"><dl><dt class="hdlist1">Zasady projektowania API nadal pozostają "w cenie"</dt><dd><div class="ulist"><ul><li><p>Klientami twojego API są programiści</p></li><li><p>Pomimo tego że API działa z wykorzystaniem HTTP - nadal musi być czytelne</p><div class="ulist"><ul><li><p>zwłaszcza w wypadku błędów</p></li></ul></div></li><li><p>Wykorzystuj standardy</p></li><li><p>Zachowuj kompatybilność wsteczną i zaplanuj długie cykle życia wersji</p></li><li><p>Planuj strukturę reprezentacji zasobów</p></li></ul></div></dd></dl></div></section><section id="slide_richardson_maturity_model"><h2>Richardson Maturity Model</h2><div class="ulist"><ul><li><p>Model dojrzałości API webowego</p><div class="ulist"><ul><li><p>Na podstawie analizy istniejących interfejsów</p></li><li><p>Wykonany przez Leonard Richardson w 2008 roku</p></li></ul></div></li><li><p>Definiuje 4 poziomy dojrzałości</p></li><li><p><strong>Level 0</strong> - pojedynczy URL, jedna metoda HTTP</p><div class="ulist"><ul><li><p>Głównie serwisy SOAP XML (jak strona we Flashu)</p></li></ul></div></li><li><p><strong>Level 1</strong> - wiele adresów URL - wszystkie wykorzystujące jedną metodę HTTP</p></li><li><p><strong>Level 2</strong> - wiele adresów URL wykorzystujących metody HTTP</p></li><li><p><strong>Level 3</strong> - zasoby deklarują zależności i połączenia (linki)</p></li></ul></div></section><section id="slide_level_0"><h2>Level 0</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-e114b.png" alt="rest integration e114b"></div></section><section id="slide_level_0_request"><h2>Level 0 - request</h2><pre class="CodeRay listingblock"><code class="txt language-txt">POST /auctionServiceAPIEndpoint HTTP/1.1</code></pre>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;query&gt;</span>
  <span class="tag">&lt;params&gt;</span>
    <span class="tag">&lt;name&gt;</span>Macbook Air<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;price_from&gt;</span>0<span class="tag">&lt;/price_from&gt;</span>
    <span class="tag">&lt;price_to&gt;</span>1000<span class="tag">&lt;/price_to&gt;</span>
  <span class="tag">&lt;/params&gt;</span>
<span class="tag">&lt;/query&gt;</span></code></pre></section><section id="slide_level_0_response"><h2>Level 0 - response</h2><pre class="CodeRay listingblock"><code class="txt language-txt">HTTP/1.1 200 OK</code></pre>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;items&gt;</span>
  <span class="tag">&lt;item&gt;</span>
    <span class="tag">&lt;id&gt;</span>123<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;name&gt;</span>Macbook Air<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;price&gt;</span>499<span class="tag">&lt;/price&gt;</span>
    <span class="tag">&lt;condition&gt;</span>NEW<span class="tag">&lt;/condition&gt;</span>
  <span class="tag">&lt;/item&gt;</span>
<span class="tag">&lt;/items&gt;</span></code></pre></section><section id="slide_level_0_request_2"><h2>Level 0 - request</h2><pre class="CodeRay listingblock"><code>POST /appointmentService HTTP/1.1</code></pre>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;appointmentRequest&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">doctor</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">mjones</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">start</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1400</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1450</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;patient</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">jsmith</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/appointmentRequest&gt;</span></code></pre></section><section id="slide_level_0_request_3"><h2>Level 0 - request</h2><pre class="CodeRay listingblock"><code>POST http://svcs.ebay.com/services/search/FindingService/v1</code></pre>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;findItemsByKeywordsRequest</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.ebay.com/marketplace/search/v1/services</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;affiliate&gt;</span>
    <span class="tag">&lt;networkId&gt;</span>9<span class="tag">&lt;/networkId&gt;</span>
    <span class="tag">&lt;trackingId&gt;</span>1234567890<span class="tag">&lt;/trackingId&gt;</span>
    <span class="tag">&lt;customId&gt;</span>k-man<span class="tag">&lt;/customId&gt;</span>
  <span class="tag">&lt;/affiliate&gt;</span>
  <span class="tag">&lt;sortOrder&gt;</span>EndTime<span class="tag">&lt;/sortOrder&gt;</span>
  <span class="tag">&lt;paginationInput&gt;</span>
    <span class="tag">&lt;entriesPerPage&gt;</span>2<span class="tag">&lt;/entriesPerPage&gt;</span>
  <span class="tag">&lt;/paginationInput&gt;</span>
  <span class="tag">&lt;keywords&gt;</span>camalots<span class="tag">&lt;/keywords&gt;</span>
<span class="tag">&lt;/findItemsByKeywordsRequest&gt;</span></code></pre></section><section id="slide_level_1"><h2>Level 1</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-bd0cb.png" alt="rest integration bd0cb"></div></section><section id="slide_level_1_uris"><h2>Level 1 - URIs</h2><pre class="CodeRay listingblock"><code>POST /slots/1234/create HTTP/1.1 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Akcja w URL</td></tr></table></div>
<div class="paragraph"><p>&#8203;</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;appointmentRequest&gt;</span>
  <span class="tag">&lt;patient</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">jsmith</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/appointmentRequest&gt;</span></code></pre></section><section id="slide_level_2"><h2>Level 2</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-e937d.png" alt="rest integration e937d"></div></section><section id="slide_level_2_http"><h2>Level 2 - HTTP</h2><div class="title">Request</div><pre class="CodeRay listingblock"><code>GET /doctors/mjones/slots?date=20100104&amp;status=open HTTP/1.1
Host: royalhope.nhs.uk</code></pre>
<div class="title">Response</div><pre class="CodeRay listingblock"><code>HTTP/1.1 200 OK <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Poprawne kody odpowiedzi HTTP</td></tr></table></div>
<div class="paragraph"><p>&#8203;</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;openSlotList&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1234” start = </span><span class="delimiter">&quot;</span></span><span class="attribute-name">1400</span><span class="error">&quot;</span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1450</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">5678” start = </span><span class="delimiter">&quot;</span></span><span class="attribute-name">1600</span><span class="error">&quot;</span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1650</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/openSlotList&gt;</span></code></pre></section><section id="slide_level_2_metody_http"><h2>Level 2  - metody HTTP</h2><div class="ulist"><div class="title">GET (Safe and Idempotent)</div><ul><li><p><code>GET /auctions</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 200 OK</code></p></li></ul></div></li><li><p><code>GET /auctions/1234</code></p></li><li><p><code>GET /auctions?search=Macbook+Air</code></p></li></ul></div>
<div class="ulist"><div class="title">DELETE (<strong>Not</strong> safe and Idempotent)</div><ul><li><p><code>DELETE /auctions/1234</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 204 No Content</code></p></li></ul></div></li></ul></div></section><section id="slide_level_2_metody_http_2"><h2>Level 2 - metody HTTP</h2><div class="title">Request</div><pre class="CodeRay listingblock"><code class="json language-json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">Macbook Air 2010</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">condition</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">NEW</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span> : <span class="integer">499</span>
}</code></pre>
<div class="ulist"><div class="title">POST (<strong>Not</strong> safe and <strong>not</strong> Idempotent)</div><ul><li><p><code>POST /items</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 201 Created</code><br>
<code>Location: <a href="http://api.example.com/items/1235" class="bare">http://api.example.com/items/1235</a></code></p></li><li><p><strong>Serwer nadaje identyfikator</strong></p></li></ul></div></li></ul></div></section><section id="slide_level_2_metody_http_3"><h2>Level 2 - metody HTTP</h2><div class="title">Request</div><pre class="CodeRay listingblock"><code class="json language-json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">Macbook Air 2010</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">condition</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">LIKE_NEW</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span> : <span class="integer">498</span>
}</code></pre>
<div class="ulist"><div class="title">PUT (<strong>Not</strong> safe and Idempotent)</div><ul><li><p><code>PUT /items/1235</code></p></li><li><p><code>PUT /users/joe</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 204 No Content</code></p></li><li><p><strong>Klient przekazuje identyfikator</strong></p></li></ul></div></li></ul></div></section><section id="slide_level_2_metody_http_4"><h2>Level 2 - metody HTTP</h2><table class="tableblock frame-all grid-all" style=""><colgroup><col><col><col></colgroup><thead><tr><th class="tableblock halign-left valign-top">&#8203;</th><th class="tableblock halign-left valign-top"><code>/users</code></th><th class="tableblock halign-left valign-top"><code>/users/456</code></th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Get All</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Get a user</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">New user</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Update</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Delete All</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Delete a user</p></td></tr></table></section><section id="slide_level_2_http_responses"><h2>Level 2 - http responses</h2><div class="ulist"><ul><li><p><code>2xx</code>: here you go</p></li><li><p><code>3xx</code>: go away</p></li><li><p><code>4xx</code>: you fucked up</p></li><li><p><code>5xx</code>: I fucked up</p></li></ul></div></section><section id="slide_level_2_http_responses_2"><h2>Level 2 - http responses</h2><div class="dlist"><dl><dt class="hdlist1">Success</dt><dd><div class="ulist"><ul><li><p>200 OK</p></li><li><p>201 CREATED</p></li><li><p>202 ACCEPTED</p></li><li><p>204 NO CONTENT</p></li></ul></div></dd><dt class="hdlist1">Redirect</dt><dd><div class="ulist"><ul><li><p>301 MOVED PERMANENTLY</p></li><li><p>303 SEE OTHER</p></li><li><p>304 NOT MODIFIED</p></li><li><p>307 TEMPORARY REDIRECT</p></li></ul></div></dd></dl></div></section><section id="slide_level_2_http_responses_3"><h2>Level 2 - http responses</h2><div class="dlist"><dl><dt class="hdlist1">User error</dt><dd><div class="ulist"><ul><li><p>400 BAD REQUEST</p></li><li><p>401 UNAUTHORIZED</p></li><li><p>403 FORBIDDEN</p></li><li><p>404 NOT FOUND</p></li><li><p>405 METHOD NOT ALLOWED</p></li><li><p>410 GONE</p></li></ul></div></dd><dt class="hdlist1">Server error</dt><dd><div class="ulist"><ul><li><p>500 INTERNAL SERVER ERROR</p></li><li><p>503 SERVICE UNAVAILABLE</p></li></ul></div></dd></dl></div></section><section id="slide_level_2_http_responses_4"><h2>Level 2 - http responses</h2><div class="paragraph center"><p><strong>Kody błędu są dla błędów</strong></p></div>
<div class="title">Request</div><pre class="CodeRay listingblock"><code>http://api.flickr.com/services/rest?
  method=flickr.photos.people.add
  &amp;api_key=xxx&amp;photo_id=yyy&amp;user_id=zzz</code></pre>
<div class="title">Response</div><pre class="CodeRay listingblock"><code>HTTP/200 OK</code></pre>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="tag">&lt;rsp</span> <span class="attribute-name">stat</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fail</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;err</span> <span class="attribute-name">code</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">100</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">msg</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid API Key (Key has invalid format)</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/rsp&gt;</span></code></pre></section><section id="slide_level_2_2"><h2>Level 2</h2><div class="ulist"><div class="title">Kiedy jest to wystarczające?</div><ul><li><p>Małe API</p></li><li><p>CRUD</p></li><li><p>Brak wyraźnego <em>flow</em> (procesu) w obrębie aplikacji</p></li></ul></div></section><section id="slide_level_3"><h2>Level 3</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-62a4c.png" alt="rest integration 62a4c"></div></section><section id="slide_level_3_2"><h2>Level 3</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-37e21.png" alt="rest integration 37e21"></div></section><section id="slide_level_3_3"><h2>Level 3</h2><div class="ulist"><div class="title">Zalety</div><ul><li><p>Sterowanie przepływem danych w aplikacji</p></li><li><p>Sterowanie dostępnymi podzasobami</p></li><li><p>Luźniejsze związanie serwera i klienta</p></li><li><p>Dodatkowa dokumentacja API (jednak niewystarczająca)</p></li></ul></div>
<div class="ulist"><div class="title">Wady</div><ul><li><p>Więcej pracy</p></li><li><p>Więcej transferu</p></li><li><p>Tworzenie API dla nieistniejącego klienta</p></li><li><p>Brak wyraźnego standardu (JSON API)</p></li></ul></div></section><section id="slide_level_3_response"><h2>Level 3 - response</h2><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;appointment&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1234</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doctor</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">mjones</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">start</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1400</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1450</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;patient</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">jsmith</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;link</span> <span class="attribute-name">rel</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/linkrels/appointment/addTest</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">uri</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/slots/1234/appointment/tests</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;link</span> <span class="attribute-name">rel</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/linkrels/appointment/updateContactInfo</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">uri</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/patients/jsmith/contactInfo</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/appointment&gt;</span></code></pre></section><section id="slide_level_3_response_2"><h2>Level 3 - response</h2><div class="title">Hypertext Application Language</div><pre class="CodeRay listingblock"><code>{
    "name": "Luke Skywalker",
    "height": "1.72 m",
    "mass": "77 Kg",
    "hair_color": "Blond",
    "_links": {
        "self": {
            "href": "http://swapi.co/api/people/1/",
            "title": "Luke Skywalker"
        },
        "http://swapi.co/api/rels/species": {
            "href": "http://swapi.co/api/species/1/",
            "title": "Human"
        }
    }
}</code></pre></section><section id="slide_wersjonowanie"><h2>Wersjonowanie </h2><div class="paragraph"><p>Czy URL jest elementem kontraktu? Czy bookmarkujemy, zapisujemy adresy URL?</p></div>
<div class="quoteblock"><blockquote>A REST API should be entered with no prior knowledge beyond the initial URI (bookmark) and set of standardized media types that are appropriate for the intended audience. Failure here implies that <strong>out-of-band information is driving interaction instead of hypertext</strong>.</blockquote><div class="attribution"><cite>REST APIs must be hypertext-driven (2008)</cite><br>&#8212; Roy T. Fielding</div></div></section><section id="slide_wersjonowanie_2"><h2>Wersjonowanie (2)</h2><div class="paragraph"><p>Czy informacja o MediaType jest konieczna aby skonsumować usługę?</p></div>
<div class="quoteblock"><blockquote>A REST API should spend almost all of its descriptive effort in defining the media type(s) used for representing resources and driving application state, or in defining extended relation names and/or hypertext-enabled mark-up for existing standard media types.</blockquote><div class="attribution"><cite>REST APIs must be hypertext-driven (2008)</cite><br>&#8212; Roy T. Fielding</div></div></section><section id="slide_wersjonowanie_5_levels_of_media_types"><h2>Wersjonowanie - 5 levels of media types</h2><div class="imageblock" style=""><img src="images/media+type+level+example.png" alt="media+type+level+example"></div>
<div class="ulist"><ul><li><p>formatting: <code>application/xml</code></p></li><li><p>schema: <code>application/rss+xml</code></p></li><li><p>domain: <code>application/vnd.google-earth.kml+xml</code></p></li><li><p>vesioning: <code>application/vnd.mycompany.billing-v2.1+json</code></p></li></ul></div></section><section id="slide_wersjonowanie_3"><h2>Wersjonowanie </h2><div class="title">Media-type, bezpośrednio poprzez nazwę</div><pre class="CodeRay listingblock"><code>Request:
GET /opengov/garbageschedule?location=Main%20Street HTTP/1.1
Accept: application/vnd.opengov.org.garbageschedule-v2+json <i class="conum" data-value="1"></i><b>(1)</b>

Response:
HTTP/1.1 200 OK
Content-Type: application/vnd.opengov.org.garbageschedule-v2+json
  {
    "schedule"
    "self": "schedule-2423",
    "dayOfWeek": "Monday",
    "oddOrEvenWeeks": "Odd"
  }</code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Najbardziej RESTful z RESTful; wiele różnych media-type do ślednienia</td></tr></table></div></section><section id="slide_wersjonowanie_2_2"><h2>Wersjonowanie (2)</h2><div class="title">Media-type, poprzez <em>qualifier</em></div><pre class="CodeRay listingblock"><code>Request:
GET /opengov/garbageschedule?location=Main%20Street HTTP/1.1
Accept: application/vnd.opengov.org.garbageschedule+json;v=1 <i class="conum" data-value="1"></i><b>(1)</b>

Response:
HTTP/1.1 200 OK
Content-Type: application/vnd.opengov.org.garbageschedule+json;v=1
  {
    "schedule"
    "self": "schedule-2423",
    "dayOfWeek": "Monday",
    "oddOrEvenWeeks": "Odd"
  }</code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td><em>Qualifier</em> wydaje się być łatwiejszy do implementacji.<br>
<em>Parameters MAY follow the type/subtype in the form of attribute/value pairs (rfc2616 sec 3.7)</em></td></tr></table></div></section><section id="slide_wersjonowanie_3_2"><h2>Wersjonowanie (3)</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.example.user.v1+json;q=0.9</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> UserResponse findUserV1(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">userId</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> userId) {
    User user = userRepository.findOne(userId);
    <span class="keyword">return</span> userResponseFactory.successUserResponseV1(
        getMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">findById.success</span><span class="delimiter">&quot;</span></span>), user);
}

<span class="annotation">@Produces</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.example.user.v2+json</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> UserResponse findUserV2(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">userId</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> userId) {
    User user = userRepository.findOne(userId);
    <span class="keyword">return</span> userResponseFactory.successUserResponseV2(
        getMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">findById.success</span><span class="delimiter">&quot;</span></span>), user);
}</code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Parametr <code>q</code> obniża wartość parametru<br>
<em>HTTP content negotiation (section 12) uses short "floating point" numbers to indicate the relative importance ("weight") of various negotiable parameters (rfc2616 sec 3.9)</em></td></tr></table></div></section><section id="slide_wersjonowanie_4"><h2>Wersjonowanie (4)</h2><div class="title">Wersja dodawana jest do URLa (domeny)</div><pre class="CodeRay listingblock"><code>Request:
GET /opengov/v1/garbageschedule?location=Main%20Street HTTP/1.1 <i class="conum" data-value="1"></i><b>(1)</b>
GET /opengov/garbageschedule?version=1&amp;location=Main%20Street HTTP/1.1 <i class="conum" data-value="2"></i><b>(2)</b>
Accept: application/vnd.opengov.org.garbageschedule+json

Response:
HTTP/1.1 200 OK
Content-Type: application/vnd.opengov.org.garbageschedule+json
  {
    "schedule"
    "self": "schedule-2423",
    "dayOfWeek": "Monday",
    "oddOrEvenWeeks": "Odd"
  }</code></pre></section><section id="slide_wersjonowanie_5"><h2>Wersjonowanie (5)</h2><pre class="CodeRay listingblock"><code>GET /opengov/v1/garbageschedule?location=Main%20Street HTTP/1.1</code></pre>
<div class="dlist"><dl><dt class="hdlist1">Wersja w URL</dt><dd><div class="ulist"><ul><li><p><strong>+</strong> Łatwe do testowania</p></li><li><p><strong>-</strong> Ten sam zasób funkcjonuje pod wieloma adresami URL. Dodatkowe elementy URL które nie mają znaczenia patrząc z punktu widzenia zasad REST</p></li><li><p><strong>-</strong> Wersja najbardziej aktualnego API nie jest jednoznaczna i bywa ciężka do odnalezienia (np. CKAN)</p></li></ul></div></dd></dl></div></section><section id="slide_wersjonowanie_6"><h2>Wersjonowanie (6)</h2><pre class="CodeRay listingblock"><code>GET /opengov/garbageschedule?version=1&amp;location=Main%20Street HTTP/1.1</code></pre>
<div class="dlist"><dl><dt class="hdlist1">Wersja w parametrach URL</dt><dd><div class="ulist"><ul><li><p><strong>+</strong> Łatwe do testowania</p></li><li><p><strong>+</strong> Domyślna wersja (aktualna) - np. poprzez brak podania wersji</p></li><li><p><strong>-</strong> Parametr <code>version</code> nie jest jednoznaczny i może być w konflikcie z atrybutami samego zasobu. Pomieszanie <em>query parameters</em> i <em>control parameters</em></p></li></ul></div></dd></dl></div></section><section id="slide_wersjonowanie_a_infrastruktura"><h2>Wersjonowanie a infrastruktura</h2><pre class="CodeRay listingblock"><code>map $http_accept $api_backend {
  default "localhost:8081";
  "~application/vnd\.example-v1\+json" "localhost:8080"
  "~application/vnd\.example-v2\+json" "localhost:8081"
}

proxy_pass http://$api_backend/$request_uri</code></pre>
<div class="ulist"><ul><li><p>Nie jest prawdą że konfiguracja na load balancerze jest możliwa tylko poprzez URL</p></li><li><p>Nginx pozwala na przekierowywanie wiadomości do odpowiedniego hosta w zależności od np. nagłówka <code>Accept</code></p></li></ul></div></section><section id="slide_złe_urle"><h2>Złe URLe</h2><pre class="CodeRay listingblock"><code>• http://www.acme.com/product/
• http://www.acme.com/product/filter/cats/desc
• http://www.acme.com/product/1234
• http://www.acme.com/photos/product/1234
• http://www.acme.com/photos/product/1234/new <i class="conum" data-value="1"></i><b>(1)</b>
• http://www.acme.com/photos/product/1234/5678 <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td><code>new</code> what?</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>PhotoID? ProductID?</td></tr></table></div></section><section id="slide_dobre_urle"><h2>Dobre URLe</h2><pre class="CodeRay listingblock"><code>• http://www.acme.com/products/  <i class="conum" data-value="1"></i><b>(1)</b>
• http://www.acme.com/products/?filter=cats&amp;sort=desc <i class="conum" data-value="2"></i><b>(2)</b>
• http://www.acme.com/products/1234 <i class="conum" data-value="3"></i><b>(3)</b>
• http://www.acme.com/products/1234/photos/ <i class="conum" data-value="4"></i><b>(4)</b>
• http://www.acme.com/products/1234/photos/?sort=latest
• http://www.acme.com/products/1234/photos/5678</code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Lista produktów</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Filtrowania</td></tr><tr><td><i class="conum" data-value="3"></i><b>3</b></td><td>Pojedynczy produkt</td></tr><tr><td><i class="conum" data-value="4"></i><b>4</b></td><td>Wszystkie zdjęcie</td></tr></table></div></section><section id="slide_przykład_z_życia_twitter_api"><h2>Przykład z życia - Twitter API </h2><div class="ulist"><div class="title">Status Show</div><ul><li><p>GET <code><a href="http://api.twitter.com/1/statuses/show/12345.json" class="bare">http://api.twitter.com/1/statuses/show/12345.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>show</em> jest elementem URLa</p></li></ul></div></li><li><p>Lepiej: GET <code><a href="http://twitter.com/statuses/12345" class="bare">http://twitter.com/statuses/12345</a></code> z odpowiednim <strong>Accept</strong> header</p></li></ul></div></section><section id="slide_przykład_z_życia_twitter_api_2"><h2>Przykład z życia - Twitter API (2)</h2><div class="ulist"><div class="title">Status Update</div><ul><li><p>POST <code><a href="http://api.twitter.com/1/statuses/update.json" class="bare">http://api.twitter.com/1/statuses/update.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>update</em> jest elementem URLa</p></li><li><p>Użytkownik jest <em>implicite</em> jako wynik uwierzytelnienia</p></li></ul></div></li><li><p>Lepiej: POST <code><a href="http://twitter.com/users/fabpot/statuses/" class="bare">http://twitter.com/users/fabpot/statuses/</a></code></p></li></ul></div></section><section id="slide_przykład_z_życia_twitter_api_3"><h2>Przykład z życia - Twitter API (3)</h2><div class="ulist"><div class="title">Status destroy</div><ul><li><p>POST <code><a href="http://api.twitter.com/1/statuses/destroy/12345.json" class="bare">http://api.twitter.com/1/statuses/destroy/12345.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>destroy</em> jest elementem URLa</p></li><li><p>Dziwna hierarchia, do czego odnosi się ID 12345?</p></li><li><p>Umożliwia zarówno akcję POST jak i DELETE</p></li></ul></div></li><li><p>Lepiej: DELETE <code><a href="http://twitter.com/statuses/12345" class="bare">http://twitter.com/statuses/12345</a></code></p></li></ul></div></section><section id="slide_przykład_z_życia_twitter_api_4"><h2>Przykład z życia - Twitter API (4)</h2><div class="ulist"><div class="title">Status retweets</div><ul><li><p>GET <code><a href="http://api.twitter.com/1/statuses/retweets/12345.json" class="bare">http://api.twitter.com/1/statuses/retweets/12345.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Znowu dziwne hierarchia</p></li></ul></div></li><li><p>Lepiej: GET <code><a href="http://twitter.com/statuses/12345/retweets/" class="bare">http://twitter.com/statuses/12345/retweets/</a></code></p></li></ul></div></section><section id="slide_przykład_z_życia_twitter_api_5"><h2>Przykład z życia - Twitter API (5)</h2><div class="ulist"><div class="title">Retweet</div><ul><li><p>PUT <code><a href="http://api.twitter.com/1/statuses/retweet/12345.format" class="bare">http://api.twitter.com/1/statuses/retweet/12345.format</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>retweet</em> jest elementem URLa</p></li><li><p>Umożliwia zarówno akcję POST jak i PUT</p></li></ul></div></li><li><p>Lepiej: POST <code><a href="http://twitter.com/statuses/12345/retweets/" class="bare">http://twitter.com/statuses/12345/retweets/</a></code></p></li></ul></div></section></section>
<section id="slide_dziękuję"><h2>Dziękuję</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>&#8230; i ankietka</p></div>
<div class="paragraph"><p><a href="https://forms.gle/M6XxmnBVoGGHGXDv7" class="bare">https://forms.gle/M6XxmnBVoGGHGXDv7</a></p></div></div></div></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: false,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: false,
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: false,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'none',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1280,
  height: 720,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      { src: 'plugins/reveal.js-menu/menu.js' }
  ],

  

});</script></body></html>